import{r as u,P as D,V as R}from"./VForm-B2WdQWxv.js";import{g as E,l as I}from"./constants-YGND1LPw.js";import{_ as M}from"./AppTextarea-D5Dr80Xg.js";import{_ as Z}from"./AppAutocomplete-BNs06TK5.js";import{_ as G}from"./AppTextField-DlXfUlTR.js";import{j as J,r as V,aq as K,ar as A,w as P,c as U,o as v,d as C,b as e,x as Q,e as i,n as l,F as x,h as F,f as N,ai as W,v as X}from"./index-Dy7Usk4l.js";import{$ as O}from"./api-I3jvlWdA.js";import{t as $}from"./toast-DuLiNZ_C.js";import{V as c,a as d}from"./VRow-TJvxsZ_y.js";import{V as z}from"./VCard-CeZuMw9F.js";import{V as T}from"./VCardText-BJYEBQo3.js";import{V as b}from"./VInput-DYCyGubC.js";import{V as _,a as m}from"./VRadioGroup-DDvUTQw-.js";const Y={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},ee={class:"d-flex flex-column justify-center"},le={class:"text-h4 font-weight-medium"},ve={__name:"FormColis",props:{method:{type:String,required:!0},item:{type:Object,required:!1},identity:{type:String,required:!1}},async setup(H){let y,k;const p=H,L=J(),h=V(),n=V(),g=V([]),S=V([]),q=V(!1);g.value=([y,k]=K(()=>O("/api/zones").then(o=>o.data.items)),y=await y,k(),y);let j={nom_client:"",tel_client:"",zone_id:"",pricing_id:"",horaire:"",poids:"1kg_6kg",frais_livraison:"",adresse:"",produit:"",montant:"",commentaire_vendeur:"",essayage:0,ouvrir:0,echange:0};const t=V(structuredClone(A(j)));P(()=>p.item,o=>{p.method=="PUT"&&(t.value={...o})},{immediate:!0}),P(()=>t.value.zone_id,o=>{const a=g.value.find(s=>s.id===o);S.value=a?a.horaires:[],a&&t.value.poids&&(n.value=a.pricings.find(s=>s.poids===t.value.poids),t.value.frais_livraison=n.value?n.value.frais_livraison+" DH à "+a.delai_livraison:"",t.value.pricing_id=n.value?n.value.id:null)},{immediate:!0}),P(()=>t.value.poids,o=>{if(t.value.zone_id){const a=g.value.find(s=>s.id===t.value.zone_id);n.value=a.pricings.find(s=>s.poids===o),t.value.frais_livraison=n.value?n.value.frais_livraison+" DH à "+a.delai_livraison:"",t.value.pricing_id=n.value?n.value.id:null}},{immediate:!0});const B=async()=>{const{valid:o}=await h.value.validate();if(o){let a="/api/colis";p.method=="PUT"&&(a="/api/colis/"+p.identity),q.value=!0,O({method:p.method,url:a,data:t.value}).then(async s=>{var f;s.status===200&&($.success(s.data),p.method=="POST"?((f=h.value)==null||f.reset(),t.value=structuredClone(A(j))):L.push({name:"colis-list"})),q.value=!1}).catch(s=>{if(q.value=!1,s.response&&s.response.status===422){const f=s.response.data.errors;for(let w in f)$.error(`${w}: ${f[w].join(", ")}`)}})}};return(o,a)=>{const s=G,f=Z,w=M;return v(),U(x,null,[C("div",Y,[C("div",ee,[C("h4",le,Q(p.method=="POST"?"Ajouter Colis":"Modifier Colis"),1)])]),e(R,{ref_key:"refForm",ref:h,class:"mt-3"},{default:i(()=>[e(c,null,{default:i(()=>[e(d,{cols:"12",md:"6"},{default:i(()=>[e(d,{cols:"12",class:"pa-0"},{default:i(()=>[e(z,{title:"Informations du client"},{default:i(()=>[e(T,null,{default:i(()=>[e(c,null,{default:i(()=>[e(d,{md:"6",cols:"12"},{default:i(()=>[e(s,{modelValue:l(t).nom_client,"onUpdate:modelValue":a[0]||(a[0]=r=>l(t).nom_client=r),rules:["requiredValidator"in o?o.requiredValidator:l(u)],placeholder:"Nom",label:"Nom"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(s,{modelValue:l(t).tel_client,"onUpdate:modelValue":a[1]||(a[1]=r=>l(t).tel_client=r),rules:["requiredValidator"in o?o.requiredValidator:l(u),"PhoneValidator"in o?o.PhoneValidator:l(D)],label:"Telephone",size:"10",placeholder:"0655554747"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12"},{default:i(()=>[e(s,{modelValue:l(t).adresse,"onUpdate:modelValue":a[2]||(a[2]=r=>l(t).adresse=r),"prepend-inner-icon":"tabler-map-pin",rules:["requiredValidator"in o?o.requiredValidator:l(u)],label:"Adresse",placeholder:"Adresse"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12",class:"px-0"},{default:i(()=>[e(z,{title:"Informations d'adresse"},{default:i(()=>[e(T,null,{default:i(()=>[e(c,null,{default:i(()=>[e(d,{md:"6",cols:"12"},{default:i(()=>[e(f,{modelValue:l(t).zone_id,"onUpdate:modelValue":a[3]||(a[3]=r=>l(t).zone_id=r),rules:["requiredValidator"in o?o.requiredValidator:l(u)],label:"Destination",items:l(g),"item-title":"zone","item-value":"id",placeholder:"Select State",autocomplete:"off"},null,8,["modelValue","rules","items"])]),_:1}),e(d,{cols:"12",class:"app-text-field"},{default:i(()=>[e(b,{text:"Les horaires auxquelles il sera disponible",class:"mb-1 text-body-2 text-wrap"}),e(_,{modelValue:l(t).horaire,"onUpdate:modelValue":a[4]||(a[4]=r=>l(t).horaire=r),rules:["requiredValidator"in o?o.requiredValidator:l(u)],inline:""},{default:i(()=>[(v(!0),U(x,null,F(l(S),r=>(v(),N(m,{key:r,label:("getHorairesLabel"in o?o.getHorairesLabel:l(E))(r),value:r,density:"compact"},null,8,["label","value"]))),128))]),_:1},8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",class:"app-text-field"},{default:i(()=>[e(b,{text:"Poids",class:"mb-1 text-body-2 text-wrap"}),e(_,{modelValue:l(t).poids,"onUpdate:modelValue":a[5]||(a[5]=r=>l(t).poids=r),rules:["requiredValidator"in o?o.requiredValidator:l(u)],inline:""},{default:i(()=>[(v(!0),U(x,null,F("listPoids"in o?o.listPoids:l(I),r=>(v(),N(m,{key:r.value,label:r.label,value:r.value,density:"compact"},null,8,["label","value"]))),128))]),_:1},8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(s,{modelValue:l(t).frais_livraison,"onUpdate:modelValue":a[6]||(a[6]=r=>l(t).frais_livraison=r),disabled:"",label:"Frais de livraison",placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(z,{title:"Informations des produits"},{default:i(()=>[e(T,null,{default:i(()=>[e(c,null,{default:i(()=>[e(d,{cols:"12"},{default:i(()=>[e(s,{modelValue:l(t).produit,"onUpdate:modelValue":a[7]||(a[7]=r=>l(t).produit=r),rules:["requiredValidator"in o?o.requiredValidator:l(u)],label:"Produits",placeholder:"Produits"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:i(()=>[e(s,{modelValue:l(t).montant,"onUpdate:modelValue":a[8]||(a[8]=r=>l(t).montant=r),rules:["requiredValidator"in o?o.requiredValidator:l(u)],type:"number",label:"Montant Total",placeholder:"Montant Total"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6",class:"app-text-field"},{default:i(()=>[e(b,{text:"Essayage",class:"mb-1 text-body-2 text-wrap"}),e(_,{modelValue:l(t).essayage,"onUpdate:modelValue":a[9]||(a[9]=r=>l(t).essayage=r),rules:["requiredValidator"in o?o.requiredValidator:l(u)],inline:""},{default:i(()=>[e(m,{label:"Non",value:0,density:"compact"}),e(m,{label:"Oui",value:1,density:"compact"})]),_:1},8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6",class:"app-text-field"},{default:i(()=>[e(b,{text:"Ouvrir",class:"mb-1 text-body-2 text-wrap"}),e(_,{modelValue:l(t).ouvrir,"onUpdate:modelValue":a[10]||(a[10]=r=>l(t).ouvrir=r),rules:["requiredValidator"in o?o.requiredValidator:l(u)],inline:""},{default:i(()=>[e(m,{label:"Non",value:0,density:"compact"}),e(m,{label:"Oui",value:1,density:"compact"})]),_:1},8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6",class:"app-text-field"},{default:i(()=>[e(b,{text:"Echange",class:"mb-1 text-body-2 text-wrap"}),e(_,{modelValue:l(t).echange,"onUpdate:modelValue":a[11]||(a[11]=r=>l(t).echange=r),rules:["requiredValidator"in o?o.requiredValidator:l(u)],inline:""},{default:i(()=>[e(m,{label:"Non",value:0,density:"compact"}),e(m,{label:"Oui",value:1,density:"compact"})]),_:1},8,["modelValue","rules"])]),_:1}),e(d,{cols:"12"},{default:i(()=>[e(w,{modelValue:l(t).commentaire_vendeur,"onUpdate:modelValue":a[12]||(a[12]=r=>l(t).commentaire_vendeur=r),label:"Commentaire",placeholder:"Commentaire",rows:"2","row-height":"20"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(c,null,{default:i(()=>[e(d,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:i(()=>[e(W,{loading:l(q),onClick:B},{default:i(()=>a[13]||(a[13]=[X(" Enregistrer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)],64)}}};export{ve as _};
