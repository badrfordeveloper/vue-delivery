import{s as $}from"./statutInfos-CQo4TYHA.js";import{P as ie,_ as ue}from"./printRamassage-Xwrccrnh.js";import{_ as me}from"./DialogCloseBtn-CyhOHkF9.js";import{V as pe,_ as de,c as fe}from"./VDataTableServer-DgY7t16v.js";import{_ as ce}from"./AppTextField-DcnJNrqY.js";import{_ as ve}from"./AppSelect-BNJgt2DB.js";import{a as ge}from"./constants-BltA3_Ka.js";import{r,aq as Ve,j as ye,Y as E,a as _e,c as N,o as m,b as s,f as d,m as v,e as o,d as R,n as a,ak as n,v as f,x as D,s as A,A as P,ai as b,$ as ke}from"./index-Cpx2oQOu.js";import{$ as O}from"./VForm-DE5Dv9Vg.js";import{t as h}from"./toast-DRzPnEr1.js";import{u as Ce}from"./index-Dt9Tyk0y.js";import{V as j}from"./VCardText-C2zmEXKG.js";import{V as Ie,a as M}from"./VRow-D3F4KUiE.js";import{a as q,V as be}from"./VList-FbrG2muM.js";import{V as G}from"./VDivider-PtAXYG4Q.js";import{V as we}from"./VSpacer-kbMM-EH7.js";import{V as xe}from"./VMenu-SP-Qfij5.js";import{V as Be}from"./VChip-DLIMD1Bc.js";import{V as $e}from"./VDialog-DZYKZxfn.js";import{V as z}from"./VCard-ReRXJKrU.js";import"./VTabs-FSF85mBO.js";import"./VOverlay-B2_IMlFx.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-BaA_dvcq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppTextarea-kINhzqyt.js";import"./VInput-DGQc-sBd.js";import"./VAlert-DKVGvw_n.js";import"./VAvatar-CsMBVwvd.js";import"./VDataTable-CwT4qoSb.js";import"./VSelect-RP3MareX.js";import"./VTextField-yTp9D8wO.js";import"./filter-CoHf6CYO.js";import"./VNodeRenderer-BLthce2V.js";import"./qrcode.vue.esm-B2UpXNuA.js";/* empty css              */const De={class:"d-flex flex-wrap gap-4 ma-6"},Pe={class:"d-flex gap-4 flex-wrap align-center"},Se={key:1},gt={__name:"list",async setup(Te){let g,S;const K=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"Livreur",key:"livreur",sortable:!1},{title:"Montant encaisse",key:"montant_encaisse",sortable:!1},{title:"Montant facturée",key:"montant_facture",sortable:!1},{title:"Frais Total",key:"frais_total",sortable:!1}],V=r(),y=r(),_=r(!1),i=r(!1),w=r(),k=r(!1),Y=r(),u=r(5),p=r(1),T=r(),U=r(),H=l=>{i.value=!0,w.value=l},J=async()=>{let l="/api/ramassage/"+w.value.id;_.value=!0,O({method:"DELETE",url:l}).then(async e=>{e.status===200&&(i.value=!1,h.success(e.data),x()),_.value=!1}).catch(e=>{_.value=!1})},C=r(!1),Q=async()=>{let l="/api/generateLivreurFactures";C.value=!0,O({method:"POST",url:l}).then(async e=>{e.status===200&&(h.success(e.data),x()),C.value=!1}).catch(e=>{C.value=!1})},W=l=>{var e,c;T.value=(e=l.sortBy[0])==null?void 0:e.key,U.value=(c=l.sortBy[0])==null?void 0:c.order},{data:F,error:Ue,statusCode:Fe,isFetching:X,execute:x}=([g,S]=Ve(()=>Ce(fe("/api/factureLivreur",{query:{code:V,statut:y,page:p,itemsPerPage:u,sortBy:T,orderBy:U}}))),g=await g,S(),g),Z=ye(),ee=E(()=>F.value.items),L=E(()=>F.value.total),I=r(!1),te=r(0),ae=r(0);return(l,e)=>{const c=ve,se=ce,oe=_e("IconBtn"),le=de,re=me,ne=ue;return m(),N("div",null,[s(z,{title:"Filtres",class:"mb-6 d-print-none"},{default:o(()=>[s(j,null,{default:o(()=>[s(Ie,null,{default:o(()=>[s(M,{cols:"12",sm:"3"},{default:o(()=>[s(c,{modelValue:a(y),"onUpdate:modelValue":e[0]||(e[0]=t=>n(y)?y.value=t:null),placeholder:"Statut",items:a(ge),clearable:"","clear-icon":"tabler-x"},{item:o(({item:t,props:B})=>[s(q,A(B,{title:("statutInfos"in l?l.statutInfos:a($))(t.value).text}),null,16,["title"])]),selection:o(({item:t})=>[f(D(("statutInfos"in l?l.statutInfos:a($))(t.value).text),1)]),_:1},8,["modelValue","items"])]),_:1}),s(M,{cols:"12",sm:"2"},{default:o(()=>[s(se,{modelValue:a(V),"onUpdate:modelValue":e[1]||(e[1]=t=>n(V)?V.value=t:null),placeholder:"Code"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(G),R("div",De,[s(we),R("div",Pe,[s(c,{modelValue:a(u),"onUpdate:modelValue":e[2]||(e[2]=t=>n(u)?u.value=t:null),items:[5,10,20,25,50]},null,8,["modelValue"]),a(P)("create","factureLivreur")?(m(),d(b,{key:0,color:"primary","prepend-icon":"tabler-plus",loading:a(C),onClick:Q},{default:o(()=>e[11]||(e[11]=[f(" Génerer les factures ")])),_:1},8,["loading"])):v("",!0)])]),s(G,{class:"mt-4"}),s(pe,{"items-per-page":a(u),"onUpdate:itemsPerPage":e[4]||(e[4]=t=>n(u)?u.value=t:null),page:a(p),"onUpdate:page":e[5]||(e[5]=t=>n(p)?p.value=t:null),loading:a(X),headers:K,items:a(ee),"items-length":a(L),class:"text-no-wrap",locale:"fr","onUpdate:options":W},{"item.code":o(({item:t})=>[a(P)("show","factureLivreur")?(m(),d(b,{key:0,variant:"text",onClick:B=>a(Z).push("/factureLivreur/"+t.id)},{default:o(()=>[f(D(t.code),1)]),_:2},1032,["onClick"])):(m(),N("span",Se,D(t.code),1))]),"item.statut":o(({item:t})=>[s(Be,A(("statutInfos"in l?l.statutInfos:a($))(t.statut),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":o(({item:t})=>[t.statut=="EN_ATTENTE"?(m(),d(oe,{key:0},{default:o(()=>[s(ke,{icon:"tabler-dots-vertical"}),s(xe,{activator:"parent"},{default:o(()=>[s(be,null,{default:o(()=>[a(P)("delete","ramassage")?(m(),d(q,{key:0,value:"delete","prepend-icon":"tabler-trash",onClick:B=>H(t)},{default:o(()=>e[12]||(e[12]=[f(" Delete ")])),_:2},1032,["onClick"])):v("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)):v("",!0)]),bottom:o(()=>[s(le,{page:a(p),"onUpdate:page":e[3]||(e[3]=t=>n(p)?p.value=t:null),"items-per-page":a(u),"total-items":a(L)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items","items-length"]),s($e,{modelValue:a(i),"onUpdate:modelValue":e[8]||(e[8]=t=>n(i)?i.value=t:null),persistent:"",class:"v-dialog-sm"},{default:o(()=>[s(re,{onClick:e[6]||(e[6]=t=>i.value=!a(i))}),s(z,{title:"Êtes-vous sûr de vouloir supprimer le ramassage "+a(w).code+" ?"},{default:o(()=>[s(j,{class:"d-flex justify-end gap-3 flex-wrap"},{default:o(()=>[s(b,{color:"secondary",variant:"tonal",onClick:e[7]||(e[7]=t=>i.value=!1)},{default:o(()=>e[13]||(e[13]=[f(" Non ")])),_:1}),s(b,{loading:a(_),onClick:J},{default:o(()=>e[14]||(e[14]=[f(" Oui ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),a(k)?(m(),d(ie,{key:0,"is-print-ramassage":a(k),"onUpdate:isPrintRamassage":e[9]||(e[9]=t=>n(k)?k.value=t:null),item:a(Y)},null,8,["is-print-ramassage","item"])):v("",!0),a(I)?(m(),d(ne,{id:a(ae),key:a(te),"is-show-item":a(I),"onUpdate:isShowItem":e[10]||(e[10]=t=>n(I)?I.value=t:null),onFetchItems:a(x)},null,8,["id","is-show-item","onFetchItems"])):v("",!0)])}}};export{gt as default};
