import{s as R}from"./statutInfos-Dl5tZIw7.js";import{P as Oe,_ as xe}from"./printRamassage-jX1oPboe.js";import{_ as De}from"./DialogCloseBtn-TZVX7tmj.js";import{V as Ue,_ as $e,c as Ae}from"./VDataTableServer-D25ggilW.js";import{g as Pe,_ as he,a as $,b as E,e as Z,c as Be}from"./constants-DaN6VDFH.js";import{_ as Re}from"./AppTextField-KYzKeVMD.js";import{_ as Ee}from"./AppSelect-Be6KQpw4.js";import{_ as Ne}from"./AppAutocomplete-CNqtNHJX.js";import{r as n,A as C,aq as N,w as Me,j as je,Y as ee,a as Fe,c as te,o as r,b as l,f as m,m as c,e as o,d as ae,n as t,ak as i,v as _,x as M,s as le,ai as A,$ as se}from"./index-DC-Wnp_v.js";import{$ as j}from"./VForm-BLjPjbmE.js";import{t as Le}from"./toast-rl0bCb86.js";import{u as We}from"./index-BkqFNaQh.js";import{V as oe}from"./VCardText-rLzALaeu.js";import{V as ne,a as y}from"./VRow-C-Blmbrh.js";import{a as ie,V as qe}from"./VList-BfJ7xNXe.js";import{V as re}from"./VDivider-Caf8hJry.js";import{V as ze}from"./VSpacer-BKOtsdPM.js";import{V as Ge}from"./VMenu-PvYiXdlR.js";import{V as He}from"./VChip-BlN3E-V7.js";import{V as Ke}from"./VDialog-DW_OFpV4.js";import{V as ue}from"./VCard-ba4N2OJb.js";import{s as Ye}from"./VTabs-AE8l-tmf.js";import"./AppTextarea-DkraWkeD.js";import"./VInput-O8_TmnmY.js";import"./VImg-CsBZAcfn.js";import"./forwardRefs-DWGaNmQL.js";import"./VAlert-BRuEmrqc.js";import"./VAvatar-Cyrz8IHk.js";import"./VDataTable-BZm3qX_v.js";import"./VSelect-DcS93PjE.js";import"./VTextField-CFUFOG3c.js";import"./VOverlay-B10g4fEc.js";import"./filter-EgIwNTEF.js";import"./VNodeRenderer-DgCzjdgL.js";import"./qrcode.vue.esm-iNgtum8f.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css              */const Je={class:"d-flex flex-wrap gap-4 ma-6"},Qe={class:"d-flex gap-4 flex-wrap align-center"},Xe={key:1},Nt={__name:"index",props:{statut:{type:String,required:!0}},async setup(me){let u,k;const de=me,P=n(!1),pe=n([{title:"Aujourd'hui",value:"today"},{title:"Hier",value:"yesterday"},{title:"La semaine dernière",value:"lastWeek"},{title:"Ce mois",value:"thisMonth"},{title:"Le mois précédent",value:"lastMonth"},{title:"Personnalisé",value:"custom"}]),F=C("gestionnaire","action"),d=n(),p=n(),b=n("today"),L=()=>{const s=new Date;switch(P.value=b.value==="custom",b.value){case"today":d.value=s.toISOString().split("T")[0],p.value=s.toISOString().split("T")[0];break;case"yesterday":const e=$(s,-1);d.value=e.toISOString().split("T")[0],p.value=e.toISOString().split("T")[0];break;case"lastWeek":d.value=Ye($(s,-7)).toISOString().split("T")[0],p.value=Be($(s,-7)).toISOString().split("T")[0];break;case"thisMonth":d.value=E(s).toISOString().split("T")[0],p.value=Z(s).toISOString().split("T")[0];break;case"lastMonth":const g=$(E(s),-1);d.value=E(g).toISOString().split("T")[0],p.value=Z(g).toISOString().split("T")[0];break}};L();const w=n(),T=n(),ce=([u,k]=N(()=>j("/api/ramasseurs").then(s=>s.data)),u=await u,k(),u),fe=([u,k]=N(()=>j("/api/vendeurs").then(s=>s.data)),u=await u,k(),u),ve=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"destination",key:"destination",sortable:!1},{title:"Nombre de colis",key:"nombre_colis",sortable:!1},{title:"Vendeur",key:"vendeur",sortable:!1},{title:"actions",key:"actions",sortable:!1}],O=n(),I=n(),x=n(!1),f=n(!1),h=n(),D=n(!1),ge=n();Me(()=>de.statut,s=>{I.value=s},{immediate:!0});const v=n(5),V=n(1),W=n(),q=n(),Ve=s=>{f.value=!0,h.value=s},ye=async()=>{let s="/api/ramassage/"+h.value.id;x.value=!0,j({method:"DELETE",url:s}).then(async e=>{e.status===200&&(f.value=!1,Le.success(e.data),G()),x.value=!1}).catch(e=>{x.value=!1})},ke=s=>{var e,g;W.value=(e=s.sortBy[0])==null?void 0:e.key,q.value=(g=s.sortBy[0])==null?void 0:g.order},{data:z,error:Ze,statusCode:et,isFetching:_e,execute:G}=([u,k]=N(()=>We(Ae("/api/ramassage",{query:{livreur_id:w,vendeur_id:T,begin_date:d,end_date:p,code:O,statut:I,page:V,itemsPerPage:v,sortBy:W,orderBy:q}}))),u=await u,k(),u),H=je(),be=ee(()=>z.value.items),K=ee(()=>z.value.total),S=n(!1),Y=n(0),J=n(0),Ie=s=>{J.value=s.id,Y.value++,S.value=!0};return(s,e)=>{const g=Ne,B=Ee,Se=Re,Q=he,X=Fe("IconBtn"),Ce=$e,we=De,Te=xe;return r(),te("div",null,[l(ue,{title:"Filtres",class:"mb-6 d-print-none"},{default:o(()=>[l(oe,null,{default:o(()=>[l(ne,null,{default:o(()=>[t(F)?(r(),m(y,{key:0,cols:"12",sm:"3"},{default:o(()=>[l(g,{modelValue:t(T),"onUpdate:modelValue":e[0]||(e[0]=a=>i(T)?T.value=a:null),placeholder:"Vendeurs",items:t(fe),clearable:"","clear-icon":"tabler-x",autocomplete:"no-autocompeletse"},null,8,["modelValue","items"])]),_:1})):c("",!0),t(F)?(r(),m(y,{key:1,cols:"12",sm:"3"},{default:o(()=>[l(g,{modelValue:t(w),"onUpdate:modelValue":e[1]||(e[1]=a=>i(w)?w.value=a:null),placeholder:"Livreurs",items:t(ce),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):c("",!0),l(y,{cols:"12",sm:"3"},{default:o(()=>[l(B,{modelValue:t(I),"onUpdate:modelValue":e[2]||(e[2]=a=>i(I)?I.value=a:null),placeholder:"Statut",items:t(Pe),clearable:"","clear-icon":"tabler-x"},{item:o(({item:a,props:U})=>[l(ie,le(U,{title:("statutInfos"in s?s.statutInfos:t(R))(a.value).text}),null,16,["title"])]),selection:o(({item:a})=>[_(M(("statutInfos"in s?s.statutInfos:t(R))(a.value).text),1)]),_:1},8,["modelValue","items"])]),_:1}),l(y,{cols:"12",sm:"2"},{default:o(()=>[l(Se,{modelValue:t(O),"onUpdate:modelValue":e[3]||(e[3]=a=>i(O)?O.value=a:null),placeholder:"Code"},null,8,["modelValue"])]),_:1})]),_:1}),l(ne,null,{default:o(()=>[l(y,{cols:"12",sm:"3"},{default:o(()=>[l(B,{modelValue:t(b),"onUpdate:modelValue":[e[4]||(e[4]=a=>i(b)?b.value=a:null),L],placeholder:"Plage de dates",items:t(pe),label:t(d)+" - "+t(p)},null,8,["modelValue","items","label"])]),_:1}),t(P)?(r(),m(y,{key:0,cols:"12",sm:"3"},{default:o(()=>[l(Q,{modelValue:t(d),"onUpdate:modelValue":e[5]||(e[5]=a=>i(d)?d.value=a:null),label:"Début",placeholder:"date"},null,8,["modelValue"])]),_:1})):c("",!0),t(P)?(r(),m(y,{key:1,cols:"12",sm:"3"},{default:o(()=>[l(Q,{modelValue:t(p),"onUpdate:modelValue":e[6]||(e[6]=a=>i(p)?p.value=a:null),label:"Fin",placeholder:"date"},null,8,["modelValue"])]),_:1})):c("",!0)]),_:1})]),_:1}),l(re),ae("div",Je,[l(ze),ae("div",Qe,[l(B,{modelValue:t(v),"onUpdate:modelValue":e[7]||(e[7]=a=>i(v)?v.value=a:null),items:[5,10,20,25,50]},null,8,["modelValue"]),t(C)("create","ramassage")?(r(),m(A,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:e[8]||(e[8]=a=>t(H).push({name:"ramassage-add"}))},{default:o(()=>e[17]||(e[17]=[_(" Ajouter Ramassage ")])),_:1})):c("",!0)])]),l(re,{class:"mt-4"}),l(Ue,{"items-per-page":t(v),"onUpdate:itemsPerPage":e[10]||(e[10]=a=>i(v)?v.value=a:null),page:t(V),"onUpdate:page":e[11]||(e[11]=a=>i(V)?V.value=a:null),loading:t(_e),headers:ve,items:t(be),"items-length":t(K),class:"text-no-wrap",locale:"fr","onUpdate:options":ke},{"item.code":o(({item:a})=>[t(C)("show","ramassage")?(r(),m(A,{key:0,variant:"text",onClick:U=>Ie(a)},{default:o(()=>[_(M(a.code),1)]),_:2},1032,["onClick"])):(r(),te("span",Xe,M(a.code),1))]),"item.statut":o(({item:a})=>[l(He,le(("statutInfos"in s?s.statutInfos:t(R))(a.statut),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":o(({item:a})=>[a.statut=="EN_ATTENTE"&&t(C)("update","ramassage")?(r(),m(X,{key:0,onClick:U=>t(H).push("/ramassage/"+a.id)},{default:o(()=>[l(se,{icon:"tabler-edit"})]),_:2},1032,["onClick"])):c("",!0),a.statut=="EN_ATTENTE"?(r(),m(X,{key:1},{default:o(()=>[l(se,{icon:"tabler-dots-vertical"}),l(Ge,{activator:"parent"},{default:o(()=>[l(qe,null,{default:o(()=>[t(C)("delete","ramassage")?(r(),m(ie,{key:0,value:"delete","prepend-icon":"tabler-trash",onClick:U=>Ve(a)},{default:o(()=>e[18]||(e[18]=[_(" Delete ")])),_:2},1032,["onClick"])):c("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)):c("",!0)]),bottom:o(()=>[l(Ce,{page:t(V),"onUpdate:page":e[9]||(e[9]=a=>i(V)?V.value=a:null),"items-per-page":t(v),"total-items":t(K)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items","items-length"]),l(Ke,{modelValue:t(f),"onUpdate:modelValue":e[14]||(e[14]=a=>i(f)?f.value=a:null),persistent:"",class:"v-dialog-sm"},{default:o(()=>[l(we,{onClick:e[12]||(e[12]=a=>f.value=!t(f))}),l(ue,{title:"Êtes-vous sûr de vouloir supprimer le ramassage "+t(h).code+" ?"},{default:o(()=>[l(oe,{class:"d-flex justify-end gap-3 flex-wrap"},{default:o(()=>[l(A,{color:"secondary",variant:"tonal",onClick:e[13]||(e[13]=a=>f.value=!1)},{default:o(()=>e[19]||(e[19]=[_(" Non ")])),_:1}),l(A,{loading:t(x),onClick:ye},{default:o(()=>e[20]||(e[20]=[_(" Oui ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),t(D)?(r(),m(Oe,{key:0,"is-print-ramassage":t(D),"onUpdate:isPrintRamassage":e[15]||(e[15]=a=>i(D)?D.value=a:null),item:t(ge)},null,8,["is-print-ramassage","item"])):c("",!0),t(S)?(r(),m(Te,{id:t(J),key:t(Y),"is-show-item":t(S),"onUpdate:isShowItem":e[16]||(e[16]=a=>i(S)?S.value=a:null),onFetchItems:t(G)},null,8,["id","is-show-item","onFetchItems"])):c("",!0)])}}};export{Nt as default};
