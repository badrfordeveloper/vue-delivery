import{$ as k,r as b,P as G,V as H}from"./VForm-CJrumaOn.js";import{c as J,a as K,_ as L}from"./VDataTableServer-BywS9XHK.js";import{_ as Q}from"./AppSelect-DWxu4sV5.js";import{_ as W}from"./AppAutocomplete-CeUCHEtX.js";import{_ as X}from"./AppTextField-CrAlU6gB.js";import{j as Z,r as u,aq as A,as as C,w as ee,Y as N,c as te,o as ae,d as V,b as e,x as le,e as o,n as a,ak as h,s as se,ai as oe,v as re,F as ie}from"./index-CJ4IgJQr.js";import{t as E}from"./toast-BK7ruyfP.js";import{u as ne}from"./index-Bbews3C0.js";import{V as _,a as m}from"./VRow-_wUxO3gL.js";import{V as F}from"./VCard-C6PGjlKr.js";import{V as j}from"./VCardText-BGBPTyEd.js";import{V as de}from"./VSpacer-BXWztqgn.js";import{V as ue}from"./VChip-Bnp3FgHr.js";const me={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},pe={class:"d-flex flex-column justify-center"},fe={class:"text-h4 font-weight-medium"},ce={class:"d-flex flex-wrap gap-4 ma-6"},Ve={class:"d-flex gap-4 flex-wrap align-center"},Ne={__name:"FormRamassage",props:{method:{type:String,required:!0},item:{type:Object,required:!1},identity:{type:String,required:!1}},async setup(B){let n,g;const p=B,R=Z(),w=u(),T=u([]),v=u(!1);T.value=([n,g]=A(()=>k("/api/tarifs").then(l=>l.data.items)),n=await n,g(),n);let q={id:"",nom_vendeur:"",tel_vendeur:"",tarif_id:"",adresse:"",adresse:"",colis:[]};const r=u(structuredClone(C(q)));ee(()=>p.item,l=>{p.method=="PUT"&&(r.value={...l})},{immediate:!0});const $=async()=>{const{valid:l}=await w.value.validate();if(l){let t="/api/ramassage";p.method=="PUT"&&(t="/api/ramassage/"+p.identity),v.value=!0,k({method:p.method,url:t,data:r.value}).then(async i=>{var c;i.status===200&&(E.success(i.data),p.method=="POST"?((c=w.value)==null||c.reset(),r.value=structuredClone(C(q))):R.push({name:"ramassage-list"})),v.value=!1}).catch(i=>{if(v.value=!1,i.response&&i.response.status===422){const c=i.response.data.errors;for(let y in c)E.error(`${y}: ${c[y].join(", ")}`)}})}},D=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"destination",key:"destination",sortable:!1},{title:"Nom du client",key:"nom_client",sortable:!1},{title:"Tel du client",key:"tel_client",sortable:!1}],I=l=>{var t,i;x.value=(t=l.sortBy[0])==null?void 0:t.key,P.value=(i=l.sortBy[0])==null?void 0:i.order},d=u(5),f=u(1),x=u(),P=u(),{data:S,error:_e,statusCode:ge,isFetching:O,execute:ve}=([n,g]=A(()=>ne(J("/api/colisForRamassage",{query:{statut:"EN_ATTENTE",ramassage_id:r.value.id,page:f,itemsPerPage:d,sortBy:x,orderBy:P}}))),n=await n,g(),n),z=N(()=>S.value.items),U=N(()=>S.value.total),M=l=>{if(l==="EN_ATTENTE")return{text:"En attente",color:"warning"}};return(l,t)=>{const i=X,c=W,y=Q,Y=L;return ae(),te(ie,null,[V("div",me,[V("div",pe,[V("h4",fe,le(p.method=="POST"?"Ajouter Ramassage":"Modifier Ramassage"),1)])]),e(H,{ref_key:"refForm",ref:w,class:"mt-3"},{default:o(()=>[e(_,null,{default:o(()=>[e(m,{cols:"12",class:"pa-0"},{default:o(()=>[e(F,{title:"Informations du client"},{default:o(()=>[e(j,null,{default:o(()=>[e(_,null,{default:o(()=>[e(m,{md:"6",cols:"12"},{default:o(()=>[e(i,{modelValue:a(r).nom_vendeur,"onUpdate:modelValue":t[0]||(t[0]=s=>a(r).nom_vendeur=s),rules:["requiredValidator"in l?l.requiredValidator:a(b)],placeholder:"Nom",label:"Nom"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"12",md:"6"},{default:o(()=>[e(i,{modelValue:a(r).tel_vendeur,"onUpdate:modelValue":t[1]||(t[1]=s=>a(r).tel_vendeur=s),rules:["requiredValidator"in l?l.requiredValidator:a(b),"PhoneValidator"in l?l.PhoneValidator:a(G)],label:"Telephone",size:"10",placeholder:"0655554747"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",class:"px-0"},{default:o(()=>[e(F,{title:"Informations d'adresse"},{default:o(()=>[e(j,null,{default:o(()=>[e(_,null,{default:o(()=>[e(m,{md:"6",cols:"12"},{default:o(()=>[e(c,{modelValue:a(r).tarif_id,"onUpdate:modelValue":t[2]||(t[2]=s=>a(r).tarif_id=s),rules:["requiredValidator"in l?l.requiredValidator:a(b)],label:"Destination",items:a(T),"item-title":"destination","item-value":"id",placeholder:"Select State"},null,8,["modelValue","rules","items"])]),_:1}),e(m,{md:"6",cols:"12"},{default:o(()=>[e(i,{modelValue:a(r).adresse,"onUpdate:modelValue":t[3]||(t[3]=s=>a(r).adresse=s),"prepend-inner-icon":"tabler-map-pin",rules:["requiredValidator"in l?l.requiredValidator:a(b)],label:"Adresse",placeholder:"Adresse"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(_,null,{default:o(()=>[e(m,null,{default:o(()=>[V("div",ce,[e(de),V("div",Ve,[e(y,{modelValue:a(d),"onUpdate:modelValue":t[4]||(t[4]=s=>h(d)?d.value=s:null),items:[5,10,20,25,50]},null,8,["modelValue"])])]),e(K,{"model-value":a(r).colis,"onUpdate:modelValue":t[6]||(t[6]=s=>a(r).colis=s),"items-per-page":a(d),"onUpdate:itemsPerPage":t[7]||(t[7]=s=>h(d)?d.value=s:null),page:a(f),"onUpdate:page":t[8]||(t[8]=s=>h(f)?f.value=s:null),"show-select":"","item-value":s=>s.id,loading:a(O),headers:D,items:a(z),"items-length":a(U),class:"text-no-wrap",locale:"fr","onUpdate:options":I},{"item.statut":o(({item:s})=>[e(ue,se(M(s.statut),{density:"default",label:"",size:"small"}),null,16)]),bottom:o(()=>[e(Y,{page:a(f),"onUpdate:page":t[5]||(t[5]=s=>h(f)?f.value=s:null),"items-per-page":a(d),"total-items":a(U)},null,8,["page","items-per-page","total-items"])]),_:1},8,["model-value","items-per-page","page","item-value","loading","items","items-length"])]),_:1})]),_:1}),e(_,null,{default:o(()=>[e(m,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:o(()=>[e(oe,{loading:a(v),onClick:$},{default:o(()=>t[9]||(t[9]=[re(" Enregistrer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)],64)}}};export{Ne as _};
