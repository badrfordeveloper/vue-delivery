import{Q as xe,_ as he,s as me,V as Ce,a as ke,b as Ie,c as ae,d as $e,e as Te}from"./VTabs-CqAmUcw2.js";import{_ as pe}from"./DialogCloseBtn-CAsxFcLK.js";import{V as oe,a as Ne,_ as De,c as Ue}from"./VDataTableServer-YZ-f1CDH.js";import{_ as ce}from"./AppSelect-CD9O45vb.js";import{_ as Ae}from"./AppTextField-BsPyopml.js";import{V as Se}from"./VNodeRenderer-BknNHLhf.js";import{c as N,m as T,o as _,d as t,b as e,e as l,n as s,H as ne,x as u,aq as fe,r as d,as as ie,w as Be,A as H,f as A,ai as M,s as _e,ak as f,F as Pe,h as Ee,v as S,j as Oe,Y as re,a as Re,$ as de}from"./index-DzV6yVlR.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as P}from"./VDivider-D43WtKHi.js";import{V as E,a as g}from"./VRow-l2emrWky.js";import{V as K}from"./VCard-BG-sLHPS.js";import{$ as z}from"./VForm-Be23ANTJ.js";import{t as B}from"./toast-CtX10tFY.js";import{V as Y}from"./VCardText-DH-YrV8w.js";import{V as ve}from"./VChip-6G5F0vN_.js";import{V as ge}from"./VDialog-CBNTIYzI.js";import{u as qe}from"./index-Cp4yW6HO.js";import{V as Fe}from"./VSpacer-D8O6v4X4.js";import{V as Le}from"./VMenu-AGw7i9Pi.js";import{V as He,a as ue}from"./VList-x5vscWgM.js";import"./VOverlay-6aPDv4Z9.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-DpWbwdj8.js";import"./AppTextarea-CYeihCq1.js";import"./VTextField-DRhBZEdt.js";import"./VAlert-BBwriC9b.js";import"./VAvatar-B_166d6N.js";import"./VSelect-CvQu-CnL.js";import"./filter-ovwvCeUH.js";/* empty css              */const Me={key:0},ze={id:"print-area"},Ge={class:"print-content"},Qe={class:"props.item-header-preview d-flex flex-wrap justify-space-between flex-column flex-sm-row print-row bg-var-theme-background gap-6 rounded"},We={class:"d-flex align-center app-logo"},Ke={class:"app-logo-title"},Ye={class:"d-flex align-center destination"},Je={class:"d-flex flex-wrap justify-space-between flex-column flex-sm-row gap-6"},Xe={class:"mb-0"},Ze={class:"mb-0"},et={class:"mb-0"},tt={class:"mb-0"},st={class:"mb-0"},lt={class:"mb-0"},at={class:"mb-0"},ot={class:"mb-0"},nt={__name:"printColis",props:{item:{type:Object,required:!0},isPrintColis:{type:Boolean,required:!0}},emits:["update:isPrintColis"],setup(j,{emit:x}){const r=j,D=x;return setTimeout(()=>{window.print()},500),window.onafterprint=function(){D("update:isPrintColis",!1)},(h,v)=>r.isPrintColis?(_(),N("div",Me,[t("div",ze,[t("div",Ge,[e(K,{class:"props.item-preview-wrapper"},{default:l(()=>[v[0]||(v[0]=t("div",null,null,-1)),t("div",Qe,[t("div",null,[t("div",We,[e(s(Se),{nodes:s(ne).app.logo},null,8,["nodes"]),t("h6",Ke,u(s(ne).app.title),1)])]),t("div",Ye,u(r.item.destination),1)]),e(P,{class:"border-solid"}),e(E,{class:"print-row little-margin"},{default:l(()=>[e(g,{class:"text"},{default:l(()=>[t("div",Je,[t("div",null,[t("p",Xe," Code : "+u(r.item.code),1),t("p",Ze," Nom : "+u(r.item.nom_client),1),t("p",et," tel : "+u(r.item.tel_client),1)]),t("div",null,[t("p",tt,[e(xe,{size:"70",value:r.item.code},null,8,["value"])])])]),t("p",st," Adresse : "+u(r.item.adresse),1)]),_:1})]),_:1}),e(P,{class:"border-solid"}),e(E,{class:"align-right little-margin"},{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[t("p",lt," Produits : "+u(r.item.produit),1),t("p",at," Montant : "+u(r.item.montant),1)]),_:1})]),_:1}),e(P,{class:"border-solid"}),e(E,{class:"align-right little-margin"},{default:l(()=>[e(g,{cols:"12"},{default:l(()=>[t("p",ot," essayage : "+u(r.item.essayage?"OUI":"NON")+" | ouvrir : "+u(r.item.ouvrir?"OUI":"NON")+" | echange : "+u(r.item.echange?"OUI":"NON"),1)]),_:1})]),_:1}),e(P,{class:"border-solid"}),v[1]||(v[1]=t("p",{class:"mb-0"},[t("span",null," Remarque: "),t("span",null,"Entrepirse de livraison n'est pas responsable sur vos achat")],-1))]),_:1})])])])):T("",!0)}},it=je(nt,[["__scopeId","data-v-4ffea5da"]]),rt={class:"text-body-1 mb-2"},dt={key:0,class:"text-body-1 mb-2"},ut={key:1,class:"text-body-1 mb-2"},mt={class:"text-body-1 mb-2"},pt={class:"text-body-1 mb-2"},ct={class:"text-body-1 mb-2"},ft={class:"text-body-1 mb-2"},_t={class:"text-body-1 mb-2"},vt={__name:"showColis",props:{id:{type:Object,required:!1},isShowItem:{type:Boolean,required:!0}},emits:["update:isShowItem","fetchItems"],async setup(j,{emit:x}){let r,D;const h=j,v=x;let k={id:"",nom_vendeur:"",tel_vendeur:"",tarif_id:"",adresse:"",livreur:"",livreur_id:"",tel_livreur:"",statut:"",vendeur:"",nombre_colis:"",colis:[],colisHistories:[]};const U=([r,D]=fe(()=>z("/api/ramasseurs").then(m=>m.data)),r=await r,D(),r),i=d(structuredClone(ie(k))),p=d(!1),O=async m=>{p.value=!0,await z("/api/colis/"+m).then(async n=>{n.status===200&&(i.value=n.data),p.value=!1}).catch(n=>{p.value=!1,n.response&&n.response.status===422?B.error(n.response.data.message):B.error("something wrong")})};Be(()=>h.id,m=>{O(m)},{immediate:!0});const C=()=>{v("update:isShowItem",!1),v("fetchItems"),i.value=structuredClone(ie(k))},I=d(!1),b=H("gestionnaire","action"),V=async()=>{I.value=!0,await z({method:"POST",url:"/api/updateRamasseur",data:{id:i.value.id,ramasseur_id:i.value.ramasseur_id}}).then(async m=>{m.status===200&&B.success(m.data),I.value=!1}).catch(m=>{I.value=!1,m.response&&m.response.status===422?B.error(m.response.data.message):B.error("something wrong")})},y=d("Actions"),q=["Actions","Historique"];return(m,n)=>{const G=pe,Q=ce,F=$e,J=Te,X=he;return _(),A(ge,{width:m.$vuetify.display.smAndDown?"auto":900,"model-value":h.isShowItem,"onUpdate:modelValue":C},{default:l(()=>[e(G,{onClick:C}),e(X,{title:"Details Ramassage",loading:s(p)},{default:l(()=>[e(Y,null,{default:l(()=>[e(E,null,{default:l(()=>[e(g,{cols:"12",lg:"6"},{default:l(()=>[e(oe,{class:"billing-address-table"},{default:l(()=>[t("tr",null,[n[3]||(n[3]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Code : ")],-1)),t("td",null,[t("p",rt,u(s(i).code),1)])]),t("tr",null,[n[4]||(n[4]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Livreur : ")],-1)),t("td",null,[s(b)&&["EN_ATTENTE","EN_COURS_RAMASSAGE","REPORTE"].includes(s(i).statut)?(_(),N("p",dt,[e(E,{class:"ma-0"},{default:l(()=>[e(g,{class:"pa-0",cols:"9",md:"7"},{default:l(()=>[e(Q,{modelValue:s(i).livreur_id,"onUpdate:modelValue":n[0]||(n[0]=w=>s(i).livreur_id=w),placeholder:"Livreurs",items:s(U),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(g,{class:"pa-0",cols:"3"},{default:l(()=>[e(M,{loading:s(I),class:"ms-1",rounded:"",icon:"tabler-send-2",color:"secondary",onClick:V},null,8,["loading"])]),_:1})]),_:1})])):(_(),N("p",ut,u(s(i).livreur),1))])]),t("tr",null,[n[5]||(n[5]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Tel Livreur: ")],-1)),t("td",null,[t("p",mt,u(s(i).tel_livreur),1)])]),t("tr",null,[n[6]||(n[6]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Destination : ")],-1)),t("td",null,[t("p",pt,u(s(i).destination),1)])]),t("tr",null,[n[7]||(n[7]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Statut: ")],-1)),t("td",null,[t("p",ct,[e(ve,_e(("statutInfos"in m?m.statutInfos:s(me))(s(i).statut),{density:"default",label:"",size:"small"}),null,16)])])])]),_:1})]),_:1}),e(g,{cols:"12",lg:"6"},{default:l(()=>[e(oe,{class:"billing-address-table"},{default:l(()=>[t("tr",null,[n[8]||(n[8]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Vendeur: ")],-1)),t("td",null,[t("p",ft,u(s(i).vendeur),1)])]),t("tr",null,[n[9]||(n[9]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Tel Vendeur: ")],-1)),t("td",null,[t("p",_t,u(s(i).tel_vendeur),1)])])]),_:1})]),_:1})]),_:1}),e(Ce,{modelValue:s(y),"onUpdate:modelValue":n[1]||(n[1]=w=>f(y)?y.value=w:null),grow:"",class:"disable-tab-transition"},{default:l(()=>[(_(),N(Pe,null,Ee(q,(w,L)=>e(ke,{key:L},{default:l(()=>[S(u(w),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(Ie,{modelValue:s(y),"onUpdate:modelValue":n[2]||(n[2]=w=>f(y)?y.value=w:null),class:"mt-3"},{default:l(()=>[e(ae,null,{default:l(()=>[e(F,{id:s(i).id,"current-statut":s(i).statut},null,8,["id","current-statut"])]),_:1}),e(ae,null,{default:l(()=>[e(J,{histories:s(i).colisHistories},null,8,["histories"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["loading"])]),_:1},8,["width","model-value"])}}},gt={class:"d-flex flex-wrap gap-4 ma-6"},bt={class:"d-flex gap-4 flex-wrap align-center"},Vt={key:1},yt={key:0},Xt={__name:"list",async setup(j){let x,r;const D=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"destination",key:"destination",sortable:!1},{title:"Montant",key:"montant",sortable:!1},{title:"Nom du client",key:"nom_client",sortable:!1},{title:"Tel du client",key:"tel_client",sortable:!1},{title:"Vendeur",key:"vendeur",sortable:!1},{title:"actions",key:"actions",sortable:!1}],h=d(),v=d(),k=d(),U=d(),i=d(!1),p=d(!1),O=d(),C=d(!1),I=d(),b=d(5),V=d(1),y=d(),q=d(),m=c=>{var a,$;y.value=(a=c.sortBy[0])==null?void 0:a.key,q.value=($=c.sortBy[0])==null?void 0:$.order},n=c=>{C.value=!0,I.value=c},G=c=>{p.value=!0,O.value=c},Q=async()=>{let c="/api/colis/"+O.value.id;i.value=!0,z({method:"DELETE",url:c}).then(async a=>{a.status===200&&(p.value=!1,B.success(a.data),L()),i.value=!1}).catch(a=>{i.value=!1})},{data:F,error:J,statusCode:X,isFetching:w,execute:L}=([x,r]=fe(()=>qe(Ue("/api/colis",{query:{code:h,statut:v,nom_client:k,tel_client:U,page:V,itemsPerPage:b,sortBy:y,orderBy:q}}))),x=await x,r(),x),Z=Oe(),be=re(()=>F.value.items),ee=re(()=>F.value.total),R=d(!1),te=d(0),se=d(0),wt=c=>{se.value=c.id,te.value++,R.value=!0};return(c,a)=>{const $=Ae,Ve=ce,le=Re("IconBtn"),ye=De,we=pe;return _(),N("div",null,[e(K,{title:"Filtres",class:"mb-6 d-print-none"},{default:l(()=>[e(Y,null,{default:l(()=>[e(E,null,{default:l(()=>[e(g,{cols:"12",sm:"2"},{default:l(()=>[e($,{modelValue:s(v),"onUpdate:modelValue":a[0]||(a[0]=o=>f(v)?v.value=o:null),placeholder:"Statut"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"2"},{default:l(()=>[e($,{modelValue:s(h),"onUpdate:modelValue":a[1]||(a[1]=o=>f(h)?h.value=o:null),placeholder:"Code"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"2"},{default:l(()=>[e($,{modelValue:s(k),"onUpdate:modelValue":a[2]||(a[2]=o=>f(k)?k.value=o:null),placeholder:"Nom du client"},null,8,["modelValue"])]),_:1}),e(g,{cols:"12",sm:"2"},{default:l(()=>[e($,{modelValue:s(U),"onUpdate:modelValue":a[3]||(a[3]=o=>f(U)?U.value=o:null),placeholder:"Telephone du client"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(P),t("div",gt,[e(Fe),t("div",bt,[e(Ve,{modelValue:s(b),"onUpdate:modelValue":a[4]||(a[4]=o=>f(b)?b.value=o:null),items:[5,10,20,25,50]},null,8,["modelValue"]),s(H)("create","colis")?(_(),A(M,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:a[5]||(a[5]=o=>s(Z).push({name:"colis-add"}))},{default:l(()=>a[14]||(a[14]=[S(" Ajouter Colis ")])),_:1})):T("",!0)])]),e(P,{class:"mt-4"}),e(Ne,{"items-per-page":s(b),"onUpdate:itemsPerPage":a[7]||(a[7]=o=>f(b)?b.value=o:null),page:s(V),"onUpdate:page":a[8]||(a[8]=o=>f(V)?V.value=o:null),loading:s(w),headers:D,items:s(be),"items-length":s(ee),class:"text-no-wrap",locale:"fr","onUpdate:options":m},{"item.code":l(({item:o})=>[(_(),N("span",Vt,u(o.code),1))]),"item.statut":l(({item:o})=>[e(ve,_e(("statutInfos"in c?c.statutInfos:s(me))(o.statut),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":l(({item:o})=>[o.statut=="EN_ATTENTE"?(_(),N("div",yt,[s(H)("update","colis")?(_(),A(le,{key:0,onClick:W=>s(Z).push("/colis/"+o.id)},{default:l(()=>[e(de,{icon:"tabler-edit"})]),_:2},1032,["onClick"])):T("",!0),e(le,null,{default:l(()=>[e(de,{icon:"tabler-dots-vertical"}),e(Le,{activator:"parent"},{default:l(()=>[e(He,null,{default:l(()=>[e(ue,{value:"print","prepend-icon":"tabler-text-scan-2",onClick:W=>n(o)},{default:l(()=>a[15]||(a[15]=[S(" Print ")])),_:2},1032,["onClick"]),s(H)("delete","colis")?(_(),A(ue,{key:0,value:"delete","prepend-icon":"tabler-trash",onClick:W=>G(o)},{default:l(()=>a[16]||(a[16]=[S(" Delete ")])),_:2},1032,["onClick"])):T("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])):T("",!0)]),bottom:l(()=>[e(ye,{page:s(V),"onUpdate:page":a[6]||(a[6]=o=>f(V)?V.value=o:null),"items-per-page":s(b),"total-items":s(ee)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items","items-length"]),e(ge,{modelValue:s(p),"onUpdate:modelValue":a[11]||(a[11]=o=>f(p)?p.value=o:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[e(we,{onClick:a[9]||(a[9]=o=>p.value=!s(p))}),e(K,{title:"Êtes-vous sûr de vouloir supprimer le colis "+s(O).code+" ?"},{default:l(()=>[e(Y,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[e(M,{color:"secondary",variant:"tonal",onClick:a[10]||(a[10]=o=>p.value=!1)},{default:l(()=>a[17]||(a[17]=[S(" Non ")])),_:1}),e(M,{loading:s(i),onClick:Q},{default:l(()=>a[18]||(a[18]=[S(" Oui ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),s(C)?(_(),A(it,{key:0,"is-print-colis":s(C),"onUpdate:isPrintColis":a[12]||(a[12]=o=>f(C)?C.value=o:null),item:s(I)},null,8,["is-print-colis","item"])):T("",!0),s(R)?(_(),A(vt,{id:s(se),key:s(te),"is-show-item":s(R),"onUpdate:isShowItem":a[13]||(a[13]=o=>f(R)?R.value=o:null),onFetchItems:s(L)},null,8,["id","is-show-item","onFetchItems"])):T("",!0)])}}};export{Xt as default};
