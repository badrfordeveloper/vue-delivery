import{s as h}from"./statutInfos-CQo4TYHA.js";import{P as Te,_ as we}from"./printRamassage-BikAH9yA.js";import{_ as Oe}from"./DialogCloseBtn-DVHO0sRD.js";import{V as xe,_ as De,c as Ue}from"./VDataTableServer-CKMds1xJ.js";import{g as $e,_ as Ae,a as $,b as E,e as Z,c as Pe}from"./constants-CSajaIPA.js";import{_ as Be}from"./AppTextField-CYZ3Rx27.js";import{_ as Re}from"./AppSelect-BVIOMXQR.js";import{_ as he}from"./AppAutocomplete-C0T09cdS.js";import{r as n,A as S,aq as N,j as Ee,Y as ee,a as Ne,c as te,o as r,b as l,f as m,m as c,e as s,d as ae,n as t,ak as i,v as _,x as M,s as le,ai as A,$ as se}from"./index-BzYb6ZoD.js";import{$ as j}from"./VForm-BLjIjdGP.js";import{t as Me}from"./toast-D70_l16b.js";import{u as je}from"./index-CEU2nq8s.js";import{V as oe}from"./VCardText-BXEBMitH.js";import{V as ne,a as y}from"./VRow-DsbanFfo.js";import{a as ie,V as Fe}from"./VList-CRQHkd0E.js";import{V as re}from"./VDivider-BMPN5T29.js";import{V as Le}from"./VSpacer-CEO0eUAf.js";import{V as We}from"./VMenu-BY9QwYHY.js";import{V as qe}from"./VChip-BWDkMsrJ.js";import{V as ze}from"./VDialog-G5cni5JA.js";import{V as ue}from"./VCard-BFmSMYzL.js";import{s as Ge}from"./VTabs-CQUVYkPt.js";import"./AppTextarea-DRNDIqPK.js";import"./VInput-DYDNzfTI.js";import"./VImg-D7Y9dL6k.js";import"./forwardRefs-DWGaNmQL.js";import"./VAlert-DtVA7brF.js";import"./VAvatar-BeI6oEr0.js";import"./VDataTable-DbMptXrw.js";import"./VSelect-CesdDUFt.js";import"./VTextField-CdQl9fbf.js";import"./VOverlay-XR8PqSnK.js";import"./filter-CU_3bWay.js";import"./VNodeRenderer-DxF3FeEK.js";import"./qrcode.vue.esm-BqCK7TRI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css              */const He={class:"d-flex flex-wrap gap-4 ma-6"},Ke={class:"d-flex gap-4 flex-wrap align-center"},Ye={key:1},ht={__name:"list",async setup(Je){let u,k;const P=n(!1),me=n([{title:"Aujourd'hui",value:"today"},{title:"Hier",value:"yesterday"},{title:"La semaine dernière",value:"lastWeek"},{title:"Ce mois",value:"thisMonth"},{title:"Le mois précédent",value:"lastMonth"},{title:"Personnalisé",value:"custom"}]),F=S("gestionnaire","action"),d=n(),p=n(),b=n("today"),L=()=>{const o=new Date;switch(P.value=b.value==="custom",b.value){case"today":d.value=o.toISOString().split("T")[0],p.value=o.toISOString().split("T")[0];break;case"yesterday":const e=$(o,-1);d.value=e.toISOString().split("T")[0],p.value=e.toISOString().split("T")[0];break;case"lastWeek":d.value=Ge($(o,-7)).toISOString().split("T")[0],p.value=Pe($(o,-7)).toISOString().split("T")[0];break;case"thisMonth":d.value=E(o).toISOString().split("T")[0],p.value=Z(o).toISOString().split("T")[0];break;case"lastMonth":const g=$(E(o),-1);d.value=E(g).toISOString().split("T")[0],p.value=Z(g).toISOString().split("T")[0];break}};L();const C=n(),T=n(),de=([u,k]=N(()=>j("/api/ramasseurs").then(o=>o.data)),u=await u,k(),u),pe=([u,k]=N(()=>j("/api/vendeurs").then(o=>o.data)),u=await u,k(),u),ce=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"destination",key:"destination",sortable:!1},{title:"Nombre de colis",key:"nombre_colis",sortable:!1},{title:"Vendeur",key:"vendeur",sortable:!1},{title:"actions",key:"actions",sortable:!1}],w=n(),O=n(),x=n(!1),f=n(!1),B=n(),D=n(!1),fe=n(),v=n(5),V=n(1),W=n(),q=n(),ve=o=>{f.value=!0,B.value=o},ge=async()=>{let o="/api/ramassage/"+B.value.id;x.value=!0,j({method:"DELETE",url:o}).then(async e=>{e.status===200&&(f.value=!1,Me.success(e.data),G()),x.value=!1}).catch(e=>{x.value=!1})},Ve=o=>{var e,g;W.value=(e=o.sortBy[0])==null?void 0:e.key,q.value=(g=o.sortBy[0])==null?void 0:g.order},{data:z,error:Qe,statusCode:Xe,isFetching:ye,execute:G}=([u,k]=N(()=>je(Ue("/api/ramassage",{query:{livreur_id:C,vendeur_id:T,begin_date:d,end_date:p,code:w,statut:O,page:V,itemsPerPage:v,sortBy:W,orderBy:q}}))),u=await u,k(),u),H=Ee(),ke=ee(()=>z.value.items),K=ee(()=>z.value.total),I=n(!1),Y=n(0),J=n(0),_e=o=>{J.value=o.id,Y.value++,I.value=!0};return(o,e)=>{const g=he,R=Re,be=Be,Q=Ae,X=Ne("IconBtn"),Ie=De,Se=Oe,Ce=we;return r(),te("div",null,[l(ue,{title:"Filtres",class:"mb-6 d-print-none"},{default:s(()=>[l(oe,null,{default:s(()=>[l(ne,null,{default:s(()=>[t(F)?(r(),m(y,{key:0,cols:"12",sm:"3"},{default:s(()=>[l(g,{modelValue:t(T),"onUpdate:modelValue":e[0]||(e[0]=a=>i(T)?T.value=a:null),placeholder:"Vendeurs",items:t(pe),clearable:"","clear-icon":"tabler-x",autocomplete:"no-autocompeletse"},null,8,["modelValue","items"])]),_:1})):c("",!0),t(F)?(r(),m(y,{key:1,cols:"12",sm:"3"},{default:s(()=>[l(g,{modelValue:t(C),"onUpdate:modelValue":e[1]||(e[1]=a=>i(C)?C.value=a:null),placeholder:"Livreurs",items:t(de),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})):c("",!0),l(y,{cols:"12",sm:"3"},{default:s(()=>[l(R,{modelValue:t(O),"onUpdate:modelValue":e[2]||(e[2]=a=>i(O)?O.value=a:null),placeholder:"Statut",items:t($e),clearable:"","clear-icon":"tabler-x"},{item:s(({item:a,props:U})=>[l(ie,le(U,{title:("statutInfos"in o?o.statutInfos:t(h))(a.value).text}),null,16,["title"])]),selection:s(({item:a})=>[_(M(("statutInfos"in o?o.statutInfos:t(h))(a.value).text),1)]),_:1},8,["modelValue","items"])]),_:1}),l(y,{cols:"12",sm:"2"},{default:s(()=>[l(be,{modelValue:t(w),"onUpdate:modelValue":e[3]||(e[3]=a=>i(w)?w.value=a:null),placeholder:"Code"},null,8,["modelValue"])]),_:1})]),_:1}),l(ne,null,{default:s(()=>[l(y,{cols:"12",sm:"3"},{default:s(()=>[l(R,{modelValue:t(b),"onUpdate:modelValue":[e[4]||(e[4]=a=>i(b)?b.value=a:null),L],placeholder:"Plage de dates",items:t(me),label:t(d)+" - "+t(p)},null,8,["modelValue","items","label"])]),_:1}),t(P)?(r(),m(y,{key:0,cols:"12",sm:"3"},{default:s(()=>[l(Q,{modelValue:t(d),"onUpdate:modelValue":e[5]||(e[5]=a=>i(d)?d.value=a:null),label:"Début",placeholder:"date"},null,8,["modelValue"])]),_:1})):c("",!0),t(P)?(r(),m(y,{key:1,cols:"12",sm:"3"},{default:s(()=>[l(Q,{modelValue:t(p),"onUpdate:modelValue":e[6]||(e[6]=a=>i(p)?p.value=a:null),label:"Fin",placeholder:"date"},null,8,["modelValue"])]),_:1})):c("",!0)]),_:1})]),_:1}),l(re),ae("div",He,[l(Le),ae("div",Ke,[l(R,{modelValue:t(v),"onUpdate:modelValue":e[7]||(e[7]=a=>i(v)?v.value=a:null),items:[5,10,20,25,50]},null,8,["modelValue"]),t(S)("create","ramassage")?(r(),m(A,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:e[8]||(e[8]=a=>t(H).push({name:"ramassage-add"}))},{default:s(()=>e[17]||(e[17]=[_(" Ajouter Ramassage ")])),_:1})):c("",!0)])]),l(re,{class:"mt-4"}),l(xe,{"items-per-page":t(v),"onUpdate:itemsPerPage":e[10]||(e[10]=a=>i(v)?v.value=a:null),page:t(V),"onUpdate:page":e[11]||(e[11]=a=>i(V)?V.value=a:null),loading:t(ye),headers:ce,items:t(ke),"items-length":t(K),class:"text-no-wrap",locale:"fr","onUpdate:options":Ve},{"item.code":s(({item:a})=>[t(S)("show","ramassage")?(r(),m(A,{key:0,variant:"text",onClick:U=>_e(a)},{default:s(()=>[_(M(a.code),1)]),_:2},1032,["onClick"])):(r(),te("span",Ye,M(a.code),1))]),"item.statut":s(({item:a})=>[l(qe,le(("statutInfos"in o?o.statutInfos:t(h))(a.statut),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":s(({item:a})=>[a.statut=="EN_ATTENTE"&&t(S)("update","ramassage")?(r(),m(X,{key:0,onClick:U=>t(H).push("/ramassage/"+a.id)},{default:s(()=>[l(se,{icon:"tabler-edit"})]),_:2},1032,["onClick"])):c("",!0),a.statut=="EN_ATTENTE"?(r(),m(X,{key:1},{default:s(()=>[l(se,{icon:"tabler-dots-vertical"}),l(We,{activator:"parent"},{default:s(()=>[l(Fe,null,{default:s(()=>[t(S)("delete","ramassage")?(r(),m(ie,{key:0,value:"delete","prepend-icon":"tabler-trash",onClick:U=>ve(a)},{default:s(()=>e[18]||(e[18]=[_(" Delete ")])),_:2},1032,["onClick"])):c("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)):c("",!0)]),bottom:s(()=>[l(Ie,{page:t(V),"onUpdate:page":e[9]||(e[9]=a=>i(V)?V.value=a:null),"items-per-page":t(v),"total-items":t(K)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items","items-length"]),l(ze,{modelValue:t(f),"onUpdate:modelValue":e[14]||(e[14]=a=>i(f)?f.value=a:null),persistent:"",class:"v-dialog-sm"},{default:s(()=>[l(Se,{onClick:e[12]||(e[12]=a=>f.value=!t(f))}),l(ue,{title:"Êtes-vous sûr de vouloir supprimer le ramassage "+t(B).code+" ?"},{default:s(()=>[l(oe,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[l(A,{color:"secondary",variant:"tonal",onClick:e[13]||(e[13]=a=>f.value=!1)},{default:s(()=>e[19]||(e[19]=[_(" Non ")])),_:1}),l(A,{loading:t(x),onClick:ge},{default:s(()=>e[20]||(e[20]=[_(" Oui ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),t(D)?(r(),m(Te,{key:0,"is-print-ramassage":t(D),"onUpdate:isPrintRamassage":e[15]||(e[15]=a=>i(D)?D.value=a:null),item:t(fe)},null,8,["is-print-ramassage","item"])):c("",!0),t(I)?(r(),m(Ce,{id:t(J),key:t(Y),"is-show-item":t(I),"onUpdate:isShowItem":e[16]||(e[16]=a=>i(I)?I.value=a:null),onFetchItems:t(G)},null,8,["id","is-show-item","onFetchItems"])):c("",!0)])}}};export{ht as default};
