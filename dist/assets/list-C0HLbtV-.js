import{s as L,_ as $e,a as Ie,V as Oe,b as Ue,c as Pe,d as pe,e as qe,Q as De}from"./VTabs-B7mJAAOY.js";import{r as te,V as ye,$ as X}from"./VForm-CJrumaOn.js";import{r as d,w as ae,Y as z,c as T,o as p,b as t,F as se,h as le,f as A,e as s,v as k,x as v,n as e,ak as R,d as a,m as N,ai as P,A as W,aq as Ve,as as ce,J as fe,$ as oe,s as we,K as _e,H as ve,j as je,a as Fe}from"./index-CJ4IgJQr.js";import{_ as ue}from"./AppTextField-CrAlU6gB.js";import{_ as Ee}from"./AppSelect-DWxu4sV5.js";import{_ as he}from"./AppTextarea-BB8sFHme.js";import{t as F}from"./toast-BK7ruyfP.js";import{V as ge}from"./VAlert-BFbpBBE9.js";import{V as O,a as V}from"./VRow-_wUxO3gL.js";import{V as ee,a as Me}from"./VList-jbM3Woii.js";import{_ as xe}from"./DialogCloseBtn-CA2OX9nj.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ne}from"./VCard-C6PGjlKr.js";import{V as re}from"./VCardText-BGBPTyEd.js";import{V as be,b as Be,a as Le,_ as Ge,c as ze}from"./VDataTableServer-BywS9XHK.js";import{V as Se}from"./VChip-Bnp3FgHr.js";import{V as J}from"./VDivider-aP-yZROD.js";import{V as Ae}from"./VDialog-mPk1sZIA.js";import{V as He}from"./VNodeRenderer-CbKLgVqJ.js";import{u as Ke}from"./index-Bbews3C0.js";import{V as Qe}from"./VSpacer-BXWztqgn.js";import{V as We}from"./VMenu-CC2pladv.js";import"./VOverlay-D45V686F.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-Dt1V5UNN.js";import"./VTextField-B_SWCDg5.js";import"./VSelect-BtTR3FRa.js";import"./VAvatar-CyoIQH2Z.js";/* empty css              */import"./filter-CcSIQiU4.js";const Ye={__name:"Entrepot",props:{item:{type:Object,required:!0},isShowEntrepot:{type:Boolean,required:!0}},emits:["hideEntrepot"],setup(H,{emit:$}){const _=H,S=$,E=d({}),g=d("");ae(()=>_.item,r=>{E.value=r},{immediate:!0});const f=d(),x=d(!1),u=d([]),b=d([]),G=d([]),y=d(!1),w=d(!1),q=async()=>{const{valid:r}=await f.value.validate();r&&await K()},M=()=>{S("hideEntrepot")},K=r=>{x.value=!0,y.value=!1,y.value=!1,X({method:"POST",url:"/api/scannerEntrepot",data:{ramassage_id:E.value.id,commonColis:l.value,duplicatedColis:U.value,externeColis:Y.value,missingColis:h.value}}).then(async n=>{if(n.status===200){let C=n.data;console.log(C),u.value=C.success,b.value=C.errors,G.value=C.colisError,y.value=!0,w.value=b.value.length==0}x.value=!1}).catch(n=>{x.value=!1,n.response&&n.response.status===422?F.error(n.response.data.message):F.error("something wrong")})},o=z(()=>E.value.colis.map(r=>r.code)),c=z(()=>g.value?g.value.split(`
`).map(r=>r.trim()).filter(r=>r.length>0):[]),U=z(()=>c.value.filter((r,n,C)=>C.indexOf(r)!==n)),Y=z(()=>{const r=new Set(o.value);let n=c.value.filter(C=>!r.has(C));return n=new Set(n),[...n]}),h=z(()=>{const r=new Set(c.value);return o.value.filter(n=>!r.has(n))}),l=z(()=>{const r=new Set(o.value),n=new Set(c.value);return[...r].filter(C=>n.has(C))});return(r,n)=>{const C=he;return p(),T(se,null,[(p(!0),T(se,null,le(e(u),(B,D)=>(p(),A(ge,{key:D,modelValue:e(w),"onUpdate:modelValue":n[0]||(n[0]=Q=>R(w)?w.value=Q:null),color:"success",class:"ma-1"},{default:s(()=>[k(v(B),1)]),_:2},1032,["modelValue"]))),128)),(p(!0),T(se,null,le(e(b),(B,D)=>(p(),A(ge,{key:D,modelValue:e(y),"onUpdate:modelValue":n[1]||(n[1]=Q=>R(y)?y.value=Q:null),color:"error",class:"ma-1"},{default:s(()=>[k(v(B),1)]),_:2},1032,["modelValue"]))),128)),t(ye,{ref_key:"refForm",ref:f,class:"mt-3"},{default:s(()=>[a("div",null,[t(O,{class:"d-flex align-center justify-center"},{default:s(()=>[t(V,{cols:"12"},{default:s(()=>[t(C,{modelValue:e(g),"onUpdate:modelValue":n[2]||(n[2]=B=>R(g)?g.value=B:null),rows:"5","row-height":"20",label:"Scanner",rules:["requiredValidator"in r?r.requiredValidator:e(te)],placeholder:"Select pour scanner"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),t(O,null,{default:s(()=>[e(G).length>0?(p(),A(V,{key:0,cols:"12",md:"3"},{default:s(()=>[n[3]||(n[3]=a("p",{class:"text-error"}," Colis erroné ",-1)),t(ee,{items:e(G),class:"border border-error border-opacity-75"},null,8,["items"])]),_:1})):N("",!0),e(U).length>0?(p(),A(V,{key:1,cols:"12",md:"3"},{default:s(()=>[n[4]||(n[4]=a("p",{class:"text-error"}," Colis dupliqués ",-1)),t(ee,{items:e(U),class:"border border-error border-opacity-75"},null,8,["items"])]),_:1})):N("",!0),t(V,{cols:"12",md:"3"},{default:s(()=>[n[5]||(n[5]=k(" Colis manquant ")),t(ee,{items:e(h)},null,8,["items"])]),_:1}),t(V,{cols:"12",md:"3"},{default:s(()=>[n[6]||(n[6]=k(" Colis externe ")),t(ee,{items:e(Y)},null,8,["items"])]),_:1})]),_:1}),t(O,null,{default:s(()=>[t(V,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:s(()=>[t(P,{color:"secondary",onClick:M},{default:s(()=>n[7]||(n[7]=[k(" retour ")])),_:1}),t(P,{loading:e(x),onClick:q},{default:s(()=>n[8]||(n[8]=[k(" Envoyer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)],64)}}},Je={key:0,class:"text-center"},Xe={key:0},Ze={key:1},et={class:"text-center"},tt={key:0},st={key:1},at={__name:"actionsRamassage",props:{currentStatut:{type:String,required:!0},item:{type:Object,required:!0},id:{type:Number,required:!0}},setup(H){const $=H,_=d({}),S=d(""),E=d(!1),g=d(),f=d({id:null,statut:"",nombre_colis_ramasseur:"",commentaire:"",date:"",file:""}),x=()=>{E.value=!1,b.value=!1};ae(()=>$.currentStatut,o=>{S.value=o},{immediate:!0}),ae(()=>$.item,o=>{_.value=o},{immediate:!0});const u=d(""),b=d(!1),G=o=>{E.value=!0,f.value.statut=o,o=="ENTREPOT"&&(b.value=!0)},y=async()=>{const{valid:o}=await g.value.validate();o&&await w(f.value.statut)},w=async o=>{f.value.statut=o,f.value.id=$.id,u.value=o,X({method:"POST",url:"/api/updateStatutRamassage",data:f.value}).then(async c=>{c.status===200&&(F.success(c.data),o!="COMMENTAIRE"&&(S.value=o),E.value=!1),u.value=""}).catch(c=>{u.value="",c.response&&c.response.status===422?F.error(c.response.data.message):F.error("something wrong")})},q=W("livreur","action"),M=W("gestionnaire","action"),K=z(()=>{let o=[];return o.push({text:"Commentaire",color:"secondary",statut:"COMMENTAIRE"}),S.value=="REPORTE"&&(q||M)&&o.push({...L("EN_COURS_RAMASSAGE"),statut:"EN_COURS_RAMASSAGE"}),S.value=="EN_ATTENTE"?q&&o.push({...L("EN_COURS_RAMASSAGE"),statut:"EN_COURS_RAMASSAGE"}):S.value=="EN_COURS_RAMASSAGE"||S.value=="REPORTE"?(q&&(o.push({statut:"RAMASSE",...L("RAMASSE")}),o.push({statut:"REPORTE",...L("REPORTE")})),M&&o.push({statut:"ANNULE",...L("ANNULE")})):S.value=="RAMASSE"&&M&&(o.push({...L("ENTREPOT"),statut:"ENTREPOT"}),_.value.colis.length==0&&o.push({statut:"ANNULE",...L("ANNULE")})),o});return(o,c)=>{const U=Ye,Y=ue,h=$e,l=he;return e(E)?(p(),T("div",Ze,[e(f).statut=="ENTREPOT"&&e(b)?(p(),A(U,{key:0,"is-show-entrepot":e(b),"onUpdate:isShowEntrepot":c[0]||(c[0]=r=>R(b)?b.value=r:null),"hide-entrepot":"",item:e(_),onHideEntrepot:x},null,8,["is-show-entrepot","item"])):(p(),A(ye,{key:1,ref_key:"refForm",ref:g,class:"mt-3"},{default:s(()=>[a("p",et," Statut à envoyer : "+v(("statutInfos"in o?o.statutInfos:e(L))(e(f).statut).text),1),e(f).statut=="RAMASSE"?(p(),T("div",tt,[t(O,{class:"d-flex align-center justify-center"},{default:s(()=>[t(V,{md:"6",cols:"12"},{default:s(()=>[t(Y,{modelValue:e(f).nombre_colis_ramasseur,"onUpdate:modelValue":c[1]||(c[1]=r=>e(f).nombre_colis_ramasseur=r),rules:["requiredValidator"in o?o.requiredValidator:e(te)],placeholder:"Nombre de colis",label:"Nombre de colis",type:"number"},null,8,["modelValue","rules"])]),_:1})]),_:1})])):N("",!0),e(f).statut=="REPORTE"?(p(),T("div",st,[t(O,{class:"d-flex align-center justify-center"},{default:s(()=>[t(V,{md:"6",cols:"12"},{default:s(()=>[t(h,{modelValue:e(f).date,"onUpdate:modelValue":c[2]||(c[2]=r=>e(f).date=r),rules:["requiredValidator"in o?o.requiredValidator:e(te)],label:"Date & TIme",placeholder:"Select date and time",config:{enableTime:!0,dateFormat:"Y-m-d H:i"}},null,8,["modelValue","rules"])]),_:1})]),_:1})])):N("",!0),a("div",null,[t(O,{class:"d-flex align-center justify-center"},{default:s(()=>[t(V,{md:"6",cols:"12"},{default:s(()=>[t(l,{modelValue:e(f).commentaire,"onUpdate:modelValue":c[3]||(c[3]=r=>e(f).commentaire=r),rows:"2","row-height":"20",label:"Commentaire",rules:["COMMENTAIRE","REPORTE","ANNULE"].includes(e(f).statut)?["requiredValidator"in o?o.requiredValidator:e(te)]:[],placeholder:"Commentaire"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),t(O,null,{default:s(()=>[t(V,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:s(()=>[t(P,{color:"secondary",onClick:c[4]||(c[4]=r=>E.value=!1)},{default:s(()=>c[5]||(c[5]=[k(" retour ")])),_:1}),t(P,{loading:e(u)==e(f).statut,onClick:y},{default:s(()=>c[6]||(c[6]=[k(" Envoyer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512))])):(p(),T("div",Je,[(p(!0),T(se,null,le(e(K),(r,n)=>(p(),A(P,{key:n,color:r.color,class:"ma-1",loading:e(u)==r.statut,onClick:C=>G(r.statut)},{default:s(()=>[k(v(r.text),1)]),_:2},1032,["color","loading","onClick"]))),128)),e(K).length==0?(p(),T("div",Xe," Aucune action requise ")):N("",!0)]))}}},lt={key:0,class:"text-end position-absolute right-0"},ot={class:"text-body-1 mb-2"},nt={class:"text-body-1 mb-2"},rt={class:"text-body-1 mb-2"},it={key:0},ut={class:"text-body-1 mb-2"},dt={class:"text-body-1 mb-2"},mt={class:"text-body-1 mb-2"},pt={class:"text-body-1 mb-2"},ct={class:"text-body-1 mb-2"},ft={class:"text-body-1 mb-2"},_t={__name:"ShowRamassage",props:{id:{type:Object,required:!1},isShowItem:{type:Boolean,required:!0}},emits:["update:isShowItem","fetchItems"],async setup(H,{emit:$}){let _,S;const E=H,g=$;let f={id:"",nom_vendeur:"",tel_vendeur:"",frais_ramasseur:"",tel_ramasseur:"",tarif_id:"",adresse:"",ramasseur:"",ramasseur_id:"",statut:"",vendeur:"",nombre_colis:"",colis:[],histories:[]};const x=([_,S]=Ve(()=>X("/api/ramasseurs").then(h=>h.data)),_=await _,S(),_),u=d(structuredClone(ce(f))),b=d(!1),G=async h=>{b.value=!0,await X("/api/ramassage/"+h).then(async l=>{l.status===200&&(u.value=l.data),b.value=!1}).catch(l=>{b.value=!1,l.response&&l.response.status===422?F.error(l.response.data.message):F.error("something wrong")})};ae(()=>E.id,h=>{G(h)},{immediate:!0});const y=()=>{g("update:isShowItem",!1),g("fetchItems"),u.value=structuredClone(ce(f))},w=d(!1),q=W("gestionnaire","action"),M=W("livreur","action"),K=h=>{w.value=!0,X({method:"POST",url:"/api/parametrerRamassage",data:{id:u.value.id,ramasseur_id:u.value.ramasseur_id,frais_ramasseur:u.value.frais_ramasseur}}).then(async l=>{l.status===200&&F.success(l.data),w.value=!1}).catch(l=>{w.value=!1,l.response&&l.response.status===422?F.error(l.response.data.message):F.error("something wrong")})},o=d("Actions"),c=["tabler-adjustments-share","tabler-logs"],U=d(!1),Y=[{title:"code",key:"code"},{title:"destination",key:"destination"}];return(h,l)=>{const r=xe,n=at,C=qe,B=Ee,D=ue,Q=Ie;return p(),A(Ae,{width:h.$vuetify.display.smAndDown?"auto":900,"model-value":E.isShowItem,scrollable:"","onUpdate:modelValue":y},{default:s(()=>[t(r,{onClick:y}),t(Q,{title:"Details Ramassage",loading:e(b),"no-actions":""},{default:s(()=>[t(ne,null,{default:s(()=>[fe(t(re,null,{default:s(()=>[e(q)?(p(),T("div",lt,[t(P,{icon:"",class:"rounded-0",onClick:l[0]||(l[0]=I=>U.value=!0)},{default:s(()=>[t(oe,{size:"22",icon:"tabler-settings"})]),_:1})])):N("",!0),t(O,null,{default:s(()=>[t(V,{cols:"12",lg:"6"},{default:s(()=>[t(be,{class:"billing-address-table"},{default:s(()=>[a("tr",null,[l[6]||(l[6]=a("td",null,[a("h6",{class:"text-h6 text-no-wrap mb-2"}," Code : ")],-1)),a("td",null,[a("p",ot,v(e(u).code),1)])]),a("tr",null,[l[7]||(l[7]=a("td",null,[a("h6",{class:"text-h6 text-no-wrap mb-2"}," Ramasseur : ")],-1)),a("td",null,[a("p",nt,v(e(u).ramasseur),1)])]),a("tr",null,[l[8]||(l[8]=a("td",null,[a("h6",{class:"text-h6 text-no-wrap mb-2"}," Tel Ramasseur: ")],-1)),a("td",null,[a("p",rt,v(e(u).tel_ramasseur),1)])]),e(M)?(p(),T("tr",it,[l[9]||(l[9]=a("td",null,[a("h6",{class:"text-h6 text-no-wrap mb-2"}," Frais de ramassage: ")],-1)),a("td",null,[a("p",ut,v(e(u).frais_ramasseur),1)])])):N("",!0),a("tr",null,[l[10]||(l[10]=a("td",null,[a("h6",{class:"text-h6 text-no-wrap mb-2"}," Destination : ")],-1)),a("td",null,[a("p",dt,v(e(u).destination),1)])]),a("tr",null,[l[11]||(l[11]=a("td",null,[a("h6",{class:"text-h6 text-no-wrap mb-2"}," Statut: ")],-1)),a("td",null,[a("p",mt,[t(Se,we(("statutInfos"in h?h.statutInfos:e(L))(e(u).statut),{density:"default",label:"",size:"small"}),null,16)])])])]),_:1})]),_:1}),t(V,{cols:"12",lg:"6"},{default:s(()=>[t(be,{class:"billing-address-table"},{default:s(()=>[a("tr",null,[l[12]||(l[12]=a("td",null,[a("h6",{class:"text-h6 text-no-wrap mb-2"}," Vendeur: ")],-1)),a("td",null,[a("p",pt,v(e(u).vendeur),1)])]),a("tr",null,[l[13]||(l[13]=a("td",null,[a("h6",{class:"text-h6 text-no-wrap mb-2"}," Tel Vendeur: ")],-1)),a("td",null,[a("p",ct,v(e(u).tel_vendeur),1)])]),a("tr",null,[l[14]||(l[14]=a("td",null,[a("h6",{class:"text-h6 text-no-wrap mb-2"}," Colis: ")],-1)),a("td",null,[a("p",ft,v(e(u).nombre_colis),1)])])]),_:1})]),_:1})]),_:1}),t(Oe,{modelValue:e(o),"onUpdate:modelValue":l[1]||(l[1]=I=>R(o)?o.value=I:null),grow:"",class:"disable-tab-transition",stacked:""},{default:s(()=>[(p(),T(se,null,le(c,(I,ie)=>t(Ue,{key:ie},{default:s(()=>[t(oe,{size:"40",icon:I},null,8,["icon"])]),_:2},1024)),64))]),_:1},8,["modelValue"]),t(Pe,{modelValue:e(o),"onUpdate:modelValue":l[2]||(l[2]=I=>R(o)?o.value=I:null),class:"mt-3"},{default:s(()=>[t(pe,null,{default:s(()=>[t(n,{id:e(u).id,"current-statut":e(u).statut,item:e(u)},null,8,["id","current-statut","item"])]),_:1}),t(pe,null,{default:s(()=>[t(C,{histories:e(u).histories},null,8,["histories"])]),_:1})]),_:1},8,["modelValue"]),t(J,{color:"white",thickness:"1",opacity:"0.2",class:"my-6"}),t(Be,{headers:Y,items:e(u).colis,"items-per-page":5},null,8,["items"])]),_:1},512),[[_e,!e(U)]]),e(q)?fe((p(),A(re,{key:0},{default:s(()=>[t(O,null,{default:s(()=>[t(V,{md:"6",cols:"12"},{default:s(()=>[t(B,{modelValue:e(u).ramasseur_id,"onUpdate:modelValue":l[3]||(l[3]=I=>e(u).ramasseur_id=I),placeholder:"Ramasseurs",label:"Ramasseurs",items:e(x),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),t(V,{cols:"12",md:"6"},{default:s(()=>[t(D,{modelValue:e(u).frais_ramasseur,"onUpdate:modelValue":l[4]||(l[4]=I=>e(u).frais_ramasseur=I),rules:["requiredValidator"in h?h.requiredValidator:e(te)],label:"Frais de ramassage",type:"number",placeholder:"Frais de ramassage"},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(O,null,{default:s(()=>[t(V,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:s(()=>[t(P,{color:"secondary",onClick:l[5]||(l[5]=I=>U.value=!1)},{default:s(()=>l[15]||(l[15]=[k(" retour ")])),_:1}),t(P,{loading:e(w),onClick:K},{default:s(()=>l[16]||(l[16]=[k(" Envoyer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)),[[_e,e(U)]]):N("",!0)]),_:1})]),_:1},8,["loading"])]),_:1},8,["width","model-value"])}}},vt=Ce(_t,[["__scopeId","data-v-d4a39828"]]),gt={key:0},bt={id:"print-area"},yt={class:"print-content"},Vt={class:"props.item-header-preview d-flex flex-wrap justify-space-between flex-column flex-sm-row print-row bg-var-theme-background gap-6 rounded"},wt={class:"d-flex align-center app-logo"},Et={class:"app-logo-title"},ht={class:"d-flex align-center destination"},xt={class:"d-flex flex-wrap justify-space-between flex-column flex-sm-row gap-6"},Ct={class:"mb-0"},St={class:"mb-0"},At={class:"mb-0"},kt={class:"mb-0"},Rt={class:"mb-0"},Tt={class:"mb-0"},Nt={class:"mb-0"},$t={class:"mb-0"},It={__name:"printRamassage",props:{item:{type:Object,required:!0},isPrintColis:{type:Boolean,required:!0}},emits:["update:isPrintColis"],setup(H,{emit:$}){const _=H,S=$;return setTimeout(()=>{window.print()},500),window.onafterprint=function(){S("update:isPrintColis",!1)},(E,g)=>_.isPrintColis?(p(),T("div",gt,[a("div",bt,[a("div",yt,[t(ne,{class:"props.item-preview-wrapper"},{default:s(()=>[g[0]||(g[0]=a("div",null,null,-1)),a("div",Vt,[a("div",null,[a("div",wt,[t(e(He),{nodes:e(ve).app.logo},null,8,["nodes"]),a("h6",Et,v(e(ve).app.title),1)])]),a("div",ht,v(_.item.destination),1)]),t(J,{class:"border-solid"}),t(O,{class:"print-row little-margin"},{default:s(()=>[t(V,{class:"text"},{default:s(()=>[a("div",xt,[a("div",null,[a("p",Ct," Code : "+v(_.item.code),1),a("p",St," Nom : "+v(_.item.nom_client),1),a("p",At," tel : "+v(_.item.tel_client),1)]),a("div",null,[a("p",kt,[t(De,{size:"70",value:_.item.code},null,8,["value"])])])]),a("p",Rt," Adresse : "+v(_.item.adresse),1)]),_:1})]),_:1}),t(J,{class:"border-solid"}),t(O,{class:"align-right little-margin"},{default:s(()=>[t(V,{cols:"12"},{default:s(()=>[a("p",Tt," Produits : "+v(_.item.produit),1),a("p",Nt," Montant : "+v(_.item.montant),1)]),_:1})]),_:1}),t(J,{class:"border-solid"}),t(O,{class:"align-right little-margin"},{default:s(()=>[t(V,{cols:"12"},{default:s(()=>[a("p",$t," essayage : "+v(_.item.essayage?"OUI":"NON")+" | ouvrir : "+v(_.item.ouvrir?"OUI":"NON")+" | echange : "+v(_.item.echange?"OUI":"NON"),1)]),_:1})]),_:1}),t(J,{class:"border-solid"}),g[1]||(g[1]=a("p",{class:"mb-0"},[a("span",null," Remarque: "),a("span",null,"Entrepirse de livraison n'est pas responsable sur vos achat")],-1))]),_:1})])])])):N("",!0)}},Ot=Ce(It,[["__scopeId","data-v-f626c156"]]),Ut={class:"d-flex flex-wrap gap-4 ma-6"},Pt={class:"d-flex gap-4 flex-wrap align-center"},qt={key:1},fs={__name:"list",async setup(H){let $,_;const S=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"destination",key:"destination",sortable:!1},{title:"Nombre de colis",key:"nombre_colis",sortable:!1},{title:"Vendeur",key:"vendeur",sortable:!1},{title:"actions",key:"actions",sortable:!1}],E=d(),g=d(),f=d(!1),x=d(!1),u=d(),b=d(!1),G=d(),y=d(5),w=d(1),q=d(),M=d(),K=j=>{x.value=!0,u.value=j},o=async()=>{let j="/api/ramassage/"+u.value.id;f.value=!0,X({method:"DELETE",url:j}).then(async i=>{i.status===200&&(x.value=!1,F.success(i.data),r()),f.value=!1}).catch(i=>{f.value=!1})},c=j=>{var i,Z;q.value=(i=j.sortBy[0])==null?void 0:i.key,M.value=(Z=j.sortBy[0])==null?void 0:Z.order},{data:U,error:Y,statusCode:h,isFetching:l,execute:r}=([$,_]=Ve(()=>Ke(ze("/api/ramassage",{query:{code:E,statut:g,page:w,itemsPerPage:y,sortBy:q,orderBy:M}}))),$=await $,_(),$),n=je(),C=z(()=>U.value.items),B=z(()=>U.value.total),D=d(!1),Q=d(0),I=d(0),ie=j=>{I.value=j.id,Q.value++,D.value=!0};return(j,i)=>{const Z=ue,ke=Ee,de=Fe("IconBtn"),Re=Ge,Te=xe,Ne=vt;return p(),T("div",null,[t(ne,{title:"Filtres",class:"mb-6 d-print-none"},{default:s(()=>[t(re,null,{default:s(()=>[t(O,null,{default:s(()=>[t(V,{cols:"12",sm:"2"},{default:s(()=>[t(Z,{modelValue:e(g),"onUpdate:modelValue":i[0]||(i[0]=m=>R(g)?g.value=m:null),placeholder:"Statut"},null,8,["modelValue"])]),_:1}),t(V,{cols:"12",sm:"2"},{default:s(()=>[t(Z,{modelValue:e(E),"onUpdate:modelValue":i[1]||(i[1]=m=>R(E)?E.value=m:null),placeholder:"Code"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(J),a("div",Ut,[t(Qe),a("div",Pt,[t(ke,{modelValue:e(y),"onUpdate:modelValue":i[2]||(i[2]=m=>R(y)?y.value=m:null),items:[5,10,20,25,50]},null,8,["modelValue"]),e(W)("create","ramassage")?(p(),A(P,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:i[3]||(i[3]=m=>e(n).push({name:"ramassage-add"}))},{default:s(()=>i[12]||(i[12]=[k(" Ajouter Ramassage ")])),_:1})):N("",!0)])]),t(J,{class:"mt-4"}),t(Le,{"items-per-page":e(y),"onUpdate:itemsPerPage":i[5]||(i[5]=m=>R(y)?y.value=m:null),page:e(w),"onUpdate:page":i[6]||(i[6]=m=>R(w)?w.value=m:null),loading:e(l),headers:S,items:e(C),"items-length":e(B),class:"text-no-wrap",locale:"fr","onUpdate:options":c},{"item.code":s(({item:m})=>[e(W)("show","ramassage")?(p(),A(P,{key:0,variant:"text",onClick:me=>ie(m)},{default:s(()=>[k(v(m.code),1)]),_:2},1032,["onClick"])):(p(),T("span",qt,v(m.code),1))]),"item.statut":s(({item:m})=>[t(Se,we(("statutInfos"in j?j.statutInfos:e(L))(m.statut),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":s(({item:m})=>[m.statut=="EN_ATTENTE"&&e(W)("update","ramassage")?(p(),A(de,{key:0,onClick:me=>e(n).push("/ramassage/"+m.id)},{default:s(()=>[t(oe,{icon:"tabler-edit"})]),_:2},1032,["onClick"])):N("",!0),m.statut=="EN_ATTENTE"?(p(),A(de,{key:1},{default:s(()=>[t(oe,{icon:"tabler-dots-vertical"}),t(We,{activator:"parent"},{default:s(()=>[t(ee,null,{default:s(()=>[e(W)("delete","ramassage")?(p(),A(Me,{key:0,value:"delete","prepend-icon":"tabler-trash",onClick:me=>K(m)},{default:s(()=>i[13]||(i[13]=[k(" Delete ")])),_:2},1032,["onClick"])):N("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)):N("",!0)]),bottom:s(()=>[t(Re,{page:e(w),"onUpdate:page":i[4]||(i[4]=m=>R(w)?w.value=m:null),"items-per-page":e(y),"total-items":e(B)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items","items-length"]),t(Ae,{modelValue:e(x),"onUpdate:modelValue":i[9]||(i[9]=m=>R(x)?x.value=m:null),persistent:"",class:"v-dialog-sm"},{default:s(()=>[t(Te,{onClick:i[7]||(i[7]=m=>x.value=!e(x))}),t(ne,{title:"Êtes-vous sûr de vouloir supprimer le ramassage "+e(u).code+" ?"},{default:s(()=>[t(re,{class:"d-flex justify-end gap-3 flex-wrap"},{default:s(()=>[t(P,{color:"secondary",variant:"tonal",onClick:i[8]||(i[8]=m=>x.value=!1)},{default:s(()=>i[14]||(i[14]=[k(" Non ")])),_:1}),t(P,{loading:e(f),onClick:o},{default:s(()=>i[15]||(i[15]=[k(" Oui ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),e(b)?(p(),A(Ot,{key:0,"is-print-ramassage":e(b),"onUpdate:isPrintRamassage":i[10]||(i[10]=m=>R(b)?b.value=m:null),item:e(G)},null,8,["is-print-ramassage","item"])):N("",!0),e(D)?(p(),A(Ne,{id:e(I),key:e(Q),"is-show-item":e(D),"onUpdate:isShowItem":i[11]||(i[11]=m=>R(D)?D.value=m:null),onFetchItems:e(r)},null,8,["id","is-show-item","onFetchItems"])):N("",!0)])}}};export{fs as default};
