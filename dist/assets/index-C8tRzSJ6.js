import{_ as ee}from"./AddEditRoleDialog-impIj2j-.js";import{V as te,_ as oe,c as le}from"./VDataTableServer-BdHPifpA.js";import{_ as ae}from"./AppSelect-QRYdQcLn.js";import{_ as se}from"./AppTextField-C8pU9PIj.js";import{A as R,r as s,w as ie,aq as T,j as re,Y as I,a as ne,c as U,o as d,d as w,b as l,e as a,ak as i,n as o,f as q,m as E,ai as j,v as L,$ as me,s as pe,F as z,h as ue,x as O}from"./index-ozxdH-7b.js";import{$ as de}from"./api-Dx5SAhyB.js";import{u as ce}from"./index-CuMPislM.js";import{V as fe}from"./VCardText-DsXbz0Qj.js";import{V as ve,a as C}from"./VRow-pYCdNr-Y.js";import{V as Y}from"./VDivider-CL3jlbdq.js";import{V as Ve}from"./VSpacer-BHnw5x-1.js";import{V as ge}from"./VChip-DhroVh_v.js";import{V as be}from"./VCard-CNbNQKcS.js";import"./VForm-Dg9jF2bh.js";import"./VInput-Dxr6NkQk.js";import"./VImg-DVerLASX.js";import"./forwardRefs-DWGaNmQL.js";import"./DialogCloseBtn-BXOrtT6i.js";import"./toast-UA7yOy59.js";import"./VTable-mtkxK_Go.js";import"./VCheckbox-UHFyBl-6.js";import"./VCheckboxBtn-CBFQvFM8.js";import"./VSelectionControl-Bxphu3hx.js";import"./VDialog-DzGsOeig.js";import"./VOverlay-DrnfapjL.js";import"./VDataTable-CWdQKmxs.js";import"./VSelect-CUsrGS1v.js";import"./VTextField-DxrlKLh1.js";import"./VList-DvQrXdhf.js";import"./VAvatar-CqlEylcw.js";import"./VMenu-DghzHJlb.js";import"./filter-bht-UASL.js";/* empty css              */import"./VSlideGroup-BJ0_jBgo.js";const xe={class:"d-flex flex-wrap gap-4 ma-6"},_e={class:"d-flex gap-4 flex-wrap align-center"},lt={__name:"index",props:{role:{type:String,required:!0}},async setup(h){let n,c;const G=h,H=[{title:"Nom",key:"lastName",sortable:!1},{title:"Prenom",key:"firstName",sortable:!1},{title:"role",key:"role",sortable:!1,align:R("show","role")?" start":" d-none"},{title:"statut",key:"active",sortable:!1},{title:"actions",key:"actions",sortable:!1}],u=s(),f=s(),v=s(),g=s([]),b=s(!1),x=s(!1);s(!1);const _=s({name:"",permissions:[]});ie(()=>G.role,r=>{u.value=r},{immediate:!0});const J=s([{title:"Active",value:"1"},{title:"Inactive",value:"0"}]),N=([n,c]=T(()=>de("/api/rolesList").then(r=>r.data)),n=await n,c(),n);console.log(N);const m=s(5),p=s(1),B=s(),P=s(),K=r=>{var t,V;B.value=(t=r.sortBy[0])==null?void 0:t.key,P.value=(V=r.sortBy[0])==null?void 0:V.order},{data:A,error:ye,statusCode:ke,isFetching:Q,execute:D}=([n,c]=T(()=>ce(le("/api/users",{query:{active:f,role:u,fullName:v,page:p,itemsPerPage:m,sortBy:B,orderBy:P}}))),n=await n,c(),n),F=re(),W=I(()=>A.value.items),$=I(()=>A.value.total),X=r=>{if(r===1)return{text:"active",color:"success"};if(r===0)return{text:"inactive",color:"warning"}};return(r,t)=>{const V=se,y=ae,Z=ne("IconBtn"),M=oe,S=ee;return d(),U(z,null,[w("div",null,[l(be,{title:"Filtres",class:"mb-6"},{default:a(()=>[l(fe,null,{default:a(()=>[l(ve,null,{default:a(()=>[l(C,{cols:"12",sm:"2"},{default:a(()=>[l(V,{modelValue:o(v),"onUpdate:modelValue":t[0]||(t[0]=e=>i(v)?v.value=e:null),placeholder:"Nom ou prenom"},null,8,["modelValue"])]),_:1}),l(C,{cols:"12",sm:"2"},{default:a(()=>[l(y,{modelValue:o(u),"onUpdate:modelValue":t[1]||(t[1]=e=>i(u)?u.value=e:null),placeholder:"Roles",items:o(N),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),l(C,{cols:"12",sm:"2"},{default:a(()=>[l(y,{modelValue:o(f),"onUpdate:modelValue":t[2]||(t[2]=e=>i(f)?f.value=e:null),placeholder:"Status",items:o(J),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(Y),w("div",xe,[l(Ve),w("div",_e,[l(y,{modelValue:o(m),"onUpdate:modelValue":t[3]||(t[3]=e=>i(m)?m.value=e:null),items:[5,10,20,25,50]},null,8,["modelValue"]),o(R)("create","user")?(d(),q(j,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:t[4]||(t[4]=e=>o(F).push({name:"user-add"}))},{default:a(()=>t[12]||(t[12]=[L(" Ajouter Utilisateur ")])),_:1})):E("",!0)])]),l(Y,{class:"mt-4"}),l(te,{"items-per-page":o(m),"onUpdate:itemsPerPage":t[6]||(t[6]=e=>i(m)?m.value=e:null),"model-value":o(g),"onUpdate:modelValue":t[7]||(t[7]=e=>i(g)?g.value=e:null),page:o(p),"onUpdate:page":t[8]||(t[8]=e=>i(p)?p.value=e:null),loading:o(Q),headers:H,items:o(W),"items-length":o($),class:"text-no-wrap","onUpdate:options":K},{"item.lastName":a(({item:e})=>[l(j,{variant:"text"},{default:a(()=>[L(O(e.lastName),1)]),_:2},1024)]),"item.role":a(({item:e})=>[(d(!0),U(z,null,ue(e.roles,k=>(d(),U("span",{key:k.id},O(k.name+" "),1))),128))]),"item.active":a(({item:e})=>[l(ge,pe(X(e.active),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":a(({item:e})=>[o(R)("update","user")?(d(),q(Z,{key:0,onClick:k=>o(F).push("/user/"+e.id)},{default:a(()=>[l(me,{icon:"tabler-edit"})]),_:2},1032,["onClick"])):E("",!0)]),bottom:a(()=>[l(M,{page:o(p),"onUpdate:page":t[5]||(t[5]=e=>i(p)?p.value=e:null),"items-per-page":o(m),"total-items":o($)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","loading","items","items-length"])]),_:1})]),l(S,{"is-dialog-visible":o(b),"onUpdate:isDialogVisible":t[9]||(t[9]=e=>i(b)?b.value=e:null),onFetchRoles:o(D)},null,8,["is-dialog-visible","onFetchRoles"]),l(S,{"is-dialog-visible":o(x),"onUpdate:isDialogVisible":t[10]||(t[10]=e=>i(x)?x.value=e:null),"role-permissions":o(_),"onUpdate:rolePermissions":t[11]||(t[11]=e=>i(_)?_.value=e:null),onFetchRoles:o(D)},null,8,["is-dialog-visible","role-permissions","onFetchRoles"])],64)}}};export{lt as default};
