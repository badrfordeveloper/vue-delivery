import{V as E,r as I}from"./VForm-BiIm56jG.js";import{_ as O}from"./AppTextField-BaoZ6xiQ.js";import{_ as L}from"./DialogCloseBtn-D7TP1cV5.js";import{$ as D}from"./api-CJxevPF4.js";import{t as F}from"./toast-DqE3X-CW.js";import{V as M}from"./VCard-CjZ-CFls.js";import{V as Y}from"./VCardText-BKSNcZG6.js";import{V as z}from"./VDataTableServer-CgMP1-EQ.js";import{f as G,a as B}from"./VSelect-Cf7bZ_tZ.js";import{b as H,d as J,c as A}from"./VTextField-DmD_WYFy.js";import{a1 as K,al as Q,a8 as W,am as X,an as Z,Y as ee,af as se,aF as ae,b as o,q as T,aq as te,r as P,w as oe,o as x,f as le,e as d,d as m,v as U,m as y,ak as $,c as k,F as q,h as w,ai as j,t as N}from"./index-B8o6XWUs.js";import{V as re}from"./VDialog-Dtir6RYY.js";const ie=K({...H(),...Q(G(),["inline"])},"VCheckbox"),ne=W()({name:"VCheckbox",inheritAttrs:!1,props:ie(),emits:{"update:modelValue":t=>!0,"update:focused":t=>!0},setup(t,_){let{attrs:c,slots:V}=_;const r=X(t,"modelValue"),{isFocused:v,focus:g,blur:n}=J(t),p=Z(),f=ee(()=>t.id||`checkbox-${p}`);return se(()=>{const[u,C]=ae(c),b=A.filterProps(t),s=B.filterProps(t);return o(A,T({class:["v-checkbox",t.class]},u,b,{modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,id:f.value,focused:v.value,style:t.style}),{...V,default:e=>{let{id:a,messagesId:i,isDisabled:l,isReadonly:h,isValid:R}=e;return o(B,T(s,{id:a.value,"aria-describedby":i.value,disabled:l.value,readonly:h.value},C,{error:R.value===!1,modelValue:r.value,"onUpdate:modelValue":S=>r.value=S,onFocus:g,onBlur:n}),V)}})}),{}}}),ue={class:"text-h4 text-center mb-2"},de={class:"text-h6"},me={class:"d-flex justify-end"},ce={class:"d-flex align-center justify-center gap-4"},Ce={__name:"AddEditRoleDialog",props:{rolePermissions:{type:Object,required:!1,default:()=>({name:"",permissions:[]})},isDialogVisible:{type:Boolean,required:!0}},emits:["update:isDialogVisible","update:rolePermissions","fetchRoles"],async setup(t,{emit:_}){let c,V;const r=t,v=_,g=([c,V]=te(()=>D("/api/permissions").then(s=>s.data)),c=await c,V(),c),n=P(""),p=P("POST"),f=P(),u=P([]);oe(()=>r.rolePermissions,s=>{var e;s&&((e=s.permissions)!=null&&e.length||s.name!="")?(p.value="PUT",n.value=s.name,u.value=s.permissions.map(a=>a.name)):p.value="POST"},{immediate:!0});const C=async()=>{const{valid:s}=await f.value.validate();if(s){let e="/api/roles";p.value=="PUT"&&(e="/api/roles/"+r.rolePermissions.id),D({method:p.value,url:e,data:{name:n.value,permissions:u.value}}).then(async a=>{var i;a.status===200&&(F.success(a.data),v("fetchRoles"),v("update:isDialogVisible",!1),(i=f.value)==null||i.reset())}).catch(a=>{if(a.response&&a.response.status===422){const i=a.response.data.errors;for(let l in i)F.error(`${l}: ${i[l].join(", ")}`)}})}},b=()=>{var s;v("update:isDialogVisible",!1),(s=f.value)==null||s.reset()};return(s,e)=>{const a=L,i=O;return x(),le(re,{width:s.$vuetify.display.smAndDown?"auto":900,"model-value":r.isDialogVisible,"onUpdate:modelValue":b},{default:d(()=>[o(a,{onClick:b}),o(M,{class:"pa-sm-10 pa-2"},{default:d(()=>[o(Y,null,{default:d(()=>[m("h4",ue,U(r.rolePermissions.name?"Edit":"Add New")+" Role ",1),e[5]||(e[5]=m("p",{class:"text-body-1 text-center mb-6"}," Set Role Permissions ",-1)),o(y(E),{ref_key:"refPermissionForm",ref:f},{default:d(()=>[o(i,{modelValue:y(n),"onUpdate:modelValue":e[0]||(e[0]=l=>$(n)?n.value=l:null),rules:["requiredValidator"in s?s.requiredValidator:y(I)],label:"Role Name",placeholder:"Enter Role Name"},null,8,["modelValue","rules"]),e[4]||(e[4]=m("h5",{class:"text-h5 my-6"}," Role Permissions ",-1)),o(z,{class:"permission-table text-no-wrap mb-6"},{default:d(()=>[(x(!0),k(q,null,w(y(g),l=>(x(),k("tr",{key:l.subject},[m("td",null,[m("h6",de,U(l.subject),1)]),(x(!0),k(q,null,w(l.actions,h=>(x(),k("td",{key:h.value},[m("div",me,[o(ne,{modelValue:y(u),"onUpdate:modelValue":e[1]||(e[1]=R=>$(u)?u.value=R:null),value:h.value,label:h.label},null,8,["modelValue","value","label"])])]))),128))]))),128))]),_:1}),m("div",ce,[o(j,{onClick:C},{default:d(()=>e[2]||(e[2]=[N(" Submit ")])),_:1}),o(j,{color:"secondary",variant:"tonal",onClick:b},{default:d(()=>e[3]||(e[3]=[N(" Cancel ")])),_:1})])]),_:1},512)]),_:1})]),_:1})]),_:1},8,["width","model-value"])}}};export{Ce as _};
