import{V as R,r as x,$ as E}from"./VForm-KvLnv-Uh.js";import{a7 as F,c as _,o as f,F as q,h as M,b as e,e as s,$ as S,n as t,ai as A,at as N,r as d,i as j,j as P,d as l,H as w,x as z,ah as H,f as U,m as G,v as K,au as b,av as Y}from"./index-zlWi7S3f.js";import{_ as J}from"./AppTextField-D8fU3XDA.js";import{u as I,m as O,a as Q}from"./misc-mask-light-DQ5zsqFZ.js";import{V as W}from"./VNodeRenderer-yqJzyt-S.js";import{a as c,V as D}from"./VRow-szZqHLmm.js";import{V as X}from"./VCard-BLwT3Pm5.js";import{V as C}from"./VCardText-BQSQr54H.js";import{V as Z}from"./VAlert-lVSTag1f.js";import{V as L}from"./VDivider-DBe7lXGo.js";import"./toast-DyK4obtI.js";import"./VTextField-DqeBEujr.js";import"./VImg-CGMeVkM5.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VAvatar-8sdawLAf.js";const ee={class:"d-flex justify-center flex-wrap gap-1"},ae={__name:"AuthProvider",setup(T){const{global:i}=F(),g=[{icon:"tabler-brand-facebook-filled",color:"#4267b2",colorInDark:"#497CE2"},{icon:"tabler-brand-twitter-filled",color:"#1da1f2",colorInDark:"#1da1f2"},{icon:"tabler-brand-github-filled",color:"#272727",colorInDark:"#fff"},{icon:"tabler-brand-google-filled",color:"#dd4b39",colorInDark:"#db4437"}];return(k,V)=>(f(),_("div",ee,[(f(),_(q,null,M(g,n=>e(A,{key:n.icon,icon:"",variant:"text",size:"small",color:t(i).name.value==="dark"?n.colorInDark:n.color},{default:s(()=>[e(S,{size:"20",icon:n.icon},null,8,["icon"])]),_:2},1032,["color"])),64))]))}},te="/assets/auth-v2-login-illustration-bordered-dark-cDkPk8mY.png",oe="/assets/auth-v2-login-illustration-bordered-light-CIHqcIVA.png",se="/assets/auth-v2-login-illustration-dark-ClExSVqL.png",le="/assets/auth-v2-login-illustration-light-C4sKfRS1.png",re=()=>N(),ie={href:"javascript:void(0)"},ne={class:"auth-logo d-flex align-center gap-x-3"},ue={class:"auth-title"},de={class:"position-relative bg-background w-100 me-0"},ce=["src"],Le={__name:"login",setup(T){const i=d(!1);I(le,se,oe,te,!0);const g=I(Q,O),k=re(),V=j(),n=P(),u=d({email:"admin@gmail.com",password:"",remember:!1}),y=d(),h=d(!1),m=d(!1),v=d(!1),$=async()=>{try{m.value=!1,v.value=!0,E.post("/api/auth/login",{email:u.value.email,password:u.value.password}).then(async o=>{const{accessToken:a,userData:p,userAbilityRules:r}=o.data;b("userAbilityRules").value=r,k.update(r),b("userData").value=p,b("accessToken").value=a,m.value=!1,await Y(()=>{n.replace(V.query.to?String(V.query.to):"/")})}).catch(o=>{o.status===403?(h.value=o.response.data.message,m.value=!0):o.status===422&&(h.value="Email ou mot de passe est incorrect",m.value=!0),console.log("error login")}).then(()=>{v.value=!1})}catch(o){console.error(o)}},B=()=>{var o;(o=y.value)==null||o.validate().then(({valid:a})=>{a&&$()})};return(o,a)=>{const p=J;return f(),_(q,null,[l("a",ie,[l("div",ne,[e(t(W),{nodes:t(w).app.logo},null,8,["nodes"]),l("h1",ue,z(t(w).app.title),1)])]),e(D,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:s(()=>[e(c,{md:"8",class:"d-none d-md-flex"},{default:s(()=>[l("div",de,[l("img",{class:"auth-footer-mask flip-in-rtl",src:t(g),alt:"auth-footer-mask",height:"280",width:"100"},null,8,ce)])]),_:1}),e(c,{cols:"12",md:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:s(()=>[e(X,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-6"},{default:s(()=>[e(C,null,{default:s(()=>a[3]||(a[3]=[l("h4",{class:"text-h4 mb-1"}," Login ",-1)])),_:1}),e(C,null,{default:s(()=>[e(R,{ref_key:"refVForm",ref:y,onSubmit:H(B,["prevent"])},{default:s(()=>[e(D,null,{default:s(()=>[t(m)?(f(),U(Z,{key:0,title:t(h),type:"error"},null,8,["title"])):G("",!0),e(c,{cols:"12"},{default:s(()=>[e(p,{modelValue:t(u).email,"onUpdate:modelValue":a[0]||(a[0]=r=>t(u).email=r),rules:["requiredValidator"in o?o.requiredValidator:t(x)],autofocus:"",label:"Email",type:"email",placeholder:"test@gmail.com"},null,8,["modelValue","rules"])]),_:1}),e(c,{cols:"12"},{default:s(()=>[e(p,{modelValue:t(u).password,"onUpdate:modelValue":a[1]||(a[1]=r=>t(u).password=r),rules:["requiredValidator"in o?o.requiredValidator:t(x)],label:"Mot de passe",placeholder:"············",type:t(i)?"text":"password",autocomplete:"password","append-inner-icon":t(i)?"tabler-eye-off":"tabler-eye","onClick:appendInner":a[2]||(a[2]=r=>i.value=!t(i))},null,8,["modelValue","rules","type","append-inner-icon"]),a[5]||(a[5]=l("div",{class:"my-5"},null,-1)),e(A,{loading:t(v),block:"",type:"submit"},{default:s(()=>a[4]||(a[4]=[K(" Login ")])),_:1},8,["loading"])]),_:1}),e(c,{cols:"12",class:"d-flex align-center"},{default:s(()=>[e(L),a[6]||(a[6]=l("span",{class:"mx-4"},"or",-1)),e(L)]),_:1}),e(c,{cols:"12",class:"text-center"},{default:s(()=>[e(ae)]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}};export{Le as default};
