import{$ as x,r as u,P as O,V as $}from"./VForm-B-RrgLOX.js";import{_ as R}from"./AppTextarea-CUdfnPlM.js";import{_ as k}from"./AppAutocomplete-DFFAMqsh.js";import{_ as B}from"./AppTextField-CjMF6sBU.js";import{j as D,r as v,aq as E,ar as P,w as S,c as I,o as M,d as q,b as e,x as z,e as a,n as l,ai as G,v as H,F as L}from"./index-Cn4GOq09.js";import{t as j}from"./toast-Cs2lwIGd.js";import{V as p,a as d}from"./VRow-_eMtTXOa.js";import{V as g}from"./VCard-C8xyqS8Y.js";import{V as w}from"./VCardText-oDAfMypB.js";import{V as h}from"./VInput-DnGVuAhw.js";import{V as C,a as f}from"./VRadioGroup-DNi-Dp71.js";const J={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},K={class:"d-flex flex-column justify-center"},Q={class:"text-h4 font-weight-medium"},de={__name:"FormColis",props:{method:{type:String,required:!0},item:{type:Object,required:!1},identity:{type:String,required:!1}},async setup(A){let V,U;const n=A,F=D(),b=v(),y=v([]),c=v(!1);y.value=([V,U]=E(()=>x("/api/tarifs").then(o=>o.data.items)),V=await V,U(),V);let T={nom_client:"",tel_client:"",tarif_id:"",frais_livraison:"",adresse:"",produit:"",montant:"",commentaire_vendeur:"",essayage:0,ouvrir:0,echange:0};const r=v(structuredClone(P(T)));S(()=>n.item,o=>{n.method=="PUT"&&(r.value={...o})},{immediate:!0}),S(()=>r.value.tarif_id,o=>{const t=y.value.find(s=>s.id===o);r.value.frais_livraison=t?t.tarif+"DH Ã  "+t.delai_livraison:""},{immediate:!0});const N=async()=>{const{valid:o}=await b.value.validate();if(o){let t="/api/colis";n.method=="PUT"&&(t="/api/colis/"+n.identity),c.value=!0,x({method:n.method,url:t,data:r.value}).then(async s=>{var m;s.status===200&&(j.success(s.data),n.method=="POST"?((m=b.value)==null||m.reset(),r.value=structuredClone(P(T))):F.push({name:"colis-list"})),c.value=!1}).catch(s=>{if(c.value=!1,s.response&&s.response.status===422){const m=s.response.data.errors;for(let _ in m)j.error(`${_}: ${m[_].join(", ")}`)}})}};return(o,t)=>{const s=B,m=k,_=R;return M(),I(L,null,[q("div",J,[q("div",K,[q("h4",Q,z(n.method=="POST"?"Ajouter Colis":"Modifier Colis"),1)])]),e($,{ref_key:"refForm",ref:b,class:"mt-3"},{default:a(()=>[e(p,null,{default:a(()=>[e(d,{cols:"12",md:"6"},{default:a(()=>[e(d,{cols:"12",class:"pa-0"},{default:a(()=>[e(g,{title:"Informations du client"},{default:a(()=>[e(w,null,{default:a(()=>[e(p,null,{default:a(()=>[e(d,{md:"6",cols:"12"},{default:a(()=>[e(s,{modelValue:l(r).nom_client,"onUpdate:modelValue":t[0]||(t[0]=i=>l(r).nom_client=i),rules:["requiredValidator"in o?o.requiredValidator:l(u)],placeholder:"Nom",label:"Nom"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(s,{modelValue:l(r).tel_client,"onUpdate:modelValue":t[1]||(t[1]=i=>l(r).tel_client=i),rules:["requiredValidator"in o?o.requiredValidator:l(u),"PhoneValidator"in o?o.PhoneValidator:l(O)],label:"Telephone",size:"10",placeholder:"0655554747"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12",class:"px-0"},{default:a(()=>[e(g,{title:"Informations d'adresse"},{default:a(()=>[e(w,null,{default:a(()=>[e(p,null,{default:a(()=>[e(d,{md:"6",cols:"12"},{default:a(()=>[e(m,{modelValue:l(r).tarif_id,"onUpdate:modelValue":t[2]||(t[2]=i=>l(r).tarif_id=i),rules:["requiredValidator"in o?o.requiredValidator:l(u)],label:"Destination",items:l(y),"item-title":"destination","item-value":"id",placeholder:"Select State"},null,8,["modelValue","rules","items"])]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(s,{modelValue:l(r).frais_livraison,"onUpdate:modelValue":t[3]||(t[3]=i=>l(r).frais_livraison=i),disabled:"",label:"Frais de livraison",placeholder:""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(s,{modelValue:l(r).adresse,"onUpdate:modelValue":t[4]||(t[4]=i=>l(r).adresse=i),"prepend-inner-icon":"tabler-map-pin",rules:["requiredValidator"in o?o.requiredValidator:l(u)],label:"Adresse",placeholder:"Adresse"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(g,{title:"Informations des produits"},{default:a(()=>[e(w,null,{default:a(()=>[e(p,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(s,{modelValue:l(r).produit,"onUpdate:modelValue":t[5]||(t[5]=i=>l(r).produit=i),rules:["requiredValidator"in o?o.requiredValidator:l(u)],label:"Produits",placeholder:"Produits"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6"},{default:a(()=>[e(s,{modelValue:l(r).montant,"onUpdate:modelValue":t[6]||(t[6]=i=>l(r).montant=i),rules:["requiredValidator"in o?o.requiredValidator:l(u)],type:"number",label:"Montant Total",placeholder:"Montant Total"},null,8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6",class:"app-text-field"},{default:a(()=>[e(h,{text:"Essayage",class:"mb-1 text-body-2 text-wrap"}),e(C,{modelValue:l(r).essayage,"onUpdate:modelValue":t[7]||(t[7]=i=>l(r).essayage=i),rules:["requiredValidator"in o?o.requiredValidator:l(u)],inline:""},{default:a(()=>[e(f,{label:"Non",value:0,density:"compact"}),e(f,{label:"Oui",value:1,density:"compact"})]),_:1},8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6",class:"app-text-field"},{default:a(()=>[e(h,{text:"Ouvrir",class:"mb-1 text-body-2 text-wrap"}),e(C,{modelValue:l(r).ouvrir,"onUpdate:modelValue":t[8]||(t[8]=i=>l(r).ouvrir=i),rules:["requiredValidator"in o?o.requiredValidator:l(u)],inline:""},{default:a(()=>[e(f,{label:"Non",value:0,density:"compact"}),e(f,{label:"Oui",value:1,density:"compact"})]),_:1},8,["modelValue","rules"])]),_:1}),e(d,{cols:"12",md:"6",class:"app-text-field"},{default:a(()=>[e(h,{text:"Echange",class:"mb-1 text-body-2 text-wrap"}),e(C,{modelValue:l(r).echange,"onUpdate:modelValue":t[9]||(t[9]=i=>l(r).echange=i),rules:["requiredValidator"in o?o.requiredValidator:l(u)],inline:""},{default:a(()=>[e(f,{label:"Non",value:0,density:"compact"}),e(f,{label:"Oui",value:1,density:"compact"})]),_:1},8,["modelValue","rules"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(_,{modelValue:l(r).commentaire_vendeur,"onUpdate:modelValue":t[10]||(t[10]=i=>l(r).commentaire_vendeur=i),label:"Commentaire",placeholder:"Commentaire",rows:"2","row-height":"20"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(p,null,{default:a(()=>[e(d,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(G,{loading:l(c),onClick:N},{default:a(()=>t[11]||(t[11]=[H(" Enregistrer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)],64)}}};export{de as _};
