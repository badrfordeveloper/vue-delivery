import{s as I}from"./statutInfos-BWJ2EfQa.js";import{r as W,V as de,$ as Y}from"./VForm-DBkm5vGA.js";import{r as _,w as X,Y as F,c as w,o as p,b as e,F as J,h as Z,f as U,e as a,v as R,x as c,n as s,ak as L,d as t,m as q,ai as D,A as ee,aq as ve,as as te,J as se,$ as ae,s as ge,K as le,H as oe}from"./index-C_YW0fvW.js";import{_ as be,V as Ve,a as ye,b as we,c as re,d as he}from"./VTabs-C48FcC9H.js";import{_ as me}from"./AppTextField-Csxyttsa.js";import{_ as Ee}from"./AppSelect-DJKVNHPp.js";import{_ as ce}from"./AppTextarea-D-dBKGPh.js";import{_ as xe}from"./AppDateTimePicker-Cmwcgz18.js";import{t as k}from"./toast-BiWkjqxy.js";import{V as ne}from"./VAlert-Dd9kHGpp.js";import{V as h,a as v}from"./VRow-D1sRQIZD.js";import{V as K}from"./VList-Br68t1cx.js";import{_ as Se}from"./DialogCloseBtn-C_9as8KR.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as fe}from"./VCard-B0VmuzeY.js";import{V as ie}from"./VCardText-imSDmtky.js";import{V as ue,a as Ae}from"./VDataTable-n4gX2-Z8.js";import{V as Ce}from"./VChip-Cyd8RnzN.js";import{V as Q}from"./VDivider-CPJwSM9S.js";import{V as Re}from"./VDialog-CHcYrkUJ.js";import{V as Te}from"./VNodeRenderer-BCPdaQUG.js";import{Q as ke}from"./qrcode.vue.esm-B0-0ln3N.js";const Ne={__name:"Entrepot",props:{item:{type:Object,required:!0},isShowEntrepot:{type:Boolean,required:!0}},emits:["hideEntrepot","getItemData"],setup(P,{emit:M}){const m=P,T=M,x=_({}),f=_("");X(()=>m.item,d=>{x.value=d},{immediate:!0});const S=_(),N=_(!1),o=_([]),A=_([]),y=_([]),b=_(!1),C=_(!1),B=async()=>{const{valid:d}=await S.value.validate();d&&await j()},H=()=>{T("hideEntrepot")},j=d=>{N.value=!0,b.value=!1,b.value=!1,Y({method:"POST",url:"/api/scannerEntrepot",data:{ramassage_id:x.value.id,commonColis:l.value,duplicatedColis:r.value,externeColis:u.value,missingColis:g.value}}).then(async n=>{if(n.status===200){let i=n.data;console.log(i),o.value=i.success,A.value=i.errors,y.value=i.colisError,b.value=!0,C.value=A.value.length==0,A.value.length==0&&T("getItemData")}N.value=!1}).catch(n=>{N.value=!1,n.response&&n.response.status===422?k.error(n.response.data.message):k.error("something wrong")})},V=F(()=>x.value.colis.map(d=>d.code)),$=F(()=>f.value?f.value.split(`
`).map(d=>d.trim()).filter(d=>d.length>0):[]),r=F(()=>$.value.filter((d,n,i)=>i.indexOf(d)!==n)),u=F(()=>{const d=new Set(V.value);let n=$.value.filter(i=>!d.has(i));return n=new Set(n),[...n]}),g=F(()=>{const d=new Set($.value);return V.value.filter(n=>!d.has(n))}),l=F(()=>{const d=new Set(V.value),n=new Set($.value);return[...d].filter(i=>n.has(i))});return(d,n)=>{const i=ce;return p(),w(J,null,[(p(!0),w(J,null,Z(s(o),(O,G)=>(p(),U(ne,{key:G,modelValue:s(C),"onUpdate:modelValue":n[0]||(n[0]=z=>L(C)?C.value=z:null),color:"success",class:"ma-1"},{default:a(()=>[R(c(O),1)]),_:2},1032,["modelValue"]))),128)),(p(!0),w(J,null,Z(s(A),(O,G)=>(p(),U(ne,{key:G,modelValue:s(b),"onUpdate:modelValue":n[1]||(n[1]=z=>L(b)?b.value=z:null),color:"error",class:"ma-1"},{default:a(()=>[R(c(O),1)]),_:2},1032,["modelValue"]))),128)),e(de,{ref_key:"refForm",ref:S,class:"mt-3"},{default:a(()=>[t("div",null,[e(h,{class:"d-flex align-center justify-center"},{default:a(()=>[e(v,{cols:"12"},{default:a(()=>[e(i,{modelValue:s(f),"onUpdate:modelValue":n[2]||(n[2]=O=>L(f)?f.value=O:null),rows:"5","row-height":"20",label:"Scanner",rules:["requiredValidator"in d?d.requiredValidator:s(W)],placeholder:"Select pour scanner"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),e(h,null,{default:a(()=>[s(y).length>0?(p(),U(v,{key:0,cols:"12",md:"3"},{default:a(()=>[n[3]||(n[3]=t("p",{class:"text-error"}," Colis erroné ",-1)),e(K,{items:s(y),class:"border border-error border-opacity-75"},null,8,["items"])]),_:1})):q("",!0),s(r).length>0?(p(),U(v,{key:1,cols:"12",md:"3"},{default:a(()=>[n[4]||(n[4]=t("p",{class:"text-error"}," Colis dupliqués ",-1)),e(K,{items:s(r),class:"border border-error border-opacity-75"},null,8,["items"])]),_:1})):q("",!0),e(v,{cols:"12",md:"3"},{default:a(()=>[n[5]||(n[5]=R(" Colis manquant ")),e(K,{items:s(g)},null,8,["items"])]),_:1}),e(v,{cols:"12",md:"3"},{default:a(()=>[n[6]||(n[6]=R(" Colis externe ")),e(K,{items:s(u)},null,8,["items"])]),_:1})]),_:1}),e(h,null,{default:a(()=>[e(v,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(D,{color:"secondary",onClick:H},{default:a(()=>n[7]||(n[7]=[R(" retour ")])),_:1}),e(D,{loading:s(N),onClick:B},{default:a(()=>n[8]||(n[8]=[R(" Envoyer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)],64)}}},$e={key:0,class:"text-center"},Oe={key:0},Ie={key:1},Ue={class:"text-center"},qe={key:0},De={key:1},Pe={__name:"actionsRamassage",props:{currentStatut:{type:String,required:!0},item:{type:Object,required:!0},id:{type:Number,required:!0}},emits:["getItemData"],setup(P,{emit:M}){const m=P,T=M,x=_({}),f=_(""),S=_(!1),N=_(),o=_({id:null,statut:"",nombre_colis_ramasseur:"",commentaire:"",date:"",file:""}),A=()=>{S.value=!1,b.value=!1};X(()=>m.currentStatut,r=>{f.value=r},{immediate:!0}),X(()=>m.item,r=>{x.value=r},{immediate:!0});const y=_(""),b=_(!1),C=r=>{S.value=!0,o.value.statut=r,r=="ENTREPOT"&&(b.value=!0)},B=async()=>{const{valid:r}=await N.value.validate();r&&await H(o.value.statut)},H=async r=>{o.value.statut=r,o.value.id=m.id,y.value=r,Y({method:"POST",url:"/api/updateStatutRamassage",data:o.value}).then(async u=>{u.status===200&&(k.success(u.data),r!="COMMENTAIRE"&&(f.value=r),S.value=!1,T("getItemData")),y.value=""}).catch(u=>{y.value="",u.response&&u.response.status===422?k.error(u.response.data.message):k.error("something wrong")})},j=ee("livreur","action"),V=ee("gestionnaire","action"),$=F(()=>{let r=[];return r.push({text:"Commentaire",color:"secondary",statut:"COMMENTAIRE"}),f.value=="REPORTE"&&(j||V)&&r.push({...I("EN_COURS_RAMASSAGE"),statut:"EN_COURS_RAMASSAGE"}),f.value=="EN_ATTENTE"?j&&r.push({...I("EN_COURS_RAMASSAGE"),statut:"EN_COURS_RAMASSAGE"}):f.value=="EN_COURS_RAMASSAGE"||f.value=="REPORTE"?(j&&(r.push({statut:"RAMASSE",...I("RAMASSE")}),r.push({statut:"REPORTE",...I("REPORTE")})),V&&r.push({statut:"ANNULE",...I("ANNULE")})):f.value=="RAMASSE"&&V&&(r.push({...I("ENTREPOT"),statut:"ENTREPOT"}),x.value.colis.length==0&&r.push({statut:"ANNULE",...I("ANNULE")})),r});return(r,u)=>{const g=Ne,l=me,d=xe,n=ce;return s(S)?(p(),w("div",Ie,[s(o).statut=="ENTREPOT"&&s(b)?(p(),U(g,{key:0,"is-show-entrepot":s(b),"onUpdate:isShowEntrepot":u[0]||(u[0]=i=>L(b)?b.value=i:null),"hide-entrepot":"",item:s(x),onHideEntrepot:A,onGetItemData:u[1]||(u[1]=i=>T("getItemData"))},null,8,["is-show-entrepot","item"])):(p(),U(de,{key:1,ref_key:"refForm",ref:N,class:"mt-3"},{default:a(()=>[t("p",Ue," Statut à envoyer : "+c(("statutInfos"in r?r.statutInfos:s(I))(s(o).statut).text),1),s(o).statut=="RAMASSE"?(p(),w("div",qe,[e(h,{class:"d-flex align-center justify-center"},{default:a(()=>[e(v,{md:"6",cols:"12"},{default:a(()=>[e(l,{modelValue:s(o).nombre_colis_ramasseur,"onUpdate:modelValue":u[2]||(u[2]=i=>s(o).nombre_colis_ramasseur=i),rules:["requiredValidator"in r?r.requiredValidator:s(W)],placeholder:"Nombre de colis",label:"Nombre de colis",type:"number"},null,8,["modelValue","rules"])]),_:1})]),_:1})])):q("",!0),s(o).statut=="REPORTE"?(p(),w("div",De,[e(h,{class:"d-flex align-center justify-center"},{default:a(()=>[e(v,{md:"6",cols:"12"},{default:a(()=>[e(d,{modelValue:s(o).date,"onUpdate:modelValue":u[3]||(u[3]=i=>s(o).date=i),rules:["requiredValidator"in r?r.requiredValidator:s(W)],label:"Date & TIme",placeholder:"Select date and time",config:{enableTime:!0,dateFormat:"Y-m-d H:i"}},null,8,["modelValue","rules"])]),_:1})]),_:1})])):q("",!0),t("div",null,[e(h,{class:"d-flex align-center justify-center"},{default:a(()=>[e(v,{md:"6",cols:"12"},{default:a(()=>[e(n,{modelValue:s(o).commentaire,"onUpdate:modelValue":u[4]||(u[4]=i=>s(o).commentaire=i),rows:"2","row-height":"20",label:"Commentaire",rules:["COMMENTAIRE","REPORTE","ANNULE"].includes(s(o).statut)?["requiredValidator"in r?r.requiredValidator:s(W)]:[],placeholder:"Commentaire"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),e(h,null,{default:a(()=>[e(v,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(D,{color:"secondary",onClick:u[5]||(u[5]=i=>S.value=!1)},{default:a(()=>u[6]||(u[6]=[R(" retour ")])),_:1}),e(D,{loading:s(y)==s(o).statut,onClick:B},{default:a(()=>u[7]||(u[7]=[R(" Envoyer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512))])):(p(),w("div",$e,[(p(!0),w(J,null,Z(s($),(i,O)=>(p(),U(D,{key:O,color:i.color,class:"ma-1",loading:s(y)==i.statut,onClick:G=>C(i.statut)},{default:a(()=>[R(c(i.text),1)]),_:2},1032,["color","loading","onClick"]))),128)),s($).length==0?(p(),w("div",Oe," Aucune action requise ")):q("",!0)]))}}},Me={key:0,class:"text-end position-absolute right-0"},je={class:"text-body-1 mb-2"},Fe={class:"text-body-1 mb-2"},Be={class:"text-body-1 mb-2"},Ge={key:0},Le={class:"text-body-1 mb-2"},He={class:"text-body-1 mb-2"},ze={class:"text-body-1 mb-2"},Qe={class:"text-body-1 mb-2"},We={class:"text-body-1 mb-2"},Ye={class:"text-body-1 mb-2"},Je={__name:"ShowRamassage",props:{id:{type:Object,required:!1},isShowItem:{type:Boolean,required:!0}},emits:["update:isShowItem","fetchItems"],async setup(P,{emit:M}){let m,T;const x=P,f=M;let S={id:"",nom_vendeur:"",tel_vendeur:"",frais_ramasseur:"",tel_ramasseur:"",tarif_id:"",adresse:"",ramasseur:"",ramasseur_id:"",statut:"",vendeur:"",nombre_colis:"",colis:[],histories:[]};const N=([m,T]=ve(()=>Y("/api/ramasseurs").then(g=>g.data)),m=await m,T(),m),o=_(structuredClone(te(S))),A=_(!1),y=async g=>{A.value=!0,await Y("/api/ramassage/"+g).then(async l=>{l.status===200&&(o.value=l.data),A.value=!1}).catch(l=>{A.value=!1,l.response&&l.response.status===422?k.error(l.response.data.message):k.error("something wrong")})};X(()=>x.id,g=>{y(g)},{immediate:!0});const b=()=>{f("update:isShowItem",!1),f("fetchItems"),o.value=structuredClone(te(S))},C=_(!1),B=ee("gestionnaire","action"),H=ee("livreur","action"),j=g=>{C.value=!0,Y({method:"POST",url:"/api/parametrerRamassage",data:{id:o.value.id,ramasseur_id:o.value.ramasseur_id,frais_ramasseur:o.value.frais_ramasseur}}).then(async l=>{C.value=!1,l.status===200&&k.success(l.data),y(o.value.id),r.value=!1}).catch(l=>{C.value=!1,l.response&&l.response.status===422?k.error(l.response.data.message):k.error("something wrong")})},V=_("Actions"),$=["tabler-adjustments-share","tabler-logs"],r=_(!1),u=[{title:"code",key:"code"},{title:"destination",key:"destination"}];return(g,l)=>{const d=Se,n=Pe,i=he,O=Ee,G=me,z=be;return p(),U(Re,{width:g.$vuetify.display.smAndDown?"auto":900,"model-value":x.isShowItem,scrollable:"","onUpdate:modelValue":b},{default:a(()=>[e(d,{onClick:b}),e(z,{title:"Details Ramassage",loading:s(A),"no-actions":""},{default:a(()=>[e(fe,null,{default:a(()=>[se(e(ie,null,{default:a(()=>[s(B)?(p(),w("div",Me,[e(D,{icon:"",class:"rounded-0",onClick:l[0]||(l[0]=E=>r.value=!0)},{default:a(()=>[e(ae,{size:"22",icon:"tabler-settings"})]),_:1})])):q("",!0),e(h,null,{default:a(()=>[e(v,{cols:"12",lg:"6"},{default:a(()=>[e(ue,{class:"billing-address-table"},{default:a(()=>[t("tr",null,[l[7]||(l[7]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Code : ")],-1)),t("td",null,[t("p",je,c(s(o).code),1)])]),t("tr",null,[l[8]||(l[8]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Ramasseur : ")],-1)),t("td",null,[t("p",Fe,c(s(o).ramasseur),1)])]),t("tr",null,[l[9]||(l[9]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Tel Ramasseur: ")],-1)),t("td",null,[t("p",Be,c(s(o).tel_ramasseur),1)])]),s(H)?(p(),w("tr",Ge,[l[10]||(l[10]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Frais de ramassage: ")],-1)),t("td",null,[t("p",Le,c(s(o).frais_ramasseur),1)])])):q("",!0),t("tr",null,[l[11]||(l[11]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Destination : ")],-1)),t("td",null,[t("p",He,c(s(o).destination),1)])]),t("tr",null,[l[12]||(l[12]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Statut: ")],-1)),t("td",null,[t("p",ze,[e(Ce,ge(("statutInfos"in g?g.statutInfos:s(I))(s(o).statut),{density:"default",label:"",size:"small"}),null,16)])])])]),_:1})]),_:1}),e(v,{cols:"12",lg:"6"},{default:a(()=>[e(ue,{class:"billing-address-table"},{default:a(()=>[t("tr",null,[l[13]||(l[13]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Vendeur: ")],-1)),t("td",null,[t("p",Qe,c(s(o).vendeur),1)])]),t("tr",null,[l[14]||(l[14]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Tel Vendeur: ")],-1)),t("td",null,[t("p",We,c(s(o).tel_vendeur),1)])]),t("tr",null,[l[15]||(l[15]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Colis: ")],-1)),t("td",null,[t("p",Ye,c(s(o).nombre_colis),1)])])]),_:1})]),_:1})]),_:1}),e(Ve,{modelValue:s(V),"onUpdate:modelValue":l[1]||(l[1]=E=>L(V)?V.value=E:null),grow:"",class:"disable-tab-transition",stacked:""},{default:a(()=>[(p(),w(J,null,Z($,(E,_e)=>e(ye,{key:_e},{default:a(()=>[e(ae,{size:"40",icon:E},null,8,["icon"])]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(we,{modelValue:s(V),"onUpdate:modelValue":l[3]||(l[3]=E=>L(V)?V.value=E:null),class:"mt-3"},{default:a(()=>[e(re,null,{default:a(()=>[e(n,{id:s(o).id,"current-statut":s(o).statut,item:s(o),onGetItemData:l[2]||(l[2]=E=>y(s(o).id))},null,8,["id","current-statut","item"])]),_:1}),e(re,null,{default:a(()=>[e(i,{histories:s(o).histories},null,8,["histories"])]),_:1})]),_:1},8,["modelValue"]),e(Q,{color:"white",thickness:"1",opacity:"0.2",class:"my-6"}),e(Ae,{headers:u,items:s(o).colis,"items-per-page":5},null,8,["items"])]),_:1},512),[[le,!s(r)]]),s(B)?se((p(),U(ie,{key:0},{default:a(()=>[e(h,null,{default:a(()=>[e(v,{md:"6",cols:"12"},{default:a(()=>[e(O,{modelValue:s(o).ramasseur_id,"onUpdate:modelValue":l[4]||(l[4]=E=>s(o).ramasseur_id=E),placeholder:"Ramasseurs",label:"Ramasseurs",items:s(N),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(v,{cols:"12",md:"6"},{default:a(()=>[e(G,{modelValue:s(o).frais_ramasseur,"onUpdate:modelValue":l[5]||(l[5]=E=>s(o).frais_ramasseur=E),rules:["requiredValidator"in g?g.requiredValidator:s(W)],label:"Frais de ramassage",type:"number",placeholder:"Frais de ramassage"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(h,null,{default:a(()=>[e(v,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(D,{color:"secondary",onClick:l[6]||(l[6]=E=>r.value=!1)},{default:a(()=>l[16]||(l[16]=[R(" retour ")])),_:1}),e(D,{loading:s(C),onClick:j},{default:a(()=>l[17]||(l[17]=[R(" Envoyer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)),[[le,s(r)]]):q("",!0)]),_:1})]),_:1},8,["loading"])]),_:1},8,["width","model-value"])}}},qt=pe(Je,[["__scopeId","data-v-532e0699"]]),Ke={key:0},Xe={id:"print-area"},Ze={class:"print-content"},et={class:"props.item-header-preview d-flex flex-wrap justify-space-between flex-column flex-sm-row print-row bg-var-theme-background gap-6 rounded"},tt={class:"d-flex align-center app-logo"},st={class:"app-logo-title"},at={class:"d-flex align-center destination"},lt={class:"d-flex flex-wrap justify-space-between flex-column flex-sm-row gap-6"},ot={class:"mb-0"},rt={class:"mb-0"},nt={class:"mb-0"},it={class:"mb-0"},ut={class:"mb-0"},dt={class:"mb-0"},mt={class:"mb-0"},ct={class:"mb-0"},pt={__name:"printRamassage",props:{item:{type:Object,required:!0},isPrintColis:{type:Boolean,required:!0}},emits:["update:isPrintColis"],setup(P,{emit:M}){const m=P,T=M;return setTimeout(()=>{window.print()},500),window.onafterprint=function(){T("update:isPrintColis",!1)},(x,f)=>m.isPrintColis?(p(),w("div",Ke,[t("div",Xe,[t("div",Ze,[e(fe,{class:"props.item-preview-wrapper"},{default:a(()=>[f[0]||(f[0]=t("div",null,null,-1)),t("div",et,[t("div",null,[t("div",tt,[e(s(Te),{nodes:s(oe).app.logo},null,8,["nodes"]),t("h6",st,c(s(oe).app.title),1)])]),t("div",at,c(m.item.destination),1)]),e(Q,{class:"border-solid"}),e(h,{class:"print-row little-margin"},{default:a(()=>[e(v,{class:"text"},{default:a(()=>[t("div",lt,[t("div",null,[t("p",ot," Code : "+c(m.item.code),1),t("p",rt," Nom : "+c(m.item.nom_client),1),t("p",nt," tel : "+c(m.item.tel_client),1)]),t("div",null,[t("p",it,[e(ke,{size:"70",value:m.item.code},null,8,["value"])])])]),t("p",ut," Adresse : "+c(m.item.adresse),1)]),_:1})]),_:1}),e(Q,{class:"border-solid"}),e(h,{class:"align-right little-margin"},{default:a(()=>[e(v,{cols:"12"},{default:a(()=>[t("p",dt," Produits : "+c(m.item.produit),1),t("p",mt," Montant : "+c(m.item.montant),1)]),_:1})]),_:1}),e(Q,{class:"border-solid"}),e(h,{class:"align-right little-margin"},{default:a(()=>[e(v,{cols:"12"},{default:a(()=>[t("p",ct," essayage : "+c(m.item.essayage?"OUI":"NON")+" | ouvrir : "+c(m.item.ouvrir?"OUI":"NON")+" | echange : "+c(m.item.echange?"OUI":"NON"),1)]),_:1})]),_:1}),e(Q,{class:"border-solid"}),f[1]||(f[1]=t("p",{class:"mb-0"},[t("span",null," Remarque: "),t("span",null,"Entrepirse de livraison n'est pas responsable sur vos achat")],-1))]),_:1})])])])):q("",!0)}},Dt=pe(pt,[["__scopeId","data-v-f626c156"]]);export{Dt as P,qt as _};
