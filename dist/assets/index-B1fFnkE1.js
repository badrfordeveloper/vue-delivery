import{_ as ee}from"./AddEditRoleDialog-CaNBjWg_.js";import{V as te,_ as le,c as oe}from"./VDataTableServer-D25ggilW.js";import{_ as ae}from"./AppSelect-Be6KQpw4.js";import{_ as se}from"./AppTextField-KYzKeVMD.js";import{A as R,r as s,w as ie,aq as T,j as re,Y as I,a as ne,c as U,o as d,d as w,b as o,e as a,ak as i,n as l,f as q,m as E,ai as j,v as L,$ as me,s as ue,F as z,h as pe,x as O}from"./index-DC-Wnp_v.js";import{$ as de}from"./VForm-BLjPjbmE.js";import{u as ce}from"./index-BkqFNaQh.js";import{V as fe}from"./VCardText-rLzALaeu.js";import{V as ve,a as C}from"./VRow-C-Blmbrh.js";import{V as Y}from"./VDivider-Caf8hJry.js";import{V as Ve}from"./VSpacer-BKOtsdPM.js";import{V as ge}from"./VChip-BlN3E-V7.js";import{V as be}from"./VCard-ba4N2OJb.js";import"./DialogCloseBtn-TZVX7tmj.js";import"./toast-rl0bCb86.js";import"./VDataTable-BZm3qX_v.js";import"./VSelect-DcS93PjE.js";import"./VTextField-CFUFOG3c.js";import"./VInput-O8_TmnmY.js";import"./VImg-CsBZAcfn.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-BfJ7xNXe.js";import"./VAvatar-Cyrz8IHk.js";import"./VOverlay-B10g4fEc.js";import"./VMenu-PvYiXdlR.js";import"./filter-EgIwNTEF.js";import"./VDialog-DW_OFpV4.js";/* empty css              */const xe={class:"d-flex flex-wrap gap-4 ma-6"},_e={class:"d-flex gap-4 flex-wrap align-center"},Xe={__name:"index",props:{role:{type:String,required:!0}},async setup(h){let n,c;const G=h,H=[{title:"Nom",key:"lastName",sortable:!1},{title:"Prenom",key:"firstName",sortable:!1},{title:"role",key:"role",sortable:!1,align:R("show","role")?" start":" d-none"},{title:"statut",key:"active",sortable:!1},{title:"actions",key:"actions",sortable:!1}],p=s(),f=s(),v=s(),g=s([]),b=s(!1),x=s(!1);s(!1);const _=s({name:"",permissions:[]});ie(()=>G.role,r=>{p.value=r},{immediate:!0});const J=s([{title:"Active",value:"1"},{title:"Inactive",value:"0"}]),N=([n,c]=T(()=>de("/api/rolesList").then(r=>r.data)),n=await n,c(),n);console.log(N);const m=s(5),u=s(1),B=s(),P=s(),K=r=>{var t,V;B.value=(t=r.sortBy[0])==null?void 0:t.key,P.value=(V=r.sortBy[0])==null?void 0:V.order},{data:A,error:ye,statusCode:ke,isFetching:Q,execute:D}=([n,c]=T(()=>ce(oe("/api/users",{query:{active:f,role:p,fullName:v,page:u,itemsPerPage:m,sortBy:B,orderBy:P}}))),n=await n,c(),n),F=re(),W=I(()=>A.value.items),$=I(()=>A.value.total),X=r=>{if(r===1)return{text:"active",color:"success"};if(r===0)return{text:"inactive",color:"warning"}};return(r,t)=>{const V=se,y=ae,Z=ne("IconBtn"),M=le,S=ee;return d(),U(z,null,[w("div",null,[o(be,{title:"Filtres",class:"mb-6"},{default:a(()=>[o(fe,null,{default:a(()=>[o(ve,null,{default:a(()=>[o(C,{cols:"12",sm:"2"},{default:a(()=>[o(V,{modelValue:l(v),"onUpdate:modelValue":t[0]||(t[0]=e=>i(v)?v.value=e:null),placeholder:"Nom ou prenom"},null,8,["modelValue"])]),_:1}),o(C,{cols:"12",sm:"2"},{default:a(()=>[o(y,{modelValue:l(p),"onUpdate:modelValue":t[1]||(t[1]=e=>i(p)?p.value=e:null),placeholder:"Roles",items:l(N),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),o(C,{cols:"12",sm:"2"},{default:a(()=>[o(y,{modelValue:l(f),"onUpdate:modelValue":t[2]||(t[2]=e=>i(f)?f.value=e:null),placeholder:"Status",items:l(J),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),o(Y),w("div",xe,[o(Ve),w("div",_e,[o(y,{modelValue:l(m),"onUpdate:modelValue":t[3]||(t[3]=e=>i(m)?m.value=e:null),items:[5,10,20,25,50]},null,8,["modelValue"]),l(R)("create","user")?(d(),q(j,{key:0,color:"primary","prepend-icon":"tabler-plus",onClick:t[4]||(t[4]=e=>l(F).push({name:"user-add"}))},{default:a(()=>t[12]||(t[12]=[L(" Ajouter Utilisateur ")])),_:1})):E("",!0)])]),o(Y,{class:"mt-4"}),o(te,{"items-per-page":l(m),"onUpdate:itemsPerPage":t[6]||(t[6]=e=>i(m)?m.value=e:null),"model-value":l(g),"onUpdate:modelValue":t[7]||(t[7]=e=>i(g)?g.value=e:null),page:l(u),"onUpdate:page":t[8]||(t[8]=e=>i(u)?u.value=e:null),loading:l(Q),headers:H,items:l(W),"items-length":l($),class:"text-no-wrap","onUpdate:options":K},{"item.lastName":a(({item:e})=>[o(j,{variant:"text"},{default:a(()=>[L(O(e.lastName),1)]),_:2},1024)]),"item.role":a(({item:e})=>[(d(!0),U(z,null,pe(e.roles,k=>(d(),U("span",{key:k.id},O(k.name+" "),1))),128))]),"item.active":a(({item:e})=>[o(ge,ue(X(e.active),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":a(({item:e})=>[l(R)("update","user")?(d(),q(Z,{key:0,onClick:k=>l(F).push("/user/"+e.id)},{default:a(()=>[o(me,{icon:"tabler-edit"})]),_:2},1032,["onClick"])):E("",!0)]),bottom:a(()=>[o(M,{page:l(u),"onUpdate:page":t[5]||(t[5]=e=>i(u)?u.value=e:null),"items-per-page":l(m),"total-items":l($)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","loading","items","items-length"])]),_:1})]),o(S,{"is-dialog-visible":l(b),"onUpdate:isDialogVisible":t[9]||(t[9]=e=>i(b)?b.value=e:null),onFetchRoles:l(D)},null,8,["is-dialog-visible","onFetchRoles"]),o(S,{"is-dialog-visible":l(x),"onUpdate:isDialogVisible":t[10]||(t[10]=e=>i(x)?x.value=e:null),"role-permissions":l(_),"onUpdate:rolePermissions":t[11]||(t[11]=e=>i(_)?_.value=e:null),onFetchRoles:l(D)},null,8,["is-dialog-visible","role-permissions","onFetchRoles"])],64)}}};export{Xe as default};
