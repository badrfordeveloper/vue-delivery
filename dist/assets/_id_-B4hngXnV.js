import{s as g}from"./statutInfos-CQo4TYHA.js";import{V as K,a as R,b as Q,d as I,e as at,p as lt,f as ot,_ as nt}from"./VTabs-FSF85mBO.js";import{r as z,V as rt,$ as P}from"./VForm-DE5Dv9Vg.js";import{_ as ut}from"./AppTextarea-kINhzqyt.js";import{_ as it}from"./AppTextField-DcnJNrqY.js";import{r as c,w as X,A as L,Y as dt,f as Y,c as w,n as l,o as y,e as a,m as G,F as tt,h as et,b as e,ai as q,v as f,x as m,d as t,i as mt,aq as ft,as as pt,s as A,ak as M,$ as _t}from"./index-Cpx2oQOu.js";import{t as T}from"./toast-DRzPnEr1.js";import{a as p,V as v}from"./VRow-D3F4KUiE.js";import{V as bt}from"./VFileInput-BBsfFeEf.js";import{V as $}from"./VCard-ReRXJKrU.js";import{V as k}from"./VCardText-C2zmEXKG.js";import{V as N}from"./VChip-DLIMD1Bc.js";import{V as Z,a as B}from"./VDataTable-CwT4qoSb.js";import"./VOverlay-B2_IMlFx.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-BaA_dvcq.js";import"./DialogCloseBtn-CyhOHkF9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VDialog-DZYKZxfn.js";import"./VList-FbrG2muM.js";import"./VAvatar-CsMBVwvd.js";import"./VDivider-PtAXYG4Q.js";import"./VInput-DGQc-sBd.js";import"./VTextField-yTp9D8wO.js";/* empty css              */import"./VSelect-RP3MareX.js";import"./VMenu-SP-Qfij5.js";import"./filter-CoHf6CYO.js";const ct={key:0},yt={key:1},vt={class:"text-center"},Vt={key:0},xt={__name:"ActionsVendeurFacture",props:{currentStatut:{type:String,required:!0},item:{type:Object,required:!0},id:{type:Number,required:!0}},emits:["getItemData"],setup(H,{emit:W}){const V=H,E=W,U=c({}),C=c(""),n=c(!1),h=c(),u=c({id:null,statut:"",commentaire:"",montant:"",file:""});X(()=>V.currentStatut,r=>{C.value=r},{immediate:!0}),X(()=>V.item,r=>{U.value=r},{immediate:!0});const b=c(""),x=r=>{n.value=!0,u.value.statut=r},D=async()=>{const{valid:r}=await h.value.validate();r&&await O(u.value.statut)},O=async r=>{u.value.statut=r,u.value.id=V.id,b.value=r;const i=new FormData;i.append("file",u.value.file),i.append("id",u.value.id),i.append("statut",u.value.statut),i.append("commentaire",u.value.commentaire),i.append("montant",u.value.montant),P({method:"POST",url:"/api/updateStatutFactureVendeur",data:i,headers:{"Content-Type":"multipart/form-data"}}).then(async o=>{o.status===200&&(T.success(o.data),r!="COMMENTAIRE"&&(C.value=r),n.value=!1,E("getItemData")),b.value=""}).catch(o=>{b.value="",o.response&&o.response.status===422?T.error(o.response.data.message):T.error("something wrong")})};L("livreur","action");const F=L("gestionnaire","action"),S=dt(()=>{let r=[];return r.push({text:"Commentaire",color:"secondary",statut:"COMMENTAIRE"}),["EN_ATTENTE"].includes(C.value)&&F&&r.push({...g("EN_COURS"),statut:"EN_COURS"}),["EN_COURS"].includes(C.value)&&F&&r.push({...g("PAYE"),statut:"PAYE"}),r});return(r,i)=>{const o=it,s=ut;return l(n)?(y(),w("div",yt,[e(rt,{ref_key:"refForm",ref:h,class:"mt-3"},{default:a(()=>[t("p",vt," Statut à envoyer : "+m(("statutInfos"in r?r.statutInfos:l(g))(l(u).statut).text),1),["FACTURE"].includes(l(u).statut)?(y(),w("div",Vt,[e(v,{class:"d-flex align-center justify-center"},{default:a(()=>[e(p,{md:"6",cols:"12"},{default:a(()=>[e(bt,{modelValue:l(u).file,"onUpdate:modelValue":i[0]||(i[0]=_=>l(u).file=_),rules:["requiredValidator"in r?r.requiredValidator:l(z)],accept:"image/*",label:"Recu"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(v,{class:"d-flex align-center justify-center"},{default:a(()=>[e(p,{md:"6",cols:"12"},{default:a(()=>[e(o,{modelValue:l(u).montant,"onUpdate:modelValue":i[1]||(i[1]=_=>l(u).montant=_),rules:["requiredValidator"in r?r.requiredValidator:l(z)],placeholder:"Montant",label:"Montant",type:"number"},null,8,["modelValue","rules"])]),_:1})]),_:1})])):G("",!0),t("div",null,[e(v,{class:"d-flex align-center justify-center"},{default:a(()=>[e(p,{md:"6",cols:"12"},{default:a(()=>[e(s,{modelValue:l(u).commentaire,"onUpdate:modelValue":i[2]||(i[2]=_=>l(u).commentaire=_),rows:"2","row-height":"20",label:"Commentaire",rules:["COMMENTAIRE"].includes(l(u).statut)?["requiredValidator"in r?r.requiredValidator:l(z)]:[],placeholder:"Commentaire"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),e(v,null,{default:a(()=>[e(p,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(q,{color:"secondary",onClick:i[3]||(i[3]=_=>n.value=!1)},{default:a(()=>i[4]||(i[4]=[f(" retour ")])),_:1}),e(q,{loading:l(b)==l(u).statut,onClick:D},{default:a(()=>i[5]||(i[5]=[f(" Envoyer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)])):(y(),Y(v,{key:0,class:"text-center v-row m-0"},{default:a(()=>[(y(!0),w(tt,null,et(l(S),(_,j)=>(y(),Y(p,{key:j,cols:"6"},{default:a(()=>[e(q,{color:_.color,loading:l(b)==_.statut,style:{width:"inherit"},onClick:J=>x(_.statut)},{default:a(()=>[f(m(_.text),1)]),_:2},1032,["color","loading","onClick"])]),_:2},1024))),128)),l(S).length==0?(y(),w("div",ct," Aucune action requise ")):G("",!0)]),_:1}))}}},gt={class:"text-h6 text-no-wrap mb-2"},wt={class:"text-body-1 mb-2"},ht={class:"text-h6 text-no-wrap mb-2"},Ct={class:"text-body-1 mb-2"},kt={class:"text-h6 text-no-wrap mb-2"},It={class:"text-body-1 mb-2"},At={class:"text-h6 text-no-wrap mb-2"},Nt={class:"text-body-1 mb-2"},Tt={class:"text-h6 text-no-wrap mb-2"},Et={class:"text-body-1 mb-2"},Ft={class:"text-body-1 mb-2"},St={class:"text-body-1 mb-2"},Rt={class:"text-body-1 mb-2"},Mt={class:"text-body-1 mb-2"},$t={class:"text-body-1 mb-2"},qt={class:"text-body-1 mb-2"},Ut={class:"text-body-1 mb-2"},Dt={class:"text-body-1 mb-2"},Ot={class:"text-body-1 mb-2"},jt={class:"text-body-1 mb-2"},zt={class:"text-body-1 mb-2"},Bt={class:"text-body-1 mb-2"},Pt={class:"text-body-1 mb-2"},Lt={key:0},Yt={key:0},Gt={key:1},ge={__name:"[id]",props:{id:{type:Object,required:!1}},emits:["update:isShowItem","fetchItems"],async setup(H,{emit:W}){let V,E;const U=mt();let C={id:"",nom_vendeur:"",tel_vendeur:"",tarif_id:"",commentaire_vendeur:"",code_ramassage:"",frais_vendeur:"",adresse:"",vendeur:"",vendeur_id:"",tel_vendeur:"",statut:"",vendeur:"",created_at:"",colisHistories:[]};[V,E]=ft(()=>P("/api/ramasseurs").then(o=>o.data)),V=await V,E();const n=c(structuredClone(pt(C))),h=c(!1),u=async()=>{h.value=!0,await P("/api/factureVendeur/"+U.params.id).then(async o=>{o.status===200&&(n.value=o.data),h.value=!1}).catch(o=>{h.value=!1,o.response&&o.response.status===422?T.error(o.response.data.message):T.error("something wrong")})};u(),L("gestionnaire","action");const b=c("Actions"),x=c("COLIS"),D=["tabler-adjustments-share","tabler-logs"],O=o=>{if(o=="")return o;const s=lt(o);return ot(s,"yyyy-MM-dd")},F=()=>{window.print()};c(!1);const S=[{title:"Code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"frais",key:"frais_livraison",sortable:!1},{title:"Montant",key:"montant",sortable:!1}],r=[{title:"Code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"frais",key:"frais_ramasseur",sortable:!1}],i=[{title:"Code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"frais",key:"frais_ramasseur",sortable:!1}];return(o,s)=>{const _=xt,j=at,J=nt;return y(),Y(J,{loading:l(h),"no-actions":""},{default:a(()=>[e(v,{class:"row-print"},{default:a(()=>[e(p,{cols:"12",lg:"2",class:"d-print-none text-center"},{default:a(()=>[e(q,{color:"info",width:"150px",onClick:F},{default:a(()=>s[5]||(s[5]=[f(" Print ")])),_:1})]),_:1}),e(p,{cols:"12",lg:"12",class:"col-print"},{default:a(()=>[e($,null,{default:a(()=>[e(k,{class:"print-area"},{default:a(()=>[e(v,null,{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[e($,{title:"Informations Facture"},{default:a(()=>[e(k,null,{default:a(()=>[e(v,null,{default:a(()=>[e(p,{cols:"12",lg:"4"},{default:a(()=>[t("h6",gt,[s[6]||(s[6]=f(" Code : ")),t("span",wt,m(l(n).code),1)])]),_:1}),e(p,{cols:"12",lg:"4"},{default:a(()=>[t("h6",ht,[s[7]||(s[7]=f(" Vendeur : ")),t("span",Ct,m(l(n).vendeur),1)])]),_:1}),e(p,{cols:"12",lg:"4"},{default:a(()=>[t("h6",kt,[s[8]||(s[8]=f(" Tel Vendeur : ")),t("span",It,m(l(n).tel_vendeur),1)])]),_:1}),e(p,{cols:"12",lg:"4"},{default:a(()=>[t("h6",At,[s[9]||(s[9]=f(" Statut : ")),t("span",Nt,[e(N,A(("statutInfos"in o?o.statutInfos:l(g))(l(n).statut),{density:"default",label:"",size:"small"}),null,16)])])]),_:1}),e(p,{cols:"12",lg:"4"},{default:a(()=>[t("h6",Tt,[s[10]||(s[10]=f(" Date : ")),t("span",Et,m(O(l(n).created_at)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(v,null,{default:a(()=>[e(p,{cols:"12",lg:"6"},{default:a(()=>[e($,{title:"Nombres"},{default:a(()=>[e(k,null,{default:a(()=>[e(Z,{class:"billing-address-table"},{default:a(()=>[t("tr",null,[s[11]||(s[11]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Nombre Total : ")],-1)),t("td",null,[t("p",Ft,m(l(n).nombre_total),1)])]),t("tr",null,[s[12]||(s[12]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Nombre des colis livrés : ")],-1)),t("td",null,[t("p",St,m(l(n).nombre_livre),1)])]),t("tr",null,[s[13]||(s[13]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Nombre des colis livrés partiellement : ")],-1)),t("td",null,[t("p",Rt,m(l(n).nombre_livre_partiellement),1)])]),t("tr",null,[s[14]||(s[14]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Nombre des colis refusés : ")],-1)),t("td",null,[t("p",Mt,m(l(n).nombre_refuse),1)])]),t("tr",null,[s[15]||(s[15]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Nombre des colis annulés : ")],-1)),t("td",null,[t("p",$t,m(l(n).nombre_annule),1)])]),t("tr",null,[s[16]||(s[16]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Nombre des ramassages : ")],-1)),t("td",null,[t("p",qt,m(l(n).nombre_ramassage),1)])]),t("tr",null,[s[17]||(s[17]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Nombre des retours : ")],-1)),t("td",null,[t("p",Ut,m(l(n).nombre_retour),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e(p,{cols:"12",lg:"6"},{default:a(()=>[e($,{title:"Montants"},{default:a(()=>[e(k,null,{default:a(()=>[e(Z,{class:"billing-address-table"},{default:a(()=>[t("tr",null,[s[18]||(s[18]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Mantant facturé : ")],-1)),t("td",null,[t("p",Dt,m(l(n).montant_facture),1)])]),t("tr",null,[s[19]||(s[19]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Mantant encaissé : ")],-1)),t("td",null,[t("p",Ot,m(l(n).montant_encaisse),1)])]),t("tr",null,[s[20]||(s[20]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Frais Total: ")],-1)),t("td",null,[t("p",jt,m(l(n).frais_total),1)])]),t("tr",null,[s[21]||(s[21]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Frais des colis : ")],-1)),t("td",null,[t("p",zt,m(l(n).frais_colis),1)])]),t("tr",null,[s[22]||(s[22]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Frais de ramassage : ")],-1)),t("td",null,[t("p",Bt,m(l(n).frais_ramassage),1)])]),t("tr",null,[s[23]||(s[23]=t("td",null,[t("h6",{class:"text-h6 text-no-wrap mb-2"}," Frais de retour : ")],-1)),t("td",null,[t("p",Pt,m(l(n).frais_retour),1)])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{class:"d-print-none"},{default:a(()=>[e(K,{modelValue:l(b),"onUpdate:modelValue":s[0]||(s[0]=d=>M(b)?b.value=d:null),grow:"",class:"disable-tab-transition",stacked:""},{default:a(()=>[(y(),w(tt,null,et(D,(d,st)=>e(R,{key:st},{default:a(()=>[e(_t,{size:"40",icon:d},null,8,["icon"])]),_:2},1024)),64))]),_:1},8,["modelValue"]),e(Q,{modelValue:l(b),"onUpdate:modelValue":s[2]||(s[2]=d=>M(b)?b.value=d:null),class:"mt-3"},{default:a(()=>[e(I,null,{default:a(()=>[e(_,{id:l(n).id,"current-statut":l(n).statut,onGetItemData:s[1]||(s[1]=d=>u(l(n).id))},null,8,["id","current-statut"])]),_:1}),e(I,null,{default:a(()=>[e(j,{histories:l(n).histories},null,8,["histories"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(k,{class:"d-print-none"},{default:a(()=>[e(K,{modelValue:l(x),"onUpdate:modelValue":s[3]||(s[3]=d=>M(x)?x.value=d:null),grow:"",class:"disable-tab-transition",stacked:""},{default:a(()=>[e(R,null,{default:a(()=>s[24]||(s[24]=[f(" Colis ")])),_:1}),e(R,null,{default:a(()=>s[25]||(s[25]=[f(" ramassages ")])),_:1}),e(R,null,{default:a(()=>s[26]||(s[26]=[f(" retours ")])),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:l(x),"onUpdate:modelValue":s[4]||(s[4]=d=>M(x)?x.value=d:null),disabled:"",class:"mt-3"},{default:a(()=>[e(I,null,{default:a(()=>[e(B,{headers:S,items:l(n).colis_vendeur,"items-per-page":10},{"item.statut":a(({item:d})=>[e(N,A(("statutInfos"in o?o.statutInfos:l(g))(d.statut),{density:"default",label:"",size:"small"}),null,16),d.statut_retour?(y(),w("span",Lt,[s[27]||(s[27]=f(" - ")),e(N,A(("statutInfos"in o?o.statutInfos:l(g))(d.statut_retour),{density:"default",label:"",size:"small"}),null,16)])):G("",!0)]),"item.frais_livraison":a(({item:d})=>[["REFUSE","ANNULE"].includes(d.statut)?(y(),w("span",Yt," 0 ")):(y(),w("span",Gt,m(d.frais_livraison),1))]),_:1},8,["items"])]),_:1}),e(I,null,{default:a(()=>[e(B,{headers:r,items:l(n).ramassages_vendeur,"items-per-page":10},{"item.statut":a(({item:d})=>[e(N,A(("statutInfos"in o?o.statutInfos:l(g))(d.statut),{density:"default",label:"",size:"small"}),null,16)]),"item.frais_ramasseur":a(()=>s[28]||(s[28]=[f(" 0 ")])),_:1},8,["items"])]),_:1}),e(I,null,{default:a(()=>[e(B,{headers:i,items:l(n).retours_vendeur,"items-per-page":10},{"item.statut":a(({item:d})=>[e(N,A(("statutInfos"in o?o.statutInfos:l(g))(d.statut),{density:"default",label:"",size:"small"}),null,16)]),"item.frais_ramasseur":a(()=>s[29]||(s[29]=[f(" 0 ")])),_:1},8,["items"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])}}};export{ge as default};
