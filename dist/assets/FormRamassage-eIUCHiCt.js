import{r as b,P as G,V as H}from"./VForm-Dg9jF2bh.js";import{c as J,V as K,_ as L}from"./VDataTableServer-BdHPifpA.js";import{_ as Q}from"./AppSelect-QRYdQcLn.js";import{_ as W}from"./AppAutocomplete-BgN-K_uu.js";import{_ as X}from"./AppTextField-C8pU9PIj.js";import{j as Z,r as u,aq as k,ar as A,w as ee,Y as C,c as te,o as ae,d as _,b as e,x as le,e as o,n as a,ak as h,s as se,ai as oe,v as re,F as ie}from"./index-ozxdH-7b.js";import{$ as N}from"./api-Dx5SAhyB.js";import{t as E}from"./toast-UA7yOy59.js";import{u as ne}from"./index-CuMPislM.js";import{V,a as m}from"./VRow-pYCdNr-Y.js";import{V as F}from"./VCard-CNbNQKcS.js";import{V as j}from"./VCardText-DsXbz0Qj.js";import{V as de}from"./VSpacer-BHnw5x-1.js";import{V as ue}from"./VChip-DhroVh_v.js";const me={class:"d-flex flex-wrap justify-start justify-sm-space-between gap-y-4 gap-x-6 mb-6"},pe={class:"d-flex flex-column justify-center"},fe={class:"text-h4 font-weight-medium"},ce={class:"d-flex flex-wrap gap-4 ma-6"},_e={class:"d-flex gap-4 flex-wrap align-center"},Ee={__name:"FormRamassage",props:{method:{type:String,required:!0},item:{type:Object,required:!1},identity:{type:String,required:!1}},async setup(z){let n,g;const p=z,B=Z(),w=u(),T=u([]),v=u(!1);T.value=([n,g]=k(()=>N("/api/zones").then(l=>l.data.items)),n=await n,g(),n);let q={id:"",nom_vendeur:"",tel_vendeur:"",zone_id:"",adresse:"",adresse:"",colis:[]};const r=u(structuredClone(A(q)));ee(()=>p.item,l=>{p.method=="PUT"&&(r.value={...l})},{immediate:!0});const R=async()=>{const{valid:l}=await w.value.validate();if(l){let t="/api/ramassage";p.method=="PUT"&&(t="/api/ramassage/"+p.identity),v.value=!0,N({method:p.method,url:t,data:r.value}).then(async i=>{var c;i.status===200&&(E.success(i.data),p.method=="POST"?((c=w.value)==null||c.reset(),r.value=structuredClone(A(q))):B.push({name:"ramassage-list"})),v.value=!1}).catch(i=>{if(v.value=!1,i.response&&i.response.status===422){const c=i.response.data.errors;for(let y in c)E.error(`${y}: ${c[y].join(", ")}`)}})}},$=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"destination",key:"destination",sortable:!1},{title:"Nom du client",key:"nom_client",sortable:!1},{title:"Tel du client",key:"tel_client",sortable:!1}],D=l=>{var t,i;x.value=(t=l.sortBy[0])==null?void 0:t.key,P.value=(i=l.sortBy[0])==null?void 0:i.order},d=u(5),f=u(1),x=u(),P=u(),{data:S,error:Ve,statusCode:ge,isFetching:I,execute:ve}=([n,g]=k(()=>ne(J("/api/colisForRamassage",{query:{statut:"EN_ATTENTE",ramassage_id:r.value.id,page:f,itemsPerPage:d,sortBy:x,orderBy:P}}))),n=await n,g(),n),O=C(()=>S.value.items),U=C(()=>S.value.total),M=l=>{if(l==="EN_ATTENTE")return{text:"En attente",color:"warning"}};return(l,t)=>{const i=X,c=W,y=Q,Y=L;return ae(),te(ie,null,[_("div",me,[_("div",pe,[_("h4",fe,le(p.method=="POST"?"Ajouter Ramassage":"Modifier Ramassage"),1)])]),e(H,{ref_key:"refForm",ref:w,class:"mt-3"},{default:o(()=>[e(V,null,{default:o(()=>[e(m,{cols:"12",class:"pa-0"},{default:o(()=>[e(F,{title:"Informations du vendeur"},{default:o(()=>[e(j,null,{default:o(()=>[e(V,null,{default:o(()=>[e(m,{md:"6",cols:"12"},{default:o(()=>[e(i,{modelValue:a(r).nom_vendeur,"onUpdate:modelValue":t[0]||(t[0]=s=>a(r).nom_vendeur=s),rules:["requiredValidator"in l?l.requiredValidator:a(b)],placeholder:"Nom",label:"Nom"},null,8,["modelValue","rules"])]),_:1}),e(m,{cols:"12",md:"6"},{default:o(()=>[e(i,{modelValue:a(r).tel_vendeur,"onUpdate:modelValue":t[1]||(t[1]=s=>a(r).tel_vendeur=s),rules:["requiredValidator"in l?l.requiredValidator:a(b),"PhoneValidator"in l?l.PhoneValidator:a(G)],label:"Telephone",size:"10",placeholder:"0655554747"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",class:"px-0"},{default:o(()=>[e(F,{title:"Informations d'adresse"},{default:o(()=>[e(j,null,{default:o(()=>[e(V,null,{default:o(()=>[e(m,{md:"6",cols:"12"},{default:o(()=>[e(c,{modelValue:a(r).zone_id,"onUpdate:modelValue":t[2]||(t[2]=s=>a(r).zone_id=s),rules:["requiredValidator"in l?l.requiredValidator:a(b)],label:"Destination",items:a(T),"item-title":"zone","item-value":"id",placeholder:"Select State"},null,8,["modelValue","rules","items"])]),_:1}),e(m,{md:"6",cols:"12"},{default:o(()=>[e(i,{modelValue:a(r).adresse,"onUpdate:modelValue":t[3]||(t[3]=s=>a(r).adresse=s),"prepend-inner-icon":"tabler-map-pin",rules:["requiredValidator"in l?l.requiredValidator:a(b)],label:"Adresse",placeholder:"Adresse"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(V,null,{default:o(()=>[e(m,null,{default:o(()=>[_("div",ce,[e(de),_("div",_e,[e(y,{modelValue:a(d),"onUpdate:modelValue":t[4]||(t[4]=s=>h(d)?d.value=s:null),items:[5,10,20,25,50]},null,8,["modelValue"])])]),e(K,{"model-value":a(r).colis_ids,"onUpdate:modelValue":t[6]||(t[6]=s=>a(r).colis_ids=s),"items-per-page":a(d),"onUpdate:itemsPerPage":t[7]||(t[7]=s=>h(d)?d.value=s:null),page:a(f),"onUpdate:page":t[8]||(t[8]=s=>h(f)?f.value=s:null),"show-select":"","item-value":s=>s.id,loading:a(I),headers:$,items:a(O),"items-length":a(U),class:"text-no-wrap",locale:"fr","onUpdate:options":D},{"item.statut":o(({item:s})=>[e(ue,se(M(s.statut),{density:"default",label:"",size:"small"}),null,16)]),bottom:o(()=>[e(Y,{page:a(f),"onUpdate:page":t[5]||(t[5]=s=>h(f)?f.value=s:null),"items-per-page":a(d),"total-items":a(U)},null,8,["page","items-per-page","total-items"])]),_:1},8,["model-value","items-per-page","page","item-value","loading","items","items-length"])]),_:1})]),_:1}),e(V,null,{default:o(()=>[e(m,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:o(()=>[e(oe,{loading:a(v),onClick:R},{default:o(()=>t[9]||(t[9]=[re(" Enregistrer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)],64)}}};export{Ee as _};
