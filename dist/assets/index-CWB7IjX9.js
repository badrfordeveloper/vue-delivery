import{s as C}from"./statutInfos-Dl5tZIw7.js";import{V as ue,_ as me,c as de}from"./VDataTableServer-BdHPifpA.js";import{_ as pe,a as I,s as w,e as N,b as ce}from"./AppDateTimePicker-BSYT4dEz.js";import{_ as fe}from"./AppTextField-C8pU9PIj.js";import{_ as ve}from"./AppSelect-QRYdQcLn.js";import{_ as Ve}from"./AppAutocomplete-BgN-K_uu.js";import{d as ge}from"./constants-CRfkYPs-.js";import{r as n,A as x,aq as W,w as ye,j as _e,Y as q,c as G,o as f,b as s,e as o,d as L,f as y,m as h,n as t,ak as u,v as U,x as A,s as j,ai as z}from"./index-ozxdH-7b.js";import{$ as E}from"./api-Dx5SAhyB.js";import{t as be}from"./toast-UA7yOy59.js";import{u as ke}from"./index-CuMPislM.js";import{V as Se}from"./VCardText-DsXbz0Qj.js";import{V as H,a as v}from"./VRow-pYCdNr-Y.js";import{a as Ie}from"./VList-DvQrXdhf.js";import{V as Y}from"./VDivider-CL3jlbdq.js";import{V as he}from"./VSpacer-BHnw5x-1.js";import{V as Te}from"./VChip-DhroVh_v.js";import{V as Oe}from"./VCard-CNbNQKcS.js";import{s as Ce}from"./startOfWeek-BX0W9kO8.js";import"./VDataTable-CWdQKmxs.js";import"./VSelect-CUsrGS1v.js";import"./VTextField-DxrlKLh1.js";import"./VInput-Dxr6NkQk.js";import"./VImg-DVerLASX.js";import"./forwardRefs-DWGaNmQL.js";import"./VOverlay-DrnfapjL.js";import"./VMenu-DghzHJlb.js";import"./VCheckboxBtn-CBFQvFM8.js";import"./VSelectionControl-Bxphu3hx.js";import"./VAvatar-CqlEylcw.js";import"./VTable-mtkxK_Go.js";import"./filter-bht-UASL.js";/* empty css              */import"./VSlideGroup-BJ0_jBgo.js";const we={class:"d-flex flex-wrap gap-4 ma-6"},xe={class:"d-flex gap-4 flex-wrap align-center"},Ue={key:1},ct={__name:"index",props:{statut:{type:String,required:!0}},async setup(J){let m,_;const K=J,T=n(!1),Q=n([{title:"Aujourd'hui",value:"today"},{title:"Hier",value:"yesterday"},{title:"La semaine dernière",value:"lastWeek"},{title:"Ce mois",value:"thisMonth"},{title:"Le mois précédent",value:"lastMonth"},{title:"Personnalisé",value:"custom"}]),X=x("gestionnaire","action"),r=n(),i=n(),V=n("today"),P=()=>{const l=new Date;switch(T.value=V.value==="custom",V.value){case"today":r.value=l.toISOString().split("T")[0],i.value=l.toISOString().split("T")[0];break;case"yesterday":const e=I(l,-1);r.value=e.toISOString().split("T")[0],i.value=e.toISOString().split("T")[0];break;case"lastWeek":r.value=Ce(I(l,-7)).toISOString().split("T")[0],i.value=ce(I(l,-7)).toISOString().split("T")[0];break;case"thisMonth":r.value=w(l).toISOString().split("T")[0],i.value=N(l).toISOString().split("T")[0];break;case"lastMonth":const c=I(w(l),-1);r.value=w(c).toISOString().split("T")[0],i.value=N(c).toISOString().split("T")[0];break}};P();const b=n(),Z=([m,_]=W(()=>E("/api/vendeurs").then(l=>l.data)),m=await m,_(),m),ee=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"Vendeur",key:"vendeur",sortable:!1},{title:"Montant encaisse",key:"montant_encaisse",sortable:!1},{title:"Montant facturée",key:"montant_facture",sortable:!1},{title:"Frais Total",key:"frais_total",sortable:!1}],k=n(),g=n(),d=n(5),p=n(1),B=n(),F=n();ye(()=>K.statut,l=>{g.value=l},{immediate:!0});const S=n(!1),te=async()=>{let l="/api/generateVendeurFactures";S.value=!0,E({method:"POST",url:l}).then(async e=>{e.status===200&&(be.success(e.data),se()),S.value=!1}).catch(e=>{S.value=!1})},ae=l=>{var e,c;B.value=(e=l.sortBy[0])==null?void 0:e.key,F.value=(c=l.sortBy[0])==null?void 0:c.order},{data:M,error:Ae,statusCode:Pe,isFetching:le,execute:se}=([m,_]=W(()=>ke(de("/api/factureVendeur",{query:{vendeur_id:b,begin_date:r,end_date:i,code:k,statut:g,page:p,itemsPerPage:d,sortBy:B,orderBy:F}}))),m=await m,_(),m),oe=_e(),ne=q(()=>M.value.items),D=q(()=>M.value.total);return(l,e)=>{const c=Ve,O=ve,re=fe,$=pe,ie=me;return f(),G("div",null,[s(Oe,{title:"Filtres",class:"mb-6 d-print-none"},{default:o(()=>[s(Se,null,{default:o(()=>[s(H,null,{default:o(()=>[t(X)?(f(),y(v,{key:0,cols:"12",sm:"3"},{default:o(()=>[s(c,{modelValue:t(b),"onUpdate:modelValue":e[0]||(e[0]=a=>u(b)?b.value=a:null),placeholder:"Vendeurs",items:t(Z),clearable:"","clear-icon":"tabler-x",autocomplete:"no-autocompeletse"},null,8,["modelValue","items"])]),_:1})):h("",!0),s(v,{cols:"12",sm:"3"},{default:o(()=>[s(O,{modelValue:t(g),"onUpdate:modelValue":e[1]||(e[1]=a=>u(g)?g.value=a:null),placeholder:"Statut",items:t(ge),clearable:"","clear-icon":"tabler-x"},{item:o(({item:a,props:R})=>[s(Ie,j(R,{title:("statutInfos"in l?l.statutInfos:t(C))(a.value).text}),null,16,["title"])]),selection:o(({item:a})=>[U(A(("statutInfos"in l?l.statutInfos:t(C))(a.value).text),1)]),_:1},8,["modelValue","items"])]),_:1}),s(v,{cols:"12",sm:"2"},{default:o(()=>[s(re,{modelValue:t(k),"onUpdate:modelValue":e[2]||(e[2]=a=>u(k)?k.value=a:null),placeholder:"Code"},null,8,["modelValue"])]),_:1})]),_:1}),s(H,null,{default:o(()=>[s(v,{cols:"12",sm:"3"},{default:o(()=>[s(O,{modelValue:t(V),"onUpdate:modelValue":[e[3]||(e[3]=a=>u(V)?V.value=a:null),P],placeholder:"Plage de dates",items:t(Q),label:t(r)+" - "+t(i)},null,8,["modelValue","items","label"])]),_:1}),t(T)?(f(),y(v,{key:0,cols:"12",sm:"3"},{default:o(()=>[s($,{modelValue:t(r),"onUpdate:modelValue":e[4]||(e[4]=a=>u(r)?r.value=a:null),label:"Début",placeholder:"date"},null,8,["modelValue"])]),_:1})):h("",!0),t(T)?(f(),y(v,{key:1,cols:"12",sm:"3"},{default:o(()=>[s($,{modelValue:t(i),"onUpdate:modelValue":e[5]||(e[5]=a=>u(i)?i.value=a:null),label:"Fin",placeholder:"date"},null,8,["modelValue"])]),_:1})):h("",!0)]),_:1})]),_:1}),s(Y),L("div",we,[s(he),L("div",xe,[s(O,{modelValue:t(d),"onUpdate:modelValue":e[6]||(e[6]=a=>u(d)?d.value=a:null),items:[5,10,20,25,50]},null,8,["modelValue"]),t(x)("create","factureVendeur")?(f(),y(z,{key:0,color:"primary","prepend-icon":"tabler-plus",loading:t(S),onClick:te},{default:o(()=>e[10]||(e[10]=[U(" Génerer les factures ")])),_:1},8,["loading"])):h("",!0)])]),s(Y,{class:"mt-4"}),s(ue,{"items-per-page":t(d),"onUpdate:itemsPerPage":e[8]||(e[8]=a=>u(d)?d.value=a:null),page:t(p),"onUpdate:page":e[9]||(e[9]=a=>u(p)?p.value=a:null),loading:t(le),headers:ee,items:t(ne),"items-length":t(D),class:"text-no-wrap",locale:"fr","onUpdate:options":ae},{"item.code":o(({item:a})=>[t(x)("show","factureVendeur")?(f(),y(z,{key:0,variant:"text",onClick:R=>t(oe).push("/factureVendeur/"+a.id)},{default:o(()=>[U(A(a.code),1)]),_:2},1032,["onClick"])):(f(),G("span",Ue,A(a.code),1))]),"item.statut":o(({item:a})=>[s(Te,j(("statutInfos"in l?l.statutInfos:t(C))(a.statut),{density:"default",label:"",size:"small"}),null,16)]),bottom:o(()=>[s(ie,{page:t(p),"onUpdate:page":e[7]||(e[7]=a=>u(p)?p.value=a:null),"items-per-page":t(d),"total-items":t(D)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items","items-length"])]),_:1})])}}};export{ct as default};
