import{s as le}from"./statutInfos-BWJ2EfQa.js";import{P as re,_ as ne}from"./printRamassage-ORkTMS7D.js";import{_ as ie}from"./DialogCloseBtn-C_9as8KR.js";import{V as me,_ as ue,c as pe}from"./VDataTableServer-CTZnMp_m.js";import{_ as de}from"./AppSelect-DJKVNHPp.js";import{_ as fe}from"./AppTextField-Csxyttsa.js";import{r as l,aq as ce,j as ge,Y as $,a as ve,c as F,o as u,b as s,f as d,m as c,e as o,d as L,ak as n,n as t,A as B,ai as I,v as g,$ as Ve,s as _e,x as E}from"./index-C_YW0fvW.js";import{$ as N}from"./VForm-DBkm5vGA.js";import{t as R}from"./toast-BiWkjqxy.js";import{u as ye}from"./index-cZqtNUdo.js";import{V as A}from"./VCardText-imSDmtky.js";import{V as ke,a as O}from"./VRow-D1sRQIZD.js";import{V as h}from"./VDivider-CPJwSM9S.js";import{V as Ce}from"./VSpacer-BCsa1XW8.js";import{V as be}from"./VMenu-BvqmN1OI.js";import{V as Ie,a as we}from"./VList-Br68t1cx.js";import{V as xe}from"./VChip-Cyd8RnzN.js";import{V as Be}from"./VDialog-CHcYrkUJ.js";import{V as j}from"./VCard-B0VmuzeY.js";import"./VTabs-C48FcC9H.js";import"./VOverlay-Bk2i1yGP.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-BAoymXMI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppTextarea-D-dBKGPh.js";import"./VInput-CzI8Ko5Q.js";import"./AppDateTimePicker-Cmwcgz18.js";import"./VAlert-Dd9kHGpp.js";import"./VAvatar-Mv-fc8Jn.js";import"./VDataTable-n4gX2-Z8.js";import"./VSelect-DuoKEv6C.js";import"./VTextField-orOm2LqD.js";import"./filter-3xhU0rfA.js";import"./VNodeRenderer-BCPdaQUG.js";import"./qrcode.vue.esm-B0-0ln3N.js";/* empty css              */const De={class:"d-flex flex-wrap gap-4 ma-6"},Pe={class:"d-flex gap-4 flex-wrap align-center"},Se={key:1},gt={__name:"list",async setup(Te){let v,D;const M=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"Montant encaisse",key:"montant_encaisse",sortable:!1},{title:"Montant facturée",key:"montant_facture",sortable:!1},{title:"Frais Total",key:"frais_total",sortable:!1}],V=l(),_=l(),y=l(!1),i=l(!1),w=l(),k=l(!1),q=l(),m=l(5),p=l(1),P=l(),S=l(),G=r=>{i.value=!0,w.value=r},z=async()=>{let r="/api/ramassage/"+w.value.id;y.value=!0,N({method:"DELETE",url:r}).then(async e=>{e.status===200&&(i.value=!1,R.success(e.data),x()),y.value=!1}).catch(e=>{y.value=!1})},C=l(!1),K=async()=>{let r="/api/generateLivreurFactures";C.value=!0,N({method:"POST",url:r}).then(async e=>{e.status===200&&(R.success(e.data),x()),C.value=!1}).catch(e=>{C.value=!1})},Y=r=>{var e,f;P.value=(e=r.sortBy[0])==null?void 0:e.key,S.value=(f=r.sortBy[0])==null?void 0:f.order},{data:T,error:Ue,statusCode:$e,isFetching:H,execute:x}=([v,D]=ce(()=>ye(pe("/api/factureLivreur",{query:{code:V,statut:_,page:p,itemsPerPage:m,sortBy:P,orderBy:S}}))),v=await v,D(),v),J=ge(),Q=$(()=>T.value.items),U=$(()=>T.value.total),b=l(!1),W=l(0),X=l(0);return(r,e)=>{const f=fe,Z=de,ee=ve("IconBtn"),te=ue,ae=ie,se=ne;return u(),F("div",null,[s(j,{title:"Filtres",class:"mb-6 d-print-none"},{default:o(()=>[s(A,null,{default:o(()=>[s(ke,null,{default:o(()=>[s(O,{cols:"12",sm:"2"},{default:o(()=>[s(f,{modelValue:t(_),"onUpdate:modelValue":e[0]||(e[0]=a=>n(_)?_.value=a:null),placeholder:"Statut"},null,8,["modelValue"])]),_:1}),s(O,{cols:"12",sm:"2"},{default:o(()=>[s(f,{modelValue:t(V),"onUpdate:modelValue":e[1]||(e[1]=a=>n(V)?V.value=a:null),placeholder:"Code"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(h),L("div",De,[s(Ce),L("div",Pe,[s(Z,{modelValue:t(m),"onUpdate:modelValue":e[2]||(e[2]=a=>n(m)?m.value=a:null),items:[5,10,20,25,50]},null,8,["modelValue"]),t(B)("create","factureLivreur")?(u(),d(I,{key:0,color:"primary","prepend-icon":"tabler-plus",loading:t(C),onClick:K},{default:o(()=>e[11]||(e[11]=[g(" Génerer les factures ")])),_:1},8,["loading"])):c("",!0)])]),s(h,{class:"mt-4"}),s(me,{"items-per-page":t(m),"onUpdate:itemsPerPage":e[4]||(e[4]=a=>n(m)?m.value=a:null),page:t(p),"onUpdate:page":e[5]||(e[5]=a=>n(p)?p.value=a:null),loading:t(H),headers:M,items:t(Q),"items-length":t(U),class:"text-no-wrap",locale:"fr","onUpdate:options":Y},{"item.code":o(({item:a})=>[t(B)("show","factureLivreur")?(u(),d(I,{key:0,variant:"text",onClick:oe=>t(J).push("/factureLivreur/"+a.id)},{default:o(()=>[g(E(a.code),1)]),_:2},1032,["onClick"])):(u(),F("span",Se,E(a.code),1))]),"item.statut":o(({item:a})=>[s(xe,_e(("statutInfos"in r?r.statutInfos:t(le))(a.statut),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":o(({item:a})=>[a.statut=="EN_ATTENTE"?(u(),d(ee,{key:0},{default:o(()=>[s(Ve,{icon:"tabler-dots-vertical"}),s(be,{activator:"parent"},{default:o(()=>[s(Ie,null,{default:o(()=>[t(B)("delete","ramassage")?(u(),d(we,{key:0,value:"delete","prepend-icon":"tabler-trash",onClick:oe=>G(a)},{default:o(()=>e[12]||(e[12]=[g(" Delete ")])),_:2},1032,["onClick"])):c("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)):c("",!0)]),bottom:o(()=>[s(te,{page:t(p),"onUpdate:page":e[3]||(e[3]=a=>n(p)?p.value=a:null),"items-per-page":t(m),"total-items":t(U)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items","items-length"]),s(Be,{modelValue:t(i),"onUpdate:modelValue":e[8]||(e[8]=a=>n(i)?i.value=a:null),persistent:"",class:"v-dialog-sm"},{default:o(()=>[s(ae,{onClick:e[6]||(e[6]=a=>i.value=!t(i))}),s(j,{title:"Êtes-vous sûr de vouloir supprimer le ramassage "+t(w).code+" ?"},{default:o(()=>[s(A,{class:"d-flex justify-end gap-3 flex-wrap"},{default:o(()=>[s(I,{color:"secondary",variant:"tonal",onClick:e[7]||(e[7]=a=>i.value=!1)},{default:o(()=>e[13]||(e[13]=[g(" Non ")])),_:1}),s(I,{loading:t(y),onClick:z},{default:o(()=>e[14]||(e[14]=[g(" Oui ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),t(k)?(u(),d(re,{key:0,"is-print-ramassage":t(k),"onUpdate:isPrintRamassage":e[9]||(e[9]=a=>n(k)?k.value=a:null),item:t(q)},null,8,["is-print-ramassage","item"])):c("",!0),t(b)?(u(),d(se,{id:t(X),key:t(W),"is-show-item":t(b),"onUpdate:isShowItem":e[10]||(e[10]=a=>n(b)?b.value=a:null),onFetchItems:t(x)},null,8,["id","is-show-item","onFetchItems"])):c("",!0)])}}};export{gt as default};
