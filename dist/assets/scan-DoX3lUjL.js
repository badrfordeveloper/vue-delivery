import{r as L,V as O}from"./VForm-Dg9jF2bh.js";import{_ as P}from"./AppTextarea-C0BG7NjM.js";import{$ as Y}from"./api-Dx5SAhyB.js";import{t as A}from"./toast-UA7yOy59.js";import{V as _,a as f}from"./VRow-pYCdNr-Y.js";import{V as N}from"./VList-DvQrXdhf.js";import{r as s,Y as b,c as k,o as n,b as t,F as x,h as R,n as l,e as a,d as E,ak as C,f as p,m as T,ai as z,v as w,x as U}from"./index-ozxdH-7b.js";import{V as $}from"./VAlert-Bn6mkhpT.js";import"./VInput-Dxr6NkQk.js";import"./VImg-DVerLASX.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VAvatar-CqlEylcw.js";import"./VDivider-CL3jlbdq.js";const se={__name:"scan",setup(G){const h=s({colis:[]}),i=s(""),S=s(),m=s(!1),B=s([]),V=s([]),v=s([]),u=s(!1),c=s(!1),j=async()=>{const{valid:r}=await S.value.validate();r&&await D()},D=r=>{m.value=!0,u.value=!1,u.value=!1,Y({method:"POST",url:"/api/scannerRetourEntrepot",data:{scannedColis:F.value}}).then(async e=>{if(e.status===200){let o=e.data;console.log(o),B.value=o.success,V.value=o.errors,v.value=o.colisError,u.value=!0,c.value=V.value.length==0}m.value=!1}).catch(e=>{m.value=!1,e.response&&e.response.status===422?A.error(e.response.data.message):A.error("something wrong")})};b(()=>h.value.colis.map(r=>r.code));const F=b(()=>i.value?i.value.split(`
`).map(r=>r.trim()).filter(r=>r.length>0):[]),q=b(()=>F.value.filter((r,e,o)=>o.indexOf(r)!==e));return(r,e)=>{const o=P;return n(),k(x,null,[(n(!0),k(x,null,R(l(B),(d,g)=>(n(),p($,{key:g,modelValue:l(c),"onUpdate:modelValue":e[0]||(e[0]=y=>C(c)?c.value=y:null),color:"success",class:"ma-1"},{default:a(()=>[w(U(d),1)]),_:2},1032,["modelValue"]))),128)),(n(!0),k(x,null,R(l(V),(d,g)=>(n(),p($,{key:g,modelValue:l(u),"onUpdate:modelValue":e[1]||(e[1]=y=>C(u)?u.value=y:null),color:"error",class:"ma-1"},{default:a(()=>[w(U(d),1)]),_:2},1032,["modelValue"]))),128)),t(O,{ref_key:"refForm",ref:S,class:"mt-3"},{default:a(()=>[E("div",null,[t(_,{class:"d-flex align-center justify-center"},{default:a(()=>[t(f,{cols:"12"},{default:a(()=>[t(o,{modelValue:l(i),"onUpdate:modelValue":e[2]||(e[2]=d=>C(i)?i.value=d:null),rows:"5","row-height":"20",label:"Scanner",rules:["requiredValidator"in r?r.requiredValidator:l(L)],placeholder:"Select pour scanner"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),t(_,null,{default:a(()=>[l(v).length>0?(n(),p(f,{key:0,cols:"12",md:"3"},{default:a(()=>[e[3]||(e[3]=E("p",{class:"text-error"}," Colis erroné ",-1)),t(N,{items:l(v),class:"border border-error border-opacity-75"},null,8,["items"])]),_:1})):T("",!0),l(q).length>0?(n(),p(f,{key:1,cols:"12",md:"3"},{default:a(()=>[e[4]||(e[4]=E("p",{class:"text-error"}," Colis dupliqués ",-1)),t(N,{items:l(q),class:"border border-error border-opacity-75"},null,8,["items"])]),_:1})):T("",!0)]),_:1}),t(_,null,{default:a(()=>[t(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[t(z,{loading:l(m),onClick:j},{default:a(()=>e[5]||(e[5]=[w(" Envoyer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)],64)}}};export{se as default};
