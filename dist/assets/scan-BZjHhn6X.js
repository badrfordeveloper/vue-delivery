import{r as L,V as O,$ as P}from"./VForm-DnlssNIV.js";import{_ as Y}from"./AppTextarea-BYSUsSWJ.js";import{t as A}from"./toast-BvykrbAm.js";import{V as _,a as f}from"./VRow-CUggEZk2.js";import{V as N}from"./VList-DiSHM2Z9.js";import{r as s,Y as b,c as k,o as n,b as t,F as x,h as R,n as a,e as r,d as E,ak as C,f as p,m as T,ai as z,v as w,x as U}from"./index-D7yJXdJy.js";import{V as $}from"./VAlert-BZSlD2K2.js";import"./VInput-9emClv3n.js";import"./VImg-CAZDB8sp.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VAvatar-BA4myzIO.js";import"./VDivider-CS0fj1z-.js";const te={__name:"scan",setup(G){const h=s({colis:[]}),i=s(""),S=s(),m=s(!1),B=s([]),V=s([]),v=s([]),u=s(!1),c=s(!1),j=async()=>{const{valid:l}=await S.value.validate();l&&await D()},D=l=>{m.value=!0,u.value=!1,u.value=!1,P({method:"POST",url:"/api/scannerRetourEntrepot",data:{scannedColis:F.value}}).then(async e=>{if(e.status===200){let o=e.data;console.log(o),B.value=o.success,V.value=o.errors,v.value=o.colisError,u.value=!0,c.value=V.value.length==0}m.value=!1}).catch(e=>{m.value=!1,e.response&&e.response.status===422?A.error(e.response.data.message):A.error("something wrong")})};b(()=>h.value.colis.map(l=>l.code));const F=b(()=>i.value?i.value.split(`
`).map(l=>l.trim()).filter(l=>l.length>0):[]),q=b(()=>F.value.filter((l,e,o)=>o.indexOf(l)!==e));return(l,e)=>{const o=Y;return n(),k(x,null,[(n(!0),k(x,null,R(a(B),(d,g)=>(n(),p($,{key:g,modelValue:a(c),"onUpdate:modelValue":e[0]||(e[0]=y=>C(c)?c.value=y:null),color:"success",class:"ma-1"},{default:r(()=>[w(U(d),1)]),_:2},1032,["modelValue"]))),128)),(n(!0),k(x,null,R(a(V),(d,g)=>(n(),p($,{key:g,modelValue:a(u),"onUpdate:modelValue":e[1]||(e[1]=y=>C(u)?u.value=y:null),color:"error",class:"ma-1"},{default:r(()=>[w(U(d),1)]),_:2},1032,["modelValue"]))),128)),t(O,{ref_key:"refForm",ref:S,class:"mt-3"},{default:r(()=>[E("div",null,[t(_,{class:"d-flex align-center justify-center"},{default:r(()=>[t(f,{cols:"12"},{default:r(()=>[t(o,{modelValue:a(i),"onUpdate:modelValue":e[2]||(e[2]=d=>C(i)?i.value=d:null),rows:"5","row-height":"20",label:"Scanner",rules:["requiredValidator"in l?l.requiredValidator:a(L)],placeholder:"Select pour scanner"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),t(_,null,{default:r(()=>[a(v).length>0?(n(),p(f,{key:0,cols:"12",md:"3"},{default:r(()=>[e[3]||(e[3]=E("p",{class:"text-error"}," Colis erroné ",-1)),t(N,{items:a(v),class:"border border-error border-opacity-75"},null,8,["items"])]),_:1})):T("",!0),a(q).length>0?(n(),p(f,{key:1,cols:"12",md:"3"},{default:r(()=>[e[4]||(e[4]=E("p",{class:"text-error"}," Colis dupliqués ",-1)),t(N,{items:a(q),class:"border border-error border-opacity-75"},null,8,["items"])]),_:1})):T("",!0)]),_:1}),t(_,null,{default:r(()=>[t(f,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:r(()=>[t(z,{loading:a(m),onClick:j},{default:r(()=>e[5]||(e[5]=[w(" Envoyer ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},512)],64)}}};export{te as default};
