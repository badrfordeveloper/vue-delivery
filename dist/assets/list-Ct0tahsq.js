import{s as le}from"./statutInfos-BWJ2EfQa.js";import{P as re,_ as ne}from"./printRamassage-37xV4m9a.js";import{_ as ie}from"./DialogCloseBtn-DzYXhcYP.js";import{V as ue,_ as me,c as pe}from"./VDataTableServer-DNsjtEWb.js";import{_ as de}from"./AppSelect-Du5adiPh.js";import{_ as fe}from"./AppTextField-DUGgtO2g.js";import{r as l,aq as ce,j as ve,Y as $,a as ge,c as F,o as m,b as s,f as d,m as c,e as o,d as L,ak as n,n as t,A as B,ai as I,v,$ as Ve,s as _e,x as E}from"./index-AFclKSR7.js";import{$ as N}from"./VForm-Cq3Ud8bc.js";import{t as R}from"./toast-DO2v-l4e.js";import{u as ye}from"./index-Dr-JgV-i.js";import{V as A}from"./VCardText-MbsNng7n.js";import{V as ke,a as O}from"./VRow-CHOMieTn.js";import{V as h}from"./VDivider-Bs5rWrNF.js";import{V as Ce}from"./VSpacer-DjZCbS6E.js";import{V as be}from"./VMenu-CpEhrxaz.js";import{V as Ie,a as we}from"./VList-CCzHfilh.js";import{V as xe}from"./VChip-Cf7qKl4a.js";import{V as Be}from"./VDialog-BcDL8NDF.js";import{V as j}from"./VCard-DvDMA-YT.js";import"./VTabs-69nHgKJg.js";import"./VOverlay-5K06fWrB.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-BIM37CCd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AppTextarea-CMC7IWXa.js";import"./VInput-tctzcLUr.js";import"./AppDateTimePicker-DsUPTCxE.js";import"./VAlert-CD7jtgP_.js";import"./VAvatar-BLWrssMY.js";import"./VDataTable-ByykQiB5.js";import"./VSelect-BlxSZfVV.js";import"./VTextField-D0JQPs88.js";import"./filter-DtFQEqnM.js";import"./VNodeRenderer-BlfivD0q.js";import"./qrcode.vue.esm-bzWNGdYv.js";/* empty css              */const De={class:"d-flex flex-wrap gap-4 ma-6"},Pe={class:"d-flex gap-4 flex-wrap align-center"},Se={key:1},vt={__name:"list",async setup(Te){let g,D;const M=[{title:"code",key:"code",sortable:!1},{title:"Statut",key:"statut",sortable:!1},{title:"Livreur",key:"livreur",sortable:!1},{title:"Montant encaisse",key:"montant_encaisse",sortable:!1},{title:"Montant facturée",key:"montant_facture",sortable:!1},{title:"Frais Total",key:"frais_total",sortable:!1}],V=l(),_=l(),y=l(!1),i=l(!1),w=l(),k=l(!1),q=l(),u=l(5),p=l(1),P=l(),S=l(),G=r=>{i.value=!0,w.value=r},z=async()=>{let r="/api/ramassage/"+w.value.id;y.value=!0,N({method:"DELETE",url:r}).then(async e=>{e.status===200&&(i.value=!1,R.success(e.data),x()),y.value=!1}).catch(e=>{y.value=!1})},C=l(!1),K=async()=>{let r="/api/generateLivreurFactures";C.value=!0,N({method:"POST",url:r}).then(async e=>{e.status===200&&(R.success(e.data),x()),C.value=!1}).catch(e=>{C.value=!1})},Y=r=>{var e,f;P.value=(e=r.sortBy[0])==null?void 0:e.key,S.value=(f=r.sortBy[0])==null?void 0:f.order},{data:T,error:Ue,statusCode:$e,isFetching:H,execute:x}=([g,D]=ce(()=>ye(pe("/api/factureLivreur",{query:{code:V,statut:_,page:p,itemsPerPage:u,sortBy:P,orderBy:S}}))),g=await g,D(),g),J=ve(),Q=$(()=>T.value.items),U=$(()=>T.value.total),b=l(!1),W=l(0),X=l(0);return(r,e)=>{const f=fe,Z=de,ee=ge("IconBtn"),te=me,ae=ie,se=ne;return m(),F("div",null,[s(j,{title:"Filtres",class:"mb-6 d-print-none"},{default:o(()=>[s(A,null,{default:o(()=>[s(ke,null,{default:o(()=>[s(O,{cols:"12",sm:"2"},{default:o(()=>[s(f,{modelValue:t(_),"onUpdate:modelValue":e[0]||(e[0]=a=>n(_)?_.value=a:null),placeholder:"Statut"},null,8,["modelValue"])]),_:1}),s(O,{cols:"12",sm:"2"},{default:o(()=>[s(f,{modelValue:t(V),"onUpdate:modelValue":e[1]||(e[1]=a=>n(V)?V.value=a:null),placeholder:"Code"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(h),L("div",De,[s(Ce),L("div",Pe,[s(Z,{modelValue:t(u),"onUpdate:modelValue":e[2]||(e[2]=a=>n(u)?u.value=a:null),items:[5,10,20,25,50]},null,8,["modelValue"]),t(B)("create","factureLivreur")?(m(),d(I,{key:0,color:"primary","prepend-icon":"tabler-plus",loading:t(C),onClick:K},{default:o(()=>e[11]||(e[11]=[v(" Génerer les factures ")])),_:1},8,["loading"])):c("",!0)])]),s(h,{class:"mt-4"}),s(ue,{"items-per-page":t(u),"onUpdate:itemsPerPage":e[4]||(e[4]=a=>n(u)?u.value=a:null),page:t(p),"onUpdate:page":e[5]||(e[5]=a=>n(p)?p.value=a:null),loading:t(H),headers:M,items:t(Q),"items-length":t(U),class:"text-no-wrap",locale:"fr","onUpdate:options":Y},{"item.code":o(({item:a})=>[t(B)("show","factureLivreur")?(m(),d(I,{key:0,variant:"text",onClick:oe=>t(J).push("/factureLivreur/"+a.id)},{default:o(()=>[v(E(a.code),1)]),_:2},1032,["onClick"])):(m(),F("span",Se,E(a.code),1))]),"item.statut":o(({item:a})=>[s(xe,_e(("statutInfos"in r?r.statutInfos:t(le))(a.statut),{density:"default",label:"",size:"small"}),null,16)]),"item.actions":o(({item:a})=>[a.statut=="EN_ATTENTE"?(m(),d(ee,{key:0},{default:o(()=>[s(Ve,{icon:"tabler-dots-vertical"}),s(be,{activator:"parent"},{default:o(()=>[s(Ie,null,{default:o(()=>[t(B)("delete","ramassage")?(m(),d(we,{key:0,value:"delete","prepend-icon":"tabler-trash",onClick:oe=>G(a)},{default:o(()=>e[12]||(e[12]=[v(" Delete ")])),_:2},1032,["onClick"])):c("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)):c("",!0)]),bottom:o(()=>[s(te,{page:t(p),"onUpdate:page":e[3]||(e[3]=a=>n(p)?p.value=a:null),"items-per-page":t(u),"total-items":t(U)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","loading","items","items-length"]),s(Be,{modelValue:t(i),"onUpdate:modelValue":e[8]||(e[8]=a=>n(i)?i.value=a:null),persistent:"",class:"v-dialog-sm"},{default:o(()=>[s(ae,{onClick:e[6]||(e[6]=a=>i.value=!t(i))}),s(j,{title:"Êtes-vous sûr de vouloir supprimer le ramassage "+t(w).code+" ?"},{default:o(()=>[s(A,{class:"d-flex justify-end gap-3 flex-wrap"},{default:o(()=>[s(I,{color:"secondary",variant:"tonal",onClick:e[7]||(e[7]=a=>i.value=!1)},{default:o(()=>e[13]||(e[13]=[v(" Non ")])),_:1}),s(I,{loading:t(y),onClick:z},{default:o(()=>e[14]||(e[14]=[v(" Oui ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),t(k)?(m(),d(re,{key:0,"is-print-ramassage":t(k),"onUpdate:isPrintRamassage":e[9]||(e[9]=a=>n(k)?k.value=a:null),item:t(q)},null,8,["is-print-ramassage","item"])):c("",!0),t(b)?(m(),d(se,{id:t(X),key:t(W),"is-show-item":t(b),"onUpdate:isShowItem":e[10]||(e[10]=a=>n(b)?b.value=a:null),onFetchItems:t(x)},null,8,["id","is-show-item","onFetchItems"])):c("",!0)])}}};export{vt as default};
